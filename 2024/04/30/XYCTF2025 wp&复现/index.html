<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>XYCTF2025 wp&amp;复现 | Lst4r's Blog</title><meta name="author" content="Lst4r"><meta name="copyright" content="Lst4r"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="XYCTF 2025 Crypto因为前一天去旅游了，第二天中午才开始看 最唐的一集，整个人状态十分不佳(赛中没出的打*) 属实是唐人日记了 division上来一看这么多解，直接先挑软柿子捏了（ 题目12345678910111213141516171819202122232425262728293031323334353637383940414243# -*- encoding: utf-8">
<meta property="og:type" content="article">
<meta property="og:title" content="XYCTF2025 wp&amp;复现">
<meta property="og:url" content="https://lst4r-max.github.io/2024/04/30/XYCTF2025%20wp&%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="Lst4r&#39;s Blog">
<meta property="og:description" content="XYCTF 2025 Crypto因为前一天去旅游了，第二天中午才开始看 最唐的一集，整个人状态十分不佳(赛中没出的打*) 属实是唐人日记了 division上来一看这么多解，直接先挑软柿子捏了（ 题目12345678910111213141516171819202122232425262728293031323334353637383940414243# -*- encoding: utf-8">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lst4r-max.github.io/img/1.jpg">
<meta property="article:published_time" content="2024-04-30T01:52:47.000Z">
<meta property="article:modified_time" content="2025-04-08T10:48:35.015Z">
<meta property="article:author" content="Lst4r">
<meta property="article:tag" content="Crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lst4r-max.github.io/img/1.jpg"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://lst4r-max.github.io/2024/04/30/XYCTF2025%20wp&amp;%E5%A4%8D%E7%8E%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'XYCTF2025 wp&复现',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-04-08 18:48:35'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: transparent"><nav id="nav"><span id="blog-info"><a href="/" title="Lst4r's Blog"><span class="site-name">Lst4r's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">XYCTF2025 wp&amp;复现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-04-30T01:52:47.000Z" title="发表于 2024-04-30 09:52:47">2024-04-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-08T10:48:35.015Z" title="更新于 2025-04-08 18:48:35">2025-04-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="XYCTF2025 wp&amp;复现"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="XYCTF-2025-Crypto"><a href="#XYCTF-2025-Crypto" class="headerlink" title="XYCTF 2025 Crypto"></a>XYCTF 2025 Crypto</h2><p>因为前一天去旅游了，第二天中午才开始看</p>
<p>最唐的一集，整个人状态十分不佳(赛中没出的打*)</p>
<p>属实是唐人日记了</p>
<h3 id="division"><a href="#division" class="headerlink" title="division"></a>division</h3><p>上来一看这么多解，直接先挑软柿子捏了（</p>
<h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    :   server.py</span></span><br><span class="line"><span class="string">@Time    :   2025/03/20 12:25:03</span></span><br><span class="line"><span class="string">@Author  :   LamentXU </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----Welcome to my division calc----&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">menu:</span></span><br><span class="line"><span class="string">      [1]  Division calc</span></span><br><span class="line"><span class="string">      [2]  Get flag</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    choose = <span class="built_in">input</span>(<span class="string">&#x27;: &gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> choose == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            denominator = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;input the denominator: &gt;&gt;&gt; &#x27;</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;INPUT NUMBERS&#x27;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        nominator = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">        <span class="keyword">if</span> denominator == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;NO YOU DONT&#x27;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;nominator&#125;</span>//<span class="subst">&#123;denominator&#125;</span> = <span class="subst">&#123;nominator//denominator&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> choose == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            ans = <span class="built_in">input</span>(<span class="string">&#x27;input the answer: &gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">            rand1 = random.getrandbits(<span class="number">11000</span>)</span><br><span class="line">            rand2 = random.getrandbits(<span class="number">10000</span>)</span><br><span class="line">            correct_ans = rand1 // rand2</span><br><span class="line">            <span class="keyword">if</span> correct_ans == <span class="built_in">int</span>(ans):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;WOW&#x27;</span>)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;Here is your flag: <span class="subst">&#123;f.read()&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;NOPE, the correct answer is <span class="subst">&#123;correct_ans&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;INPUT NUMBERS&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Invalid choice&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>这一看直接除数给 1 打 <strong>MT19937</strong> 得了</p>
<p>这个还不唐，写完脚本就出了</p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gf2bv <span class="keyword">import</span> LinearSystem</span><br><span class="line"><span class="keyword">from</span> gf2bv.crypto.mt <span class="keyword">import</span> MT19937</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mt19937</span>(<span class="params">bs, out</span>):</span><br><span class="line"></span><br><span class="line">    lin = LinearSystem([<span class="number">32</span>] * <span class="number">624</span>)</span><br><span class="line">    mt = lin.gens()</span><br><span class="line"></span><br><span class="line">    rng = MT19937(mt)</span><br><span class="line">    zeros = [rng.getrandbits(bs) ^ o <span class="keyword">for</span> o <span class="keyword">in</span> out] + [mt[<span class="number">0</span>] ^ <span class="number">0x80000000</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;solving...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    sol = lin.solve_one(zeros)</span><br><span class="line"></span><br><span class="line">    rng = MT19937(sol)</span><br><span class="line">    pyrand = rng.to_python_random()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">624</span>):</span><br><span class="line">        pyrand.getrandbits(<span class="number">32</span>)</span><br><span class="line">    rand1 = pyrand.getrandbits(<span class="number">11000</span>)</span><br><span class="line">    rand2 = pyrand.getrandbits(<span class="number">10000</span>)    </span><br><span class="line">    correct_ans = rand1 // rand2</span><br><span class="line">    <span class="built_in">print</span>(correct_ans)</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    io.recvuntil(&quot;: &gt;&gt;&gt;&quot;)</span></span><br><span class="line"><span class="string">    io.sendline(b&quot;2&quot;)</span></span><br><span class="line"><span class="string">    io.sendafter(b&quot;input the answer: &gt;&gt;&gt; &quot;,str(correct_ans).encode())&#x27;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    io.interactive()    </span><br><span class="line">io=remote(<span class="string">&quot;47.93.96.189&quot;</span>,<span class="number">20512</span>)</span><br><span class="line">out=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">624</span>):</span><br><span class="line">    io.recvuntil(<span class="string">&quot;: &gt;&gt;&gt;&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;input the denominator: &gt;&gt;&gt;&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    s=io.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    numbers = re.findall(<span class="string">r&#x27;\d+&#x27;</span>, s)</span><br><span class="line">    out.append(<span class="built_in">int</span>(numbers[<span class="number">0</span>]))</span><br><span class="line">mt19937(<span class="number">32</span>,out)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="complex-signin"><a href="#complex-signin" class="headerlink" title="complex_signin"></a>complex_signin</h3><h4 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ChaCha20</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Complex</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, re, im</span>):</span><br><span class="line">        self.re = re</span><br><span class="line">        self.im = im</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, c</span>):</span><br><span class="line">        re_ = self.re * c.re - self.im * c.im</span><br><span class="line">        im_ = self.re * c.im + self.im * c.re</span><br><span class="line">        <span class="keyword">return</span> Complex(re_, im_)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, c</span>):</span><br><span class="line">        <span class="keyword">return</span> self.re == c.re <span class="keyword">and</span> self.im == c.im</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__rshift__</span>(<span class="params">self, m</span>):</span><br><span class="line">        <span class="keyword">return</span> Complex(self.re &gt;&gt; m, self.im &gt;&gt; m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__lshift__</span>(<span class="params">self, m</span>):</span><br><span class="line">        <span class="keyword">return</span> Complex(self.re &lt;&lt; m, self.im &lt;&lt; m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.im == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(self.re)</span><br><span class="line">        <span class="keyword">elif</span> self.re == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(self.im) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;<span class="string">&#x27;-&#x27;</span> <span class="keyword">if</span> self.im &lt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>&#125;</span>i&quot;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;self.im&#125;</span>i&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;self.re&#125;</span> <span class="subst">&#123;<span class="string">&#x27;+&#x27;</span> <span class="keyword">if</span> self.im &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;-&#x27;</span>&#125;</span> <span class="subst">&#123;<span class="built_in">abs</span>(self.im)&#125;</span>i&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tolist</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> [self.re, self.im]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">complex_pow</span>(<span class="params">c, exp, n</span>):</span><br><span class="line">    result = Complex(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">while</span> exp &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> exp &amp; <span class="number">1</span>:</span><br><span class="line">            result = result * c</span><br><span class="line">            result.re = result.re % n</span><br><span class="line">            result.im = result.im % n</span><br><span class="line">        c = c * c</span><br><span class="line">        c.re = c.re % n</span><br><span class="line">        c.im = c.im % n</span><br><span class="line">        exp &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">bits = <span class="number">128</span></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">m = Complex(getRandomRange(<span class="number">1</span>, n), getRandomRange(<span class="number">1</span>, n))</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = complex_pow(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;mh = <span class="subst">&#123;(m &gt;&gt; bits &lt;&lt; bits).tolist()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;C = <span class="subst">&#123;c.tolist()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;ChaCha20.new(key=hashlib.sha256(<span class="built_in">str</span>(m.re + m.im).encode()).digest(), nonce=<span class="string">b&#x27;Pr3d1ctmyxjj&#x27;</span>).encrypt(flag)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 24240993137357567658677097076762157882987659874601064738608971893024559525024581362454897599976003248892339463673241756118600994494150721789525924054960470762499808771760690211841936903839232109208099640507210141111314563007924046946402216384360405445595854947145800754365717704762310092558089455516189533635318084532202438477871458797287721022389909953190113597425964395222426700352859740293834121123138183367554858896124509695602915312917886769066254219381427385100688110915129283949340133524365403188753735534290512113201932620106585043122707355381551006014647469884010069878477179147719913280272028376706421104753</span></span><br><span class="line"><span class="string">mh = [3960604425233637243960750976884707892473356737965752732899783806146911898367312949419828751012380013933993271701949681295313483782313836179989146607655230162315784541236731368582965456428944524621026385297377746108440938677401125816586119588080150103855075450874206012903009942468340296995700270449643148025957527925452034647677446705198250167222150181312718642480834399766134519333316989347221448685711220842032010517045985044813674426104295710015607450682205211098779229647334749706043180512861889295899050427257721209370423421046811102682648967375219936664246584194224745761842962418864084904820764122207293014016, 15053801146135239412812153100772352976861411085516247673065559201085791622602365389885455357620354025972053252939439247746724492130435830816513505615952791448705492885525709421224584364037704802923497222819113629874137050874966691886390837364018702981146413066712287361010611405028353728676772998972695270707666289161746024725705731676511793934556785324668045957177856807914741189938780850108643929261692799397326838812262009873072175627051209104209229233754715491428364039564130435227582042666464866336424773552304555244949976525797616679252470574006820212465924134763386213550360175810288209936288398862565142167552]</span></span><br><span class="line"><span class="string">C = [5300743174999795329371527870190100703154639960450575575101738225528814331152637733729613419201898994386548816504858409726318742419169717222702404409496156167283354163362729304279553214510160589336672463972767842604886866159600567533436626931810981418193227593758688610512556391129176234307448758534506432755113432411099690991453452199653214054901093242337700880661006486138424743085527911347931571730473582051987520447237586885119205422668971876488684708196255266536680083835972668749902212285032756286424244284136941767752754078598830317271949981378674176685159516777247305970365843616105513456452993199192823148760, 21112179095014976702043514329117175747825140730885731533311755299178008997398851800028751416090265195760178867626233456642594578588007570838933135396672730765007160135908314028300141127837769297682479678972455077606519053977383739500664851033908924293990399261838079993207621314584108891814038236135637105408310569002463379136544773406496600396931819980400197333039720344346032547489037834427091233045574086625061748398991041014394602237400713218611015436866842699640680804906008370869021545517947588322083793581852529192500912579560094015867120212711242523672548392160514345774299568940390940653232489808850407256752]</span></span><br><span class="line"><span class="string">enc = b&#x27;\x9c\xc4n\x8dF\xd9\x9e\xf4\x05\x82!\xde\xfe\x012$\xd0\x8c\xaf\xfb\rEb(\x04)\xa1\xa6\xbaI2J\xd2\xb2\x898\x11\xe6x\xa9\x19\x00pn\xf6rs- \xd2\xd1\xbe\xc7\xf51.\xd4\xd2 \xe7\xc6\xca\xe5\x19\xbe&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这个一看思路就很明确，因为次数为3，可以直接列两个方程，再一看给了高位，直接就<strong>一元coppersmith</strong></p>
<p>只需要用结式将两个方程联系起来就好了</p>
<p>但是唐的是我刚开始把 128 看成了 120 ，绝了</p>
<p>浪费我半天</p>
<h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ChaCha20</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> sage.matrix.matrix2 <span class="keyword">import</span> Matrix</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resultant</span>(<span class="params">f1,f2,var</span>):</span><br><span class="line">    <span class="keyword">return</span> Matrix.determinant(f1.sylvester_matrix(f2,var))</span><br><span class="line">n = <span class="number">24240993137357567658677097076762157882987659874601064738608971893024559525024581362454897599976003248892339463673241756118600994494150721789525924054960470762499808771760690211841936903839232109208099640507210141111314563007924046946402216384360405445595854947145800754365717704762310092558089455516189533635318084532202438477871458797287721022389909953190113597425964395222426700352859740293834121123138183367554858896124509695602915312917886769066254219381427385100688110915129283949340133524365403188753735534290512113201932620106585043122707355381551006014647469884010069878477179147719913280272028376706421104753</span></span><br><span class="line">mh = [<span class="number">3960604425233637243960750976884707892473356737965752732899783806146911898367312949419828751012380013933993271701949681295313483782313836179989146607655230162315784541236731368582965456428944524621026385297377746108440938677401125816586119588080150103855075450874206012903009942468340296995700270449643148025957527925452034647677446705198250167222150181312718642480834399766134519333316989347221448685711220842032010517045985044813674426104295710015607450682205211098779229647334749706043180512861889295899050427257721209370423421046811102682648967375219936664246584194224745761842962418864084904820764122207293014016</span>, <span class="number">15053801146135239412812153100772352976861411085516247673065559201085791622602365389885455357620354025972053252939439247746724492130435830816513505615952791448705492885525709421224584364037704802923497222819113629874137050874966691886390837364018702981146413066712287361010611405028353728676772998972695270707666289161746024725705731676511793934556785324668045957177856807914741189938780850108643929261692799397326838812262009873072175627051209104209229233754715491428364039564130435227582042666464866336424773552304555244949976525797616679252470574006820212465924134763386213550360175810288209936288398862565142167552</span>]</span><br><span class="line">C = [<span class="number">5300743174999795329371527870190100703154639960450575575101738225528814331152637733729613419201898994386548816504858409726318742419169717222702404409496156167283354163362729304279553214510160589336672463972767842604886866159600567533436626931810981418193227593758688610512556391129176234307448758534506432755113432411099690991453452199653214054901093242337700880661006486138424743085527911347931571730473582051987520447237586885119205422668971876488684708196255266536680083835972668749902212285032756286424244284136941767752754078598830317271949981378674176685159516777247305970365843616105513456452993199192823148760</span>, <span class="number">21112179095014976702043514329117175747825140730885731533311755299178008997398851800028751416090265195760178867626233456642594578588007570838933135396672730765007160135908314028300141127837769297682479678972455077606519053977383739500664851033908924293990399261838079993207621314584108891814038236135637105408310569002463379136544773406496600396931819980400197333039720344346032547489037834427091233045574086625061748398991041014394602237400713218611015436866842699640680804906008370869021545517947588322083793581852529192500912579560094015867120212711242523672548392160514345774299568940390940653232489808850407256752</span>]</span><br><span class="line">enc = <span class="string">b&#x27;\x9c\xc4n\x8dF\xd9\x9e\xf4\x05\x82!\xde\xfe\x012$\xd0\x8c\xaf\xfb\rEb(\x04)\xa1\xa6\xbaI2J\xd2\xb2\x898\x11\xe6x\xa9\x19\x00pn\xf6rs- \xd2\xd1\xbe\xc7\xf51.\xd4\xd2 \xe7\xc6\xca\xe5\x19\xbe&#x27;</span></span><br><span class="line">PR=PolynomialRing(Zmod(n),<span class="string">&#x27;x,y&#x27;</span>)</span><br><span class="line">x,y=PR.gens()</span><br><span class="line">f=(mh[<span class="number">0</span>]+x)**<span class="number">3</span>-<span class="number">3</span>*(mh[<span class="number">0</span>]+x)*(mh[<span class="number">1</span>]+y)**<span class="number">2</span>-C[<span class="number">0</span>]</span><br><span class="line">g=<span class="number">3</span>*(mh[<span class="number">0</span>]+x)**<span class="number">2</span>*(mh[<span class="number">1</span>]+y)-(mh[<span class="number">1</span>]+y)**<span class="number">3</span>-C[<span class="number">1</span>]</span><br><span class="line">h1=resultant(f,g,y)</span><br><span class="line">h2=resultant(f,g,x)</span><br><span class="line">root1=h1.univariate_polynomial().monic().small_roots(X=<span class="number">2</span>**<span class="number">128</span>,beta=<span class="number">0.4</span>,epsilon=<span class="number">0.01</span>)</span><br><span class="line">xx=root1[<span class="number">0</span>]</span><br><span class="line">root2=h2.univariate_polynomial().monic().small_roots(X=<span class="number">2</span>**<span class="number">128</span>,beta=<span class="number">0.4</span>,epsilon=<span class="number">0.01</span>)</span><br><span class="line">yy=root2[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(xx)</span><br><span class="line"><span class="built_in">print</span>(yy)</span><br><span class="line">key=hashlib.sha256(<span class="built_in">str</span>(mh[<span class="number">0</span>]+xx+mh[<span class="number">1</span>]+yy).encode()).digest()</span><br><span class="line">flag=ChaCha20.new(key=key, nonce=<span class="string">b&#x27;Pr3d1ctmyxjj&#x27;</span>).decrypt(enc)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="reed"><a href="#reed" class="headerlink" title="reed"></a>reed</h3><h4 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&#x27;XYCTF&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">flag = flag.rstrip(<span class="string">&#x27;&#125;&#x27;</span>).lstrip(<span class="string">&#x27;XYCTF&#123;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(i <span class="keyword">in</span> table <span class="keyword">for</span> i <span class="keyword">in</span> flag)</span><br><span class="line">r = random.Random()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PRNG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed</span>):</span><br><span class="line">        self.a = <span class="number">1145140</span></span><br><span class="line">        self.b = <span class="number">19198100</span></span><br><span class="line">        random.seed(seed)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        x = random.randint(self.a, self.b)</span><br><span class="line">        random.seed(x ** <span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">round</span>(<span class="params">self, k</span>):</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            x = self.<span class="built_in">next</span>()</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, a, b</span>):</span><br><span class="line">    c = [(a * table.index(m) + b) % <span class="number">19198111</span> <span class="keyword">for</span> m <span class="keyword">in</span> msg]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">seed = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;give me seed: &#x27;</span>))</span><br><span class="line">prng = PRNG(seed)</span><br><span class="line">a = prng.<span class="built_in">round</span>(r.randrange(<span class="number">2</span>**<span class="number">16</span>))</span><br><span class="line">b = prng.<span class="built_in">round</span>(r.randrange(<span class="number">2</span>**<span class="number">16</span>))</span><br><span class="line">enc = encrypt(flag, a, b)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br></pre></td></tr></table></figure>
<p>这题的预期是找到<strong>不动点</strong>，但是非预期更好做，直接 gcd 搞出 a ,然后爆 b 就 ok </p>
<h4 id="非预期-exp"><a href="#非预期-exp" class="headerlink" title="非预期 exp"></a>非预期 exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line">r = random.Random()</span><br><span class="line">a = <span class="number">1145140</span></span><br><span class="line">b = <span class="number">19198100</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PRNG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed</span>):</span><br><span class="line">        self.a = <span class="number">1145140</span></span><br><span class="line">        self.b = <span class="number">19198100</span></span><br><span class="line">        random.seed(seed)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        x = random.randint(self.a, self.b)</span><br><span class="line">        random.seed(x ** <span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">round</span>(<span class="params">self, k</span>):</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            x = self.<span class="built_in">next</span>()</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">prng = PRNG(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#io=remote(&quot;39.106.48.123&quot;,34583)</span></span><br><span class="line"><span class="comment">#io.interactive()</span></span><br><span class="line">ans=[<span class="number">8622166</span>, <span class="number">8622166</span>, <span class="number">1642584</span>, <span class="number">5715427</span>, <span class="number">8622166</span>, <span class="number">1642584</span>, <span class="number">5106812</span>, <span class="number">17325341</span>, <span class="number">1625542</span>, <span class="number">1033969</span>, <span class="number">16159237</span>, <span class="number">7439020</span>, <span class="number">3366177</span>, <span class="number">17325341</span>, <span class="number">18491445</span>, <span class="number">4532281</span>, <span class="number">17325341</span>, <span class="number">459438</span>, <span class="number">459438</span>, <span class="number">3366177</span>, <span class="number">16159237</span>, <span class="number">3940708</span>, <span class="number">18491445</span>, <span class="number">9179655</span>, <span class="number">1033969</span>, <span class="number">15584706</span>, <span class="number">3366177</span>, <span class="number">8605124</span>, <span class="number">459438</span>, <span class="number">8622166</span>, <span class="number">2808688</span>, <span class="number">8622166</span>, <span class="number">2808688</span>, <span class="number">17933956</span>, <span class="number">8622166</span>, <span class="number">4549323</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(ans))</span><br><span class="line">n=<span class="number">19198111</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">62</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">62</span>):</span><br><span class="line">        <span class="keyword">if</span> (GCD((-ans[<span class="number">3</span>]+ans[<span class="number">2</span>]+i*n),(-ans[<span class="number">0</span>]+ans[<span class="number">2</span>])+j*n))&gt;<span class="number">1145140</span>:</span><br><span class="line">            <span class="built_in">print</span>(i,j)</span><br><span class="line"></span><br><span class="line">a=GCD((-ans[<span class="number">3</span>]+ans[<span class="number">2</span>]+<span class="number">0</span>*n),(-ans[<span class="number">0</span>]+ans[<span class="number">2</span>])+<span class="number">1</span>*n)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b1=[]</span><br><span class="line">b2=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">62</span>):</span><br><span class="line">    b=(ans[<span class="number">0</span>]-(a*i)%n)%n</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">62</span>):</span><br><span class="line">        <span class="keyword">if</span>((a*j+b)%n)==ans[<span class="number">3</span>]:</span><br><span class="line">            b1.append(b)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">62</span>):</span><br><span class="line">    b=(ans[<span class="number">0</span>]-(a*i)%n)%n</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">62</span>):</span><br><span class="line">        <span class="keyword">if</span>((a*j+b)%n)==ans[<span class="number">2</span>]:</span><br><span class="line">            b2.append(b)   </span><br><span class="line">d=inverse(a,n)</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> tqdm(b1):</span><br><span class="line">    flag=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ans)):</span><br><span class="line">        t=(d*(ans[i]-b)%n)%n</span><br><span class="line">        <span class="keyword">if</span> t&gt;<span class="number">61</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag+=table[t]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(flag)==<span class="built_in">len</span>(ans):</span><br><span class="line">        <span class="built_in">print</span>(flag)    </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="预期-exp"><a href="#预期-exp" class="headerlink" title="预期 exp"></a>预期 exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">############# 1.find fixed point</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    random.seed(x ** <span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> random.randint(<span class="number">1145140</span>, <span class="number">19198100</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">    a = <span class="number">1145140</span></span><br><span class="line">    b = <span class="number">19198100</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(a, b + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> f(f(i)) == i:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="comment"># 7234044 17593903</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############# 2.compute flag</span></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">enc, a, b</span>):</span><br><span class="line">    t = <span class="number">19198111</span></span><br><span class="line">    m = <span class="string">&#x27;&#x27;</span>.join(table[(c - b) * <span class="built_in">pow</span>(a, -<span class="number">1</span>, t) % t] <span class="keyword">for</span> c <span class="keyword">in</span> enc)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">seed = <span class="number">7234044</span></span><br><span class="line">r = process([<span class="string">&#x27;python3&#x27;</span>, <span class="string">&#x27;reed.py&#x27;</span>])</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;give me seed: &#x27;</span>, <span class="built_in">str</span>(seed ** <span class="number">2</span> + <span class="number">1</span>).encode())</span><br><span class="line">enc = <span class="built_in">eval</span>(r.recvline().strip().decode())</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(decrypt(enc, <span class="number">17593903</span>, <span class="number">17593903</span>))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(decrypt(enc, <span class="number">7234044</span>, <span class="number">17593903</span>))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(decrypt(enc, <span class="number">7234044</span>, <span class="number">7234044</span>))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(decrypt(enc, <span class="number">17593903</span>, <span class="number">7234044</span>))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<h3 id="勒索病毒"><a href="#勒索病毒" class="headerlink" title="勒索病毒"></a>勒索病毒</h3><h4 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Visit https://www.lddgo.net/string/pyc-compile-decompile for more information</span></span><br><span class="line"><span class="comment"># Version : Python 3.8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Created on Sun Mar 30 18:25:08 2025</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@author: Crypto0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm4</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle, randrange</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span>*</span><br><span class="line">N = <span class="number">49</span> </span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">128</span>  </span><br><span class="line">d = <span class="number">3</span></span><br><span class="line"><span class="keyword">assert</span> q &gt; (<span class="number">6</span> * d + <span class="number">1</span>) * p</span><br><span class="line">R = PolynomialRing(ZZ,<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">x=R.gen()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_T</span>(<span class="params">d1, d2</span>):</span><br><span class="line">    <span class="keyword">assert</span> N &gt;= d1 + d2</span><br><span class="line">    s = [<span class="number">1</span>] * d1 + [-<span class="number">1</span>] * d2 + [<span class="number">0</span>] * (N - d1 - d2)</span><br><span class="line">    shuffle(s)</span><br><span class="line">    <span class="keyword">return</span> R(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_prime</span>(<span class="params">f, p</span>):</span><br><span class="line">    Rp = R.change_ring(Integers(p)).quotient(x^N - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> R(lift(<span class="number">1</span> / Rp(f)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convolution</span>(<span class="params">f, g</span>):</span><br><span class="line">    <span class="keyword">return</span> (f * g) % (x^N - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_mod</span>(<span class="params">f, q</span>):</span><br><span class="line">    <span class="keyword">return</span> R([((f[i] + q // <span class="number">2</span>) % q) - q // <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_mod</span>(<span class="params">f, q</span>):</span><br><span class="line">    <span class="keyword">return</span> R([f[i] % q <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_pow2</span>(<span class="params">f, q</span>):</span><br><span class="line">    <span class="keyword">assert</span> q.is_power_of(<span class="number">2</span>)</span><br><span class="line">    g = invert_mod_prime(f, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = lift_mod(convolution(g, f), q)</span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> g</span><br><span class="line">        g = lift_mod(convolution(g, <span class="number">2</span> - r), q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_message</span>():</span><br><span class="line">    <span class="keyword">return</span> R([randrange(p) - <span class="number">1</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = generate_T(d + <span class="number">1</span>, d)</span><br><span class="line">            g = generate_T(d, d)</span><br><span class="line">            Fp = poly_mod(invert_mod_prime(f, p), p)</span><br><span class="line">            Fq = poly_mod(invert_mod_pow2(f, q), q)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    h = poly_mod(convolution(Fq, g), q)</span><br><span class="line">    <span class="keyword">return</span> h, (f, g)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_message</span>(<span class="params">m, h</span>):</span><br><span class="line">    e = lift_mod(p * convolution(h, generate_T(d, d)) + m, q)</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_ntru_keys</span>():</span><br><span class="line">    h, secret = generate_key()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pub_key.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(h))</span><br><span class="line">    m = generate_message()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;priv_key.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(m))</span><br><span class="line">    e = encrypt_message(m, h)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(e))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">terms</span>(<span class="params">poly_str</span>):</span><br><span class="line">    terms = []</span><br><span class="line">    pattern = <span class="string">r&#x27;([+-]?\\s*x\\^?\\d*|[-+]?\\s*\\d+)&#x27;</span></span><br><span class="line">    </span><br><span class="line">    matches = re.finditer(pattern, poly_str.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        term = <span class="keyword">match</span>.group()</span><br><span class="line">        <span class="keyword">if</span> term == <span class="string">&#x27;+x&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            terms.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> term == <span class="string">&#x27;-x&#x27;</span>:</span><br><span class="line">            terms.append(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x^&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            exponent = <span class="built_in">int</span>(term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                coeff = <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                coeff = -<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                coeff = <span class="built_in">int</span>(coeff_part)</span><br><span class="line">            terms.append(coeff * exponent)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                terms.append(-<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                terms.append(<span class="built_in">int</span>(coeff_part))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> term == <span class="string">&#x27;+1&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">0</span>)</span><br><span class="line">                terms.append(-<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> terms</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">poly_terms</span>):</span><br><span class="line">    binary = [<span class="number">0</span>] * <span class="number">128</span></span><br><span class="line">    <span class="keyword">for</span> term <span class="keyword">in</span> poly_terms:</span><br><span class="line">        exponent = <span class="built_in">abs</span>(term)</span><br><span class="line">        <span class="keyword">if</span> term &gt; <span class="number">0</span> <span class="keyword">and</span> exponent &lt;= <span class="number">127</span>:  </span><br><span class="line">            binary[<span class="number">127</span> - exponent] = <span class="number">1</span></span><br><span class="line">    binary_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, binary))</span><br><span class="line">    hex_key = <span class="built_in">hex</span>(<span class="built_in">int</span>(binary_str, <span class="number">2</span>))[<span class="number">2</span>:].upper().zfill(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">return</span> hex_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_polynomial_from_file</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> file.read().strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm4_encrypt</span>(<span class="params">key, plaintext</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(key) == <span class="number">16</span>, <span class="string">&quot;SM4 key must be 16 bytes&quot;</span></span><br><span class="line">    cipher = sm4.CryptSM4()</span><br><span class="line">    cipher.set_key(key, sm4.SM4_ENCRYPT)</span><br><span class="line">    padded_plaintext = pad(plaintext, <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> cipher.crypt_ecb(padded_plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm4_encrypt_file</span>(<span class="params">input_path, output_path, key</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        plaintext = f.read()</span><br><span class="line">    </span><br><span class="line">    ciphertext = sm4_encrypt(key, plaintext)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resource_path</span>(<span class="params">relative_path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">getattr</span>(sys, <span class="string">&#x27;frozen&#x27;</span>, <span class="literal">False</span>):</span><br><span class="line">        base_path = sys._MEIPASS</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        base_path = os.path.abspath(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> os.path.join(base_path, relative_path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_directory</span>(<span class="params">directory, sm4_key, extensions=[<span class="string">&quot;.txt&quot;</span>]</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(directory):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Directory does not exist: <span class="subst">&#123;directory&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> root, _, files <span class="keyword">in</span> os.walk(directory):</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(file.endswith(ext) <span class="keyword">for</span> ext <span class="keyword">in</span> extensions):</span><br><span class="line">                input_path = os.path.join(root, file)</span><br><span class="line">                output_path = input_path + <span class="string">&quot;.enc&quot;</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    sm4_encrypt_file(input_path, output_path, sm4_key)</span><br><span class="line">                    os.remove(input_path)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Encrypted: <span class="subst">&#123;input_path&#125;</span> -&gt; <span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Error encrypting <span class="subst">&#123;input_path&#125;</span>: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        save_ntru_keys()</span><br><span class="line">        poly_str = read_polynomial_from_file(<span class="string">&quot;priv_key.txt&quot;</span>)</span><br><span class="line">        poly_terms = terms(poly_str)</span><br><span class="line">        sm4_key = binascii.unhexlify(poly_terms)</span><br><span class="line">        user_name = os.getlogin()</span><br><span class="line">        target_dir = os.path.join(<span class="string">&quot;C:\\Users&quot;</span>, user_name, <span class="string">&quot;Desktop&quot;</span>, <span class="string">&quot;test_files&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(target_dir):</span><br><span class="line">            os.makedirs(target_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Created directory: <span class="subst">&#123;target_dir&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">            </span><br><span class="line">        txt_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(target_dir) </span><br><span class="line">                    <span class="keyword">if</span> f.endswith(<span class="string">&#x27;.txt&#x27;</span>) <span class="keyword">and</span> os.path.isfile(os.path.join(target_dir, f))]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> txt_files:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;No .txt files found in directory&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">for</span> txt_file <span class="keyword">in</span> txt_files:</span><br><span class="line">            file_path = os.path.join(target_dir, txt_file)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    test_data = f.read()</span><br><span class="line">                </span><br><span class="line">                ciphertext = sm4_encrypt(sm4_key, test_data)</span><br><span class="line">                encrypted_path = file_path + <span class="string">&#x27;.enc&#x27;</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(encrypted_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(ciphertext)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Error processing <span class="subst">&#123;txt_file&#125;</span>: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">                </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Fatal error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>真的唐啊，格早就搞出来了，就直接是最简单的 <strong>NTRU</strong>，但是为啥规约出来的 f 的系数是 2 啊</p>
<p>害我看了好久，最后才发现是对的，真的是唐完了</p>
<h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm4</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad,unpad</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle, randrange</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line">n= <span class="number">49</span> </span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">128</span>  </span><br><span class="line">d = <span class="number">3</span></span><br><span class="line">R = ZZ[<span class="string">&#x27;x&#x27;</span>]</span><br><span class="line">x = R.gen()</span><br><span class="line">pubkey =  <span class="number">8</span>*x**<span class="number">48</span> + <span class="number">58</span>*x**<span class="number">47</span> + <span class="number">18</span>*x**<span class="number">46</span> + <span class="number">61</span>*x**<span class="number">45</span> + <span class="number">33</span>*x**<span class="number">44</span> + <span class="number">21</span>*x**<span class="number">43</span> + <span class="number">58</span>*x**<span class="number">42</span> + <span class="number">21</span>*x**<span class="number">41</span> + <span class="number">5</span>*x**<span class="number">40</span> + <span class="number">32</span>*x**<span class="number">39</span> + <span class="number">15</span>*x**<span class="number">38</span> + <span class="number">40</span>*x**<span class="number">37</span> + <span class="number">24</span>*x**<span class="number">36</span> + <span class="number">14</span>*x**<span class="number">35</span> + <span class="number">40</span>*x**<span class="number">34</span> + <span class="number">5</span>*x**<span class="number">33</span> + x**<span class="number">32</span> + <span class="number">48</span>*x**<span class="number">31</span> + <span class="number">21</span>*x**<span class="number">30</span> + <span class="number">36</span>*x**<span class="number">29</span> + <span class="number">42</span>*x**<span class="number">28</span> + <span class="number">8</span>*x**<span class="number">27</span> + <span class="number">17</span>*x**<span class="number">26</span> + <span class="number">54</span>*x**<span class="number">25</span> + <span class="number">39</span>*x**<span class="number">24</span> + <span class="number">38</span>*x**<span class="number">23</span> + <span class="number">14</span>*x**<span class="number">22</span> + <span class="number">22</span>*x**<span class="number">21</span> + <span class="number">26</span>*x**<span class="number">20</span> + <span class="number">22</span>*x**<span class="number">18</span> + <span class="number">7</span>*x**<span class="number">17</span> + <span class="number">29</span>*x**<span class="number">16</span> + <span class="number">53</span>*x**<span class="number">15</span> + <span class="number">50</span>*x**<span class="number">14</span> + <span class="number">49</span>*x**<span class="number">13</span> + <span class="number">21</span>*x**<span class="number">12</span> + <span class="number">47</span>*x**<span class="number">11</span> + <span class="number">50</span>*x**<span class="number">10</span> + <span class="number">32</span>*x**<span class="number">9</span> + <span class="number">14</span>*x**<span class="number">8</span> + <span class="number">50</span>*x**<span class="number">7</span> + <span class="number">18</span>*x**<span class="number">6</span> + <span class="number">9</span>*x**<span class="number">5</span> + <span class="number">61</span>*x**<span class="number">4</span> + <span class="number">10</span>*x**<span class="number">3</span> + <span class="number">9</span>*x**<span class="number">2</span> + <span class="number">11</span>*x + <span class="number">47</span></span><br><span class="line">c = <span class="number">31</span>*x**<span class="number">48</span> - <span class="number">14</span>*x**<span class="number">47</span> + x**<span class="number">46</span> + <span class="number">8</span>*x**<span class="number">45</span> - <span class="number">9</span>*x**<span class="number">44</span> - <span class="number">18</span>*x**<span class="number">43</span> - <span class="number">30</span>*x**<span class="number">41</span> + <span class="number">14</span>*x**<span class="number">40</span> + <span class="number">3</span>*x**<span class="number">39</span> - <span class="number">17</span>*x**<span class="number">38</span> + <span class="number">22</span>*x**<span class="number">37</span> + <span class="number">7</span>*x**<span class="number">36</span> + <span class="number">31</span>*x**<span class="number">34</span> - <span class="number">30</span>*x**<span class="number">33</span> - <span class="number">22</span>*x**<span class="number">32</span> - <span class="number">25</span>*x**<span class="number">31</span> + <span class="number">31</span>*x**<span class="number">30</span> - <span class="number">28</span>*x**<span class="number">29</span> + <span class="number">7</span>*x**<span class="number">28</span> + <span class="number">23</span>*x**<span class="number">27</span> - <span class="number">6</span>*x**<span class="number">26</span> + <span class="number">12</span>*x**<span class="number">25</span> - <span class="number">6</span>*x**<span class="number">24</span> + <span class="number">5</span>*x**<span class="number">23</span> - <span class="number">13</span>*x**<span class="number">22</span> - <span class="number">10</span>*x**<span class="number">20</span> + <span class="number">4</span>*x**<span class="number">19</span> + <span class="number">15</span>*x**<span class="number">18</span> + <span class="number">23</span>*x**<span class="number">17</span> + <span class="number">24</span>*x**<span class="number">16</span> - <span class="number">2</span>*x**<span class="number">15</span> - <span class="number">8</span>*x**<span class="number">14</span> - <span class="number">20</span>*x**<span class="number">13</span> + <span class="number">24</span>*x**<span class="number">12</span> - <span class="number">23</span>*x**<span class="number">11</span> - <span class="number">4</span>*x**<span class="number">10</span> - <span class="number">26</span>*x**<span class="number">9</span> - <span class="number">14</span>*x**<span class="number">8</span> + <span class="number">10</span>*x**<span class="number">7</span> + <span class="number">4</span>*x**<span class="number">6</span> - <span class="number">4</span>*x**<span class="number">5</span> - <span class="number">32</span>*x**<span class="number">4</span> - <span class="number">5</span>*x**<span class="number">3</span> - <span class="number">31</span>*x**<span class="number">2</span> + <span class="number">16</span>*x + <span class="number">11</span></span><br><span class="line">c=R(c)</span><br><span class="line">Rp = R.change_ring(Integers(p)).quotient(x**n - <span class="number">1</span>)</span><br><span class="line">fp=Rp(<span class="string">&quot;-x^48 - x^46 + x^45 + x^43 - x^42 + x^41 + x^40 + x^36 - x^35 + x^34 - x^33 + x^32 - x^30 + x^29 - x^28 - x^27 - x^26 - x^25 - x^23 - x^22 + x^21 + x^20 + x^19 + x^18 - x^17 - x^16 - x^15 - x^14 - x^12 + x^9 - x^7 - x^6 - x^5 - x^4 + x^3 - x + 1&quot;</span>)</span><br><span class="line"><span class="comment">#print(1/fp)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_prime</span>(<span class="params">f, p</span>):</span><br><span class="line">    Rp = R.change_ring(Integers(p)).quotient(x**n - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> R(lift(<span class="number">1</span> / Rp(f)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">f,g</span>):</span><br><span class="line">    <span class="keyword">return</span> (f * g) % (x**n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_mod</span>(<span class="params">f, q</span>):</span><br><span class="line">    <span class="keyword">return</span> R([((f[i] + q // <span class="number">2</span>) % q) - q // <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_mod</span>(<span class="params">f, q</span>):</span><br><span class="line">    <span class="keyword">return</span> R([f[i] % q <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">e,pri_key</span>):</span><br><span class="line">    f,fp = pri_key</span><br><span class="line">    a = lift_mod(mul(e,f),q)</span><br><span class="line">    d = lift_mod(mul(a,fp),p)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">terms</span>(<span class="params">poly_str</span>):</span><br><span class="line">    terms = []</span><br><span class="line">    pattern = <span class="string">r&#x27;([+-]?\s*x\^?\d*|[-+]?\s*\d+)&#x27;</span></span><br><span class="line">    </span><br><span class="line">    matches = re.finditer(pattern, poly_str.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        term = <span class="keyword">match</span>.group()</span><br><span class="line">        <span class="keyword">if</span> term == <span class="string">&#x27;+x&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            terms.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> term == <span class="string">&#x27;-x&#x27;</span>:</span><br><span class="line">            terms.append(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x^&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            exponent = <span class="built_in">int</span>(term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                coeff = <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                coeff = -<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                coeff = <span class="built_in">int</span>(coeff_part)</span><br><span class="line">            terms.append(coeff * exponent)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                terms.append(-<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                terms.append(<span class="built_in">int</span>(coeff_part))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> term == <span class="string">&#x27;+1&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">0</span>)</span><br><span class="line">                terms.append(-<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> terms</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">poly_terms</span>):</span><br><span class="line">    binary = [<span class="number">0</span>] * <span class="number">128</span></span><br><span class="line">    <span class="keyword">for</span> term <span class="keyword">in</span> poly_terms:</span><br><span class="line">        exponent = <span class="built_in">abs</span>(term)</span><br><span class="line">        <span class="keyword">if</span> term &gt; <span class="number">0</span> <span class="keyword">and</span> exponent &lt;= <span class="number">127</span>:  </span><br><span class="line">            binary[<span class="number">127</span> - exponent] = <span class="number">1</span></span><br><span class="line">    binary_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, binary))</span><br><span class="line">    hex_key = <span class="built_in">hex</span>(<span class="built_in">int</span>(binary_str, <span class="number">2</span>))[<span class="number">2</span>:].upper().zfill(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">return</span> hex_key   </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm4_decrypt</span>(<span class="params">key, ciphertext</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(key) == <span class="number">16</span>, <span class="string">&quot;SM4 key must be 16 bytes&quot;</span></span><br><span class="line">    cipher = sm4.CryptSM4()</span><br><span class="line">    cipher.set_key(key, sm4.SM4_DECRYPT)  <span class="comment"># 设置为解密模式</span></span><br><span class="line">    decrypted_data = cipher.crypt_ecb(ciphertext)</span><br><span class="line">    plaintext = unpad(decrypted_data, <span class="number">16</span>)       <span class="comment"># 去除填充</span></span><br><span class="line">    <span class="keyword">return</span> plaintext </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>():</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> * n):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = R(<span class="built_in">list</span>(M[j][:n]))</span><br><span class="line">            g = R(<span class="built_in">list</span>(M[j][n:]))</span><br><span class="line">            fp = poly_mod(invert_mod_prime(f, p),p)</span><br><span class="line">            <span class="built_in">print</span>(f)</span><br><span class="line">            m=decrypt(c,(f,fp))</span><br><span class="line">            <span class="keyword">return</span> m</span><br><span class="line">            <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            m=decrypt(c,(f,fp))</span></span><br><span class="line"><span class="string">            poly_terms = terms(str(m))</span></span><br><span class="line"><span class="string">            poly_terms=gen_key(poly_terms)</span></span><br><span class="line"><span class="string">            sm4_key = binascii.unhexlify(poly_terms)</span></span><br><span class="line"><span class="string">            ciphertext=bytes.fromhex(&quot;bf0cb5cc6bea6146e9c1f109df953a57daa416d38a8ffba6438e7e599613e01f3b9a53dace4ccd55cd3e55ef88e0b835&quot;)</span></span><br><span class="line"><span class="string">            print(sm4_decrypt(sm4_key,ciphertext))</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span></span><br><span class="line">            <span class="comment">#print(R(lift(1/fp)))</span></span><br><span class="line">            <span class="comment">#print(fp)</span></span><br><span class="line">            <span class="comment">#print(decrypt(c,(f,fp)))</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="comment"># 如果需要，你可以记录或打印异常信息，帮助调试</span></span><br><span class="line">            <span class="comment">#print(f&quot;Error occurred: &#123;e&#125;&quot;)</span></span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">M = matrix(ZZ, <span class="number">2</span>*n, <span class="number">2</span>*n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#hh = R(pubkey)</span></span><br><span class="line">hh=poly_mod(R(pubkey),q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n): M[i,i] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n,<span class="number">2</span>*n):</span><br><span class="line">    M[i,i] = q</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            M[i, j + n] = hh[(n - i + j) % n]</span><br><span class="line">  </span><br><span class="line">    </span><br><span class="line"><span class="comment">#print(M)     </span></span><br><span class="line">M = M.LLL()</span><br><span class="line"><span class="comment">#print(M)</span></span><br><span class="line">m= get_key()</span><br><span class="line">poly_str=<span class="built_in">str</span>(m)</span><br><span class="line">poly_terms = terms(poly_str)</span><br><span class="line">poly_terms=gen_key(poly_terms)</span><br><span class="line"><span class="built_in">print</span>(poly_terms)</span><br><span class="line">sm4_key = binascii.unhexlify(poly_terms)</span><br><span class="line">ciphertext=<span class="built_in">bytes</span>.fromhex(<span class="string">&quot;bf0cb5cc6bea6146e9c1f109df953a57daa416d38a8ffba6438e7e599613e01f3b9a53dace4ccd55cd3e55ef88e0b835&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(sm4_decrypt(sm4_key,ciphertext))</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<h3 id="choice"><a href="#choice" class="headerlink" title="*choice"></a>*choice</h3><h4 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;XYCTF&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">flag = flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">msg = bytes_to_long(flag)</span><br><span class="line">rand = Random()</span><br><span class="line">test = <span class="built_in">bytes</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>, -<span class="number">1</span>, -<span class="number">1</span>)])</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;output.py&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(<span class="string">f&#x27;enc = <span class="subst">&#123;msg ^ rand.getrandbits(msg.bit_length())&#125;</span>\nr = <span class="subst">&#123;[rand.choice(test) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2496</span>)]&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>题目把 choice 改了，要不然做不了，改了之后 choice 就和 getrandbit 没区别了</p>
<p>不要问我为什么会 division 还没搞出来 choice</p>
<p>因为我忘了第一次有一个 <strong>getrandbits(175)</strong> 了（</p>
<p>mmd</p>
<h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gf2bv <span class="keyword">import</span> LinearSystem</span><br><span class="line"><span class="keyword">from</span> gf2bv.crypto.mt <span class="keyword">import</span> MT19937</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">enc = <span class="number">5042764371819053176884777909105310461303359296255297</span></span><br><span class="line">r = [<span class="number">224</span>, <span class="number">55</span>, <span class="number">218</span>, <span class="number">253</span>, <span class="number">150</span>, <span class="number">84</span>, <span class="number">208</span>, <span class="number">134</span>, <span class="number">18</span>, <span class="number">177</span>, <span class="number">244</span>, <span class="number">54</span>, <span class="number">122</span>, <span class="number">193</span>, <span class="number">249</span>, <span class="number">5</span>, <span class="number">121</span>, <span class="number">80</span>, <span class="number">230</span>, <span class="number">21</span>, <span class="number">236</span>, <span class="number">33</span>, <span class="number">226</span>, <span class="number">3</span>, <span class="number">120</span>, <span class="number">141</span>, <span class="number">212</span>, <span class="number">33</span>, <span class="number">69</span>, <span class="number">195</span>, <span class="number">78</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">62</span>, <span class="number">64</span>, <span class="number">197</span>, <span class="number">10</span>, <span class="number">224</span>, <span class="number">64</span>, <span class="number">191</span>, <span class="number">17</span>, <span class="number">112</span>, <span class="number">196</span>, <span class="number">143</span>, <span class="number">209</span>, <span class="number">92</span>, <span class="number">10</span>, <span class="number">198</span>, <span class="number">174</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">118</span>, <span class="number">175</span>, <span class="number">145</span>, <span class="number">111</span>, <span class="number">41</span>, <span class="number">113</span>, <span class="number">206</span>, <span class="number">137</span>, <span class="number">37</span>, <span class="number">56</span>, <span class="number">227</span>, <span class="number">252</span>, <span class="number">84</span>, <span class="number">18</span>, <span class="number">145</span>, <span class="number">81</span>, <span class="number">124</span>, <span class="number">202</span>, <span class="number">14</span>, <span class="number">255</span>, <span class="number">144</span>, <span class="number">200</span>, <span class="number">13</span>, <span class="number">230</span>, <span class="number">218</span>, <span class="number">208</span>, <span class="number">210</span>, <span class="number">222</span>, <span class="number">101</span>, <span class="number">211</span>, <span class="number">114</span>, <span class="number">222</span>, <span class="number">12</span>, <span class="number">190</span>, <span class="number">226</span>, <span class="number">62</span>, <span class="number">118</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">118</span>, <span class="number">245</span>, <span class="number">196</span>, <span class="number">4</span>, <span class="number">92</span>, <span class="number">251</span>, <span class="number">238</span>, <span class="number">142</span>, <span class="number">114</span>, <span class="number">13</span>, <span class="number">113</span>, <span class="number">247</span>, <span class="number">171</span>, <span class="number">8</span>, <span class="number">138</span>, <span class="number">20</span>, <span class="number">169</span>, <span class="number">192</span>, <span class="number">221</span>, <span class="number">223</span>, <span class="number">60</span>, <span class="number">56</span>, <span class="number">188</span>, <span class="number">70</span>, <span class="number">184</span>, <span class="number">202</span>, <span class="number">195</span>, <span class="number">246</span>, <span class="number">71</span>, <span class="number">235</span>, <span class="number">152</span>, <span class="number">255</span>, <span class="number">73</span>, <span class="number">128</span>, <span class="number">140</span>, <span class="number">159</span>, <span class="number">119</span>, <span class="number">79</span>, <span class="number">1</span>, <span class="number">223</span>, <span class="number">239</span>, <span class="number">242</span>, <span class="number">60</span>, <span class="number">228</span>, <span class="number">205</span>, <span class="number">90</span>, <span class="number">210</span>, <span class="number">5</span>, <span class="number">165</span>, <span class="number">35</span>, <span class="number">176</span>, <span class="number">75</span>, <span class="number">21</span>, <span class="number">182</span>, <span class="number">220</span>, <span class="number">212</span>, <span class="number">240</span>, <span class="number">212</span>, <span class="number">77</span>, <span class="number">124</span>, <span class="number">52</span>, <span class="number">140</span>, <span class="number">85</span>, <span class="number">200</span>, <span class="number">207</span>, <span class="number">31</span>, <span class="number">177</span>, <span class="number">82</span>, <span class="number">76</span>, <span class="number">152</span>, <span class="number">128</span>, <span class="number">124</span>, <span class="number">205</span>, <span class="number">216</span>, <span class="number">252</span>, <span class="number">34</span>, <span class="number">27</span>, <span class="number">198</span>, <span class="number">186</span>, <span class="number">61</span>, <span class="number">161</span>, <span class="number">192</span>, <span class="number">158</span>, <span class="number">226</span>, <span class="number">40</span>, <span class="number">127</span>, <span class="number">69</span>, <span class="number">162</span>, <span class="number">24</span>, <span class="number">46</span>, <span class="number">208</span>, <span class="number">183</span>, <span class="number">99</span>, <span class="number">165</span>, <span class="number">1</span>, <span class="number">221</span>, <span class="number">184</span>, <span class="number">40</span>, <span class="number">147</span>, <span class="number">136</span>, <span class="number">236</span>, <span class="number">245</span>, <span class="number">228</span>, <span class="number">197</span>, <span class="number">86</span>, <span class="number">15</span>, <span class="number">201</span>, <span class="number">95</span>, <span class="number">115</span>, <span class="number">18</span>, <span class="number">131</span>, <span class="number">79</span>, <span class="number">86</span>, <span class="number">12</span>, <span class="number">122</span>, <span class="number">63</span>, <span class="number">200</span>, <span class="number">192</span>, <span class="number">244</span>, <span class="number">205</span>, <span class="number">229</span>, <span class="number">36</span>, <span class="number">86</span>, <span class="number">217</span>, <span class="number">249</span>, <span class="number">170</span>, <span class="number">5</span>, <span class="number">134</span>, <span class="number">99</span>, <span class="number">33</span>, <span class="number">214</span>, <span class="number">10</span>, <span class="number">120</span>, <span class="number">105</span>, <span class="number">233</span>, <span class="number">115</span>, <span class="number">230</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">84</span>, <span class="number">39</span>, <span class="number">167</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">77</span>, <span class="number">236</span>, <span class="number">104</span>, <span class="number">225</span>, <span class="number">196</span>, <span class="number">181</span>, <span class="number">105</span>, <span class="number">180</span>, <span class="number">159</span>, <span class="number">24</span>, <span class="number">4</span>, <span class="number">147</span>, <span class="number">131</span>, <span class="number">143</span>, <span class="number">64</span>, <span class="number">201</span>, <span class="number">212</span>, <span class="number">175</span>, <span class="number">203</span>, <span class="number">200</span>, <span class="number">19</span>, <span class="number">99</span>, <span class="number">24</span>, <span class="number">112</span>, <span class="number">180</span>, <span class="number">75</span>, <span class="number">222</span>, <span class="number">204</span>, <span class="number">204</span>, <span class="number">13</span>, <span class="number">210</span>, <span class="number">165</span>, <span class="number">135</span>, <span class="number">175</span>, <span class="number">132</span>, <span class="number">205</span>, <span class="number">247</span>, <span class="number">28</span>, <span class="number">178</span>, <span class="number">76</span>, <span class="number">240</span>, <span class="number">196</span>, <span class="number">240</span>, <span class="number">121</span>, <span class="number">132</span>, <span class="number">21</span>, <span class="number">8</span>, <span class="number">45</span>, <span class="number">203</span>, <span class="number">143</span>, <span class="number">206</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">47</span>, <span class="number">87</span>, <span class="number">88</span>, <span class="number">35</span>, <span class="number">63</span>, <span class="number">168</span>, <span class="number">251</span>, <span class="number">11</span>, <span class="number">254</span>, <span class="number">11</span>, <span class="number">46</span>, <span class="number">72</span>, <span class="number">210</span>, <span class="number">230</span>, <span class="number">184</span>, <span class="number">114</span>, <span class="number">88</span>, <span class="number">194</span>, <span class="number">99</span>, <span class="number">229</span>, <span class="number">144</span>, <span class="number">1</span>, <span class="number">226</span>, <span class="number">44</span>, <span class="number">133</span>, <span class="number">10</span>, <span class="number">42</span>, <span class="number">234</span>, <span class="number">112</span>, <span class="number">100</span>, <span class="number">248</span>, <span class="number">247</span>, <span class="number">66</span>, <span class="number">221</span>, <span class="number">72</span>, <span class="number">229</span>, <span class="number">236</span>, <span class="number">4</span>, <span class="number">65</span>, <span class="number">203</span>, <span class="number">65</span>, <span class="number">61</span>, <span class="number">23</span>, <span class="number">181</span>, <span class="number">190</span>, <span class="number">87</span>, <span class="number">1</span>, <span class="number">76</span>, <span class="number">113</span>, <span class="number">48</span>, <span class="number">178</span>, <span class="number">42</span>, <span class="number">175</span>, <span class="number">49</span>, <span class="number">78</span>, <span class="number">159</span>, <span class="number">104</span>, <span class="number">229</span>, <span class="number">213</span>, <span class="number">223</span>, <span class="number">13</span>, <span class="number">249</span>, <span class="number">216</span>, <span class="number">60</span>, <span class="number">144</span>, <span class="number">203</span>, <span class="number">156</span>, <span class="number">23</span>, <span class="number">129</span>, <span class="number">148</span>, <span class="number">87</span>, <span class="number">37</span>, <span class="number">79</span>, <span class="number">227</span>, <span class="number">141</span>, <span class="number">202</span>, <span class="number">210</span>, <span class="number">245</span>, <span class="number">236</span>, <span class="number">121</span>, <span class="number">129</span>, <span class="number">78</span>, <span class="number">7</span>, <span class="number">121</span>, <span class="number">42</span>, <span class="number">82</span>, <span class="number">184</span>, <span class="number">222</span>, <span class="number">96</span>, <span class="number">100</span>, <span class="number">189</span>, <span class="number">62</span>, <span class="number">102</span>, <span class="number">176</span>, <span class="number">198</span>, <span class="number">1</span>, <span class="number">153</span>, <span class="number">242</span>, <span class="number">23</span>, <span class="number">191</span>, <span class="number">197</span>, <span class="number">176</span>, <span class="number">115</span>, <span class="number">206</span>, <span class="number">122</span>, <span class="number">50</span>, <span class="number">104</span>, <span class="number">70</span>, <span class="number">170</span>, <span class="number">29</span>, <span class="number">52</span>, <span class="number">189</span>, <span class="number">157</span>, <span class="number">99</span>, <span class="number">82</span>, <span class="number">187</span>, <span class="number">201</span>, <span class="number">78</span>, <span class="number">25</span>, <span class="number">75</span>, <span class="number">126</span>, <span class="number">118</span>, <span class="number">160</span>, <span class="number">250</span>, <span class="number">53</span>, <span class="number">112</span>, <span class="number">143</span>, <span class="number">161</span>, <span class="number">251</span>, <span class="number">221</span>, <span class="number">44</span>, <span class="number">255</span>, <span class="number">232</span>, <span class="number">115</span>, <span class="number">182</span>, <span class="number">77</span>, <span class="number">31</span>, <span class="number">217</span>, <span class="number">228</span>, <span class="number">97</span>, <span class="number">112</span>, <span class="number">236</span>, <span class="number">21</span>, <span class="number">160</span>, <span class="number">127</span>, <span class="number">9</span>, <span class="number">220</span>, <span class="number">22</span>, <span class="number">97</span>, <span class="number">159</span>, <span class="number">239</span>, <span class="number">25</span>, <span class="number">140</span>, <span class="number">206</span>, <span class="number">210</span>, <span class="number">148</span>, <span class="number">105</span>, <span class="number">184</span>, <span class="number">41</span>, <span class="number">56</span>, <span class="number">92</span>, <span class="number">141</span>, <span class="number">3</span>, <span class="number">200</span>, <span class="number">165</span>, <span class="number">14</span>, <span class="number">161</span>, <span class="number">219</span>, <span class="number">177</span>, <span class="number">40</span>, <span class="number">189</span>, <span class="number">75</span>, <span class="number">48</span>, <span class="number">146</span>, <span class="number">130</span>, <span class="number">151</span>, <span class="number">100</span>, <span class="number">144</span>, <span class="number">239</span>, <span class="number">22</span>, <span class="number">19</span>, <span class="number">246</span>, <span class="number">166</span>, <span class="number">231</span>, <span class="number">228</span>, <span class="number">68</span>, <span class="number">254</span>, <span class="number">16</span>, <span class="number">99</span>, <span class="number">95</span>, <span class="number">32</span>, <span class="number">177</span>, <span class="number">216</span>, <span class="number">170</span>, <span class="number">125</span>, <span class="number">211</span>, <span class="number">100</span>, <span class="number">142</span>, <span class="number">251</span>, <span class="number">16</span>, <span class="number">64</span>, <span class="number">83</span>, <span class="number">161</span>, <span class="number">184</span>, <span class="number">242</span>, <span class="number">248</span>, <span class="number">239</span>, <span class="number">141</span>, <span class="number">171</span>, <span class="number">135</span>, <span class="number">48</span>, <span class="number">20</span>, <span class="number">34</span>, <span class="number">250</span>, <span class="number">13</span>, <span class="number">70</span>, <span class="number">236</span>, <span class="number">172</span>, <span class="number">22</span>, <span class="number">241</span>, <span class="number">171</span>, <span class="number">25</span>, <span class="number">18</span>, <span class="number">204</span>, <span class="number">36</span>, <span class="number">248</span>, <span class="number">253</span>, <span class="number">203</span>, <span class="number">138</span>, <span class="number">10</span>, <span class="number">130</span>, <span class="number">249</span>, <span class="number">15</span>, <span class="number">157</span>, <span class="number">244</span>, <span class="number">154</span>, <span class="number">41</span>, <span class="number">4</span>, <span class="number">231</span>, <span class="number">64</span>, <span class="number">20</span>, <span class="number">212</span>, <span class="number">126</span>, <span class="number">160</span>, <span class="number">48</span>, <span class="number">154</span>, <span class="number">171</span>, <span class="number">250</span>, <span class="number">199</span>, <span class="number">113</span>, <span class="number">32</span>, <span class="number">186</span>, <span class="number">126</span>, <span class="number">217</span>, <span class="number">3</span>, <span class="number">236</span>, <span class="number">115</span>, <span class="number">37</span>, <span class="number">174</span>, <span class="number">75</span>, <span class="number">222</span>, <span class="number">125</span>, <span class="number">55</span>, <span class="number">86</span>, <span class="number">65</span>, <span class="number">96</span>, <span class="number">56</span>, <span class="number">254</span>, <span class="number">226</span>, <span class="number">213</span>, <span class="number">244</span>, <span class="number">36</span>, <span class="number">199</span>, <span class="number">164</span>, <span class="number">160</span>, <span class="number">126</span>, <span class="number">191</span>, <span class="number">29</span>, <span class="number">50</span>, <span class="number">135</span>, <span class="number">234</span>, <span class="number">165</span>, <span class="number">122</span>, <span class="number">132</span>, <span class="number">68</span>, <span class="number">133</span>, <span class="number">129</span>, <span class="number">0</span>, <span class="number">220</span>, <span class="number">72</span>, <span class="number">87</span>, <span class="number">172</span>, <span class="number">93</span>, <span class="number">15</span>, <span class="number">131</span>, <span class="number">37</span>, <span class="number">119</span>, <span class="number">240</span>, <span class="number">43</span>, <span class="number">239</span>, <span class="number">105</span>, <span class="number">45</span>, <span class="number">244</span>, <span class="number">6</span>, <span class="number">34</span>, <span class="number">111</span>, <span class="number">151</span>, <span class="number">144</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">159</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">160</span>, <span class="number">32</span>, <span class="number">4</span>, <span class="number">180</span>, <span class="number">246</span>, <span class="number">39</span>, <span class="number">220</span>, <span class="number">85</span>, <span class="number">209</span>, <span class="number">145</span>, <span class="number">41</span>, <span class="number">88</span>, <span class="number">137</span>, <span class="number">110</span>, <span class="number">101</span>, <span class="number">113</span>, <span class="number">115</span>, <span class="number">204</span>, <span class="number">11</span>, <span class="number">53</span>, <span class="number">152</span>, <span class="number">177</span>, <span class="number">240</span>, <span class="number">193</span>, <span class="number">220</span>, <span class="number">136</span>, <span class="number">84</span>, <span class="number">221</span>, <span class="number">12</span>, <span class="number">43</span>, <span class="number">74</span>, <span class="number">122</span>, <span class="number">251</span>, <span class="number">236</span>, <span class="number">53</span>, <span class="number">175</span>, <span class="number">36</span>, <span class="number">46</span>, <span class="number">246</span>, <span class="number">181</span>, <span class="number">137</span>, <span class="number">246</span>, <span class="number">53</span>, <span class="number">189</span>, <span class="number">171</span>, <span class="number">240</span>, <span class="number">104</span>, <span class="number">8</span>, <span class="number">126</span>, <span class="number">56</span>, <span class="number">122</span>, <span class="number">245</span>, <span class="number">155</span>, <span class="number">130</span>, <span class="number">31</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">212</span>, <span class="number">147</span>, <span class="number">33</span>, <span class="number">165</span>, <span class="number">82</span>, <span class="number">117</span>, <span class="number">244</span>, <span class="number">167</span>, <span class="number">235</span>, <span class="number">115</span>, <span class="number">244</span>, <span class="number">94</span>, <span class="number">173</span>, <span class="number">195</span>, <span class="number">34</span>, <span class="number">36</span>, <span class="number">33</span>, <span class="number">218</span>, <span class="number">39</span>, <span class="number">13</span>, <span class="number">90</span>, <span class="number">196</span>, <span class="number">172</span>, <span class="number">207</span>, <span class="number">105</span>, <span class="number">73</span>, <span class="number">255</span>, <span class="number">187</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">242</span>, <span class="number">186</span>, <span class="number">122</span>, <span class="number">140</span>, <span class="number">241</span>, <span class="number">120</span>, <span class="number">98</span>, <span class="number">44</span>, <span class="number">81</span>, <span class="number">172</span>, <span class="number">201</span>, <span class="number">150</span>, <span class="number">238</span>, <span class="number">111</span>, <span class="number">147</span>, <span class="number">24</span>, <span class="number">214</span>, <span class="number">192</span>, <span class="number">125</span>, <span class="number">102</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">219</span>, <span class="number">172</span>, <span class="number">123</span>, <span class="number">218</span>, <span class="number">222</span>, <span class="number">71</span>, <span class="number">138</span>, <span class="number">117</span>, <span class="number">188</span>, <span class="number">32</span>, <span class="number">104</span>, <span class="number">10</span>, <span class="number">188</span>, <span class="number">118</span>, <span class="number">58</span>, <span class="number">254</span>, <span class="number">36</span>, <span class="number">104</span>, <span class="number">212</span>, <span class="number">76</span>, <span class="number">209</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">33</span>, <span class="number">149</span>, <span class="number">15</span>, <span class="number">225</span>, <span class="number">76</span>, <span class="number">8</span>, <span class="number">157</span>, <span class="number">48</span>, <span class="number">70</span>, <span class="number">127</span>, <span class="number">19</span>, <span class="number">126</span>, <span class="number">77</span>, <span class="number">216</span>, <span class="number">133</span>, <span class="number">132</span>, <span class="number">30</span>, <span class="number">33</span>, <span class="number">113</span>, <span class="number">117</span>, <span class="number">134</span>, <span class="number">238</span>, <span class="number">57</span>, <span class="number">20</span>, <span class="number">121</span>, <span class="number">26</span>, <span class="number">184</span>, <span class="number">229</span>, <span class="number">202</span>, <span class="number">90</span>, <span class="number">28</span>, <span class="number">42</span>, <span class="number">230</span>, <span class="number">42</span>, <span class="number">159</span>, <span class="number">19</span>, <span class="number">191</span>, <span class="number">162</span>, <span class="number">205</span>, <span class="number">241</span>, <span class="number">67</span>, <span class="number">177</span>, <span class="number">216</span>, <span class="number">191</span>, <span class="number">164</span>, <span class="number">146</span>, <span class="number">90</span>, <span class="number">228</span>, <span class="number">232</span>, <span class="number">149</span>, <span class="number">163</span>, <span class="number">135</span>, <span class="number">130</span>, <span class="number">193</span>, <span class="number">196</span>, <span class="number">178</span>, <span class="number">215</span>, <span class="number">216</span>, <span class="number">155</span>, <span class="number">238</span>, <span class="number">20</span>, <span class="number">36</span>, <span class="number">196</span>, <span class="number">153</span>, <span class="number">207</span>, <span class="number">177</span>, <span class="number">149</span>, <span class="number">40</span>, <span class="number">172</span>, <span class="number">139</span>, <span class="number">12</span>, <span class="number">134</span>, <span class="number">142</span>, <span class="number">154</span>, <span class="number">225</span>, <span class="number">179</span>, <span class="number">95</span>, <span class="number">248</span>, <span class="number">190</span>, <span class="number">8</span>, <span class="number">154</span>, <span class="number">246</span>, <span class="number">229</span>, <span class="number">102</span>, <span class="number">121</span>, <span class="number">197</span>, <span class="number">116</span>, <span class="number">135</span>, <span class="number">163</span>, <span class="number">128</span>, <span class="number">109</span>, <span class="number">112</span>, <span class="number">114</span>, <span class="number">143</span>, <span class="number">164</span>, <span class="number">134</span>, <span class="number">233</span>, <span class="number">45</span>, <span class="number">244</span>, <span class="number">22</span>, <span class="number">141</span>, <span class="number">211</span>, <span class="number">214</span>, <span class="number">122</span>, <span class="number">14</span>, <span class="number">93</span>, <span class="number">49</span>, <span class="number">251</span>, <span class="number">85</span>, <span class="number">95</span>, <span class="number">95</span>, <span class="number">191</span>, <span class="number">210</span>, <span class="number">245</span>, <span class="number">181</span>, <span class="number">142</span>, <span class="number">125</span>, <span class="number">110</span>, <span class="number">33</span>, <span class="number">195</span>, <span class="number">150</span>, <span class="number">197</span>, <span class="number">173</span>, <span class="number">86</span>, <span class="number">50</span>, <span class="number">127</span>, <span class="number">187</span>, <span class="number">129</span>, <span class="number">67</span>, <span class="number">119</span>, <span class="number">58</span>, <span class="number">134</span>, <span class="number">119</span>, <span class="number">36</span>, <span class="number">151</span>, <span class="number">136</span>, <span class="number">122</span>, <span class="number">157</span>, <span class="number">22</span>, <span class="number">171</span>, <span class="number">195</span>, <span class="number">48</span>, <span class="number">178</span>, <span class="number">232</span>, <span class="number">228</span>, <span class="number">177</span>, <span class="number">6</span>, <span class="number">124</span>, <span class="number">50</span>, <span class="number">163</span>, <span class="number">161</span>, <span class="number">32</span>, <span class="number">49</span>, <span class="number">197</span>, <span class="number">157</span>, <span class="number">188</span>, <span class="number">86</span>, <span class="number">208</span>, <span class="number">226</span>, <span class="number">208</span>, <span class="number">63</span>, <span class="number">173</span>, <span class="number">21</span>, <span class="number">192</span>, <span class="number">148</span>, <span class="number">194</span>, <span class="number">208</span>, <span class="number">251</span>, <span class="number">95</span>, <span class="number">117</span>, <span class="number">34</span>, <span class="number">116</span>, <span class="number">217</span>, <span class="number">130</span>, <span class="number">150</span>, <span class="number">97</span>, <span class="number">206</span>, <span class="number">101</span>, <span class="number">201</span>, <span class="number">88</span>, <span class="number">137</span>, <span class="number">163</span>, <span class="number">90</span>, <span class="number">104</span>, <span class="number">129</span>, <span class="number">4</span>, <span class="number">191</span>, <span class="number">99</span>, <span class="number">50</span>, <span class="number">115</span>, <span class="number">8</span>, <span class="number">145</span>, <span class="number">116</span>, <span class="number">250</span>, <span class="number">180</span>, <span class="number">193</span>, <span class="number">229</span>, <span class="number">128</span>, <span class="number">92</span>, <span class="number">55</span>, <span class="number">26</span>, <span class="number">6</span>, <span class="number">154</span>, <span class="number">68</span>, <span class="number">0</span>, <span class="number">66</span>, <span class="number">77</span>, <span class="number">126</span>, <span class="number">192</span>, <span class="number">170</span>, <span class="number">218</span>, <span class="number">252</span>, <span class="number">127</span>, <span class="number">192</span>, <span class="number">29</span>, <span class="number">107</span>, <span class="number">152</span>, <span class="number">231</span>, <span class="number">190</span>, <span class="number">202</span>, <span class="number">130</span>, <span class="number">116</span>, <span class="number">229</span>, <span class="number">193</span>, <span class="number">63</span>, <span class="number">13</span>, <span class="number">48</span>, <span class="number">220</span>, <span class="number">238</span>, <span class="number">126</span>, <span class="number">74</span>, <span class="number">232</span>, <span class="number">19</span>, <span class="number">242</span>, <span class="number">71</span>, <span class="number">159</span>, <span class="number">9</span>, <span class="number">196</span>, <span class="number">187</span>, <span class="number">111</span>, <span class="number">243</span>, <span class="number">81</span>, <span class="number">244</span>, <span class="number">193</span>, <span class="number">95</span>, <span class="number">166</span>, <span class="number">85</span>, <span class="number">22</span>, <span class="number">240</span>, <span class="number">32</span>, <span class="number">1</span>, <span class="number">114</span>, <span class="number">11</span>, <span class="number">64</span>, <span class="number">114</span>, <span class="number">149</span>, <span class="number">217</span>, <span class="number">207</span>, <span class="number">194</span>, <span class="number">1</span>, <span class="number">33</span>, <span class="number">245</span>, <span class="number">14</span>, <span class="number">101</span>, <span class="number">119</span>, <span class="number">32</span>, <span class="number">233</span>, <span class="number">214</span>, <span class="number">139</span>, <span class="number">71</span>, <span class="number">103</span>, <span class="number">125</span>, <span class="number">54</span>, <span class="number">17</span>, <span class="number">86</span>, <span class="number">140</span>, <span class="number">132</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">227</span>, <span class="number">136</span>, <span class="number">203</span>, <span class="number">156</span>, <span class="number">223</span>, <span class="number">73</span>, <span class="number">43</span>, <span class="number">82</span>, <span class="number">190</span>, <span class="number">119</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">115</span>, <span class="number">0</span>, <span class="number">192</span>, <span class="number">105</span>, <span class="number">147</span>, <span class="number">210</span>, <span class="number">146</span>, <span class="number">47</span>, <span class="number">89</span>, <span class="number">210</span>, <span class="number">18</span>, <span class="number">225</span>, <span class="number">126</span>, <span class="number">210</span>, <span class="number">240</span>, <span class="number">55</span>, <span class="number">219</span>, <span class="number">247</span>, <span class="number">106</span>, <span class="number">190</span>, <span class="number">50</span>, <span class="number">35</span>, <span class="number">13</span>, <span class="number">255</span>, <span class="number">236</span>, <span class="number">253</span>, <span class="number">82</span>, <span class="number">244</span>, <span class="number">117</span>, <span class="number">139</span>, <span class="number">1</span>, <span class="number">72</span>, <span class="number">182</span>, <span class="number">19</span>, <span class="number">170</span>, <span class="number">173</span>, <span class="number">59</span>, <span class="number">175</span>, <span class="number">10</span>, <span class="number">95</span>, <span class="number">66</span>, <span class="number">253</span>, <span class="number">178</span>, <span class="number">139</span>, <span class="number">45</span>, <span class="number">5</span>, <span class="number">24</span>, <span class="number">59</span>, <span class="number">9</span>, <span class="number">222</span>, <span class="number">58</span>, <span class="number">46</span>, <span class="number">79</span>, <span class="number">48</span>, <span class="number">39</span>, <span class="number">175</span>, <span class="number">196</span>, <span class="number">249</span>, <span class="number">249</span>, <span class="number">70</span>, <span class="number">126</span>, <span class="number">118</span>, <span class="number">69</span>, <span class="number">165</span>, <span class="number">155</span>, <span class="number">119</span>, <span class="number">67</span>, <span class="number">221</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">16</span>, <span class="number">99</span>, <span class="number">41</span>, <span class="number">132</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">35</span>, <span class="number">70</span>, <span class="number">87</span>, <span class="number">43</span>, <span class="number">197</span>, <span class="number">103</span>, <span class="number">33</span>, <span class="number">201</span>, <span class="number">3</span>, <span class="number">195</span>, <span class="number">142</span>, <span class="number">128</span>, <span class="number">135</span>, <span class="number">121</span>, <span class="number">26</span>, <span class="number">185</span>, <span class="number">2</span>, <span class="number">73</span>, <span class="number">235</span>, <span class="number">70</span>, <span class="number">219</span>, <span class="number">49</span>, <span class="number">227</span>, <span class="number">133</span>, <span class="number">241</span>, <span class="number">34</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">109</span>, <span class="number">66</span>, <span class="number">50</span>, <span class="number">177</span>, <span class="number">114</span>, <span class="number">119</span>, <span class="number">101</span>, <span class="number">91</span>, <span class="number">144</span>, <span class="number">41</span>, <span class="number">246</span>, <span class="number">40</span>, <span class="number">81</span>, <span class="number">113</span>, <span class="number">203</span>, <span class="number">226</span>, <span class="number">87</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">73</span>, <span class="number">212</span>, <span class="number">5</span>, <span class="number">95</span>, <span class="number">112</span>, <span class="number">230</span>, <span class="number">4</span>, <span class="number">28</span>, <span class="number">206</span>, <span class="number">93</span>, <span class="number">252</span>, <span class="number">30</span>, <span class="number">195</span>, <span class="number">197</span>, <span class="number">226</span>, <span class="number">165</span>, <span class="number">120</span>, <span class="number">3</span>, <span class="number">124</span>, <span class="number">169</span>, <span class="number">66</span>, <span class="number">227</span>, <span class="number">113</span>, <span class="number">55</span>, <span class="number">101</span>, <span class="number">135</span>, <span class="number">141</span>, <span class="number">71</span>, <span class="number">84</span>, <span class="number">202</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">25</span>, <span class="number">92</span>, <span class="number">50</span>, <span class="number">80</span>, <span class="number">53</span>, <span class="number">63</span>, <span class="number">85</span>, <span class="number">184</span>, <span class="number">196</span>, <span class="number">93</span>, <span class="number">254</span>, <span class="number">47</span>, <span class="number">252</span>, <span class="number">182</span>, <span class="number">150</span>, <span class="number">115</span>, <span class="number">20</span>, <span class="number">181</span>, <span class="number">178</span>, <span class="number">87</span>, <span class="number">162</span>, <span class="number">50</span>, <span class="number">190</span>, <span class="number">228</span>, <span class="number">125</span>, <span class="number">240</span>, <span class="number">134</span>, <span class="number">10</span>, <span class="number">142</span>, <span class="number">173</span>, <span class="number">206</span>, <span class="number">250</span>, <span class="number">49</span>, <span class="number">186</span>, <span class="number">201</span>, <span class="number">118</span>, <span class="number">146</span>, <span class="number">246</span>, <span class="number">244</span>, <span class="number">199</span>, <span class="number">9</span>, <span class="number">55</span>, <span class="number">253</span>, <span class="number">123</span>, <span class="number">103</span>, <span class="number">200</span>, <span class="number">206</span>, <span class="number">79</span>, <span class="number">168</span>, <span class="number">216</span>, <span class="number">99</span>, <span class="number">192</span>, <span class="number">191</span>, <span class="number">236</span>, <span class="number">214</span>, <span class="number">248</span>, <span class="number">111</span>, <span class="number">115</span>, <span class="number">74</span>, <span class="number">155</span>, <span class="number">165</span>, <span class="number">150</span>, <span class="number">40</span>, <span class="number">86</span>, <span class="number">224</span>, <span class="number">240</span>, <span class="number">133</span>, <span class="number">69</span>, <span class="number">34</span>, <span class="number">52</span>, <span class="number">13</span>, <span class="number">63</span>, <span class="number">61</span>, <span class="number">116</span>, <span class="number">182</span>, <span class="number">144</span>, <span class="number">177</span>, <span class="number">101</span>, <span class="number">164</span>, <span class="number">77</span>, <span class="number">217</span>, <span class="number">65</span>, <span class="number">218</span>, <span class="number">150</span>, <span class="number">142</span>, <span class="number">249</span>, <span class="number">165</span>, <span class="number">160</span>, <span class="number">220</span>, <span class="number">120</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">157</span>, <span class="number">134</span>, <span class="number">223</span>, <span class="number">11</span>, <span class="number">46</span>, <span class="number">121</span>, <span class="number">75</span>, <span class="number">182</span>, <span class="number">126</span>, <span class="number">104</span>, <span class="number">91</span>, <span class="number">204</span>, <span class="number">45</span>, <span class="number">49</span>, <span class="number">175</span>, <span class="number">10</span>, <span class="number">48</span>, <span class="number">83</span>, <span class="number">150</span>, <span class="number">96</span>, <span class="number">244</span>, <span class="number">10</span>, <span class="number">149</span>, <span class="number">76</span>, <span class="number">124</span>, <span class="number">189</span>, <span class="number">149</span>, <span class="number">200</span>, <span class="number">252</span>, <span class="number">175</span>, <span class="number">124</span>, <span class="number">146</span>, <span class="number">126</span>, <span class="number">230</span>, <span class="number">70</span>, <span class="number">194</span>, <span class="number">243</span>, <span class="number">63</span>, <span class="number">204</span>, <span class="number">224</span>, <span class="number">115</span>, <span class="number">140</span>, <span class="number">115</span>, <span class="number">110</span>, <span class="number">86</span>, <span class="number">22</span>, <span class="number">193</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">18</span>, <span class="number">177</span>, <span class="number">159</span>, <span class="number">94</span>, <span class="number">160</span>, <span class="number">38</span>, <span class="number">188</span>, <span class="number">139</span>, <span class="number">89</span>, <span class="number">1</span>, <span class="number">200</span>, <span class="number">163</span>, <span class="number">138</span>, <span class="number">8</span>, <span class="number">140</span>, <span class="number">169</span>, <span class="number">54</span>, <span class="number">29</span>, <span class="number">225</span>, <span class="number">22</span>, <span class="number">5</span>, <span class="number">99</span>, <span class="number">144</span>, <span class="number">247</span>, <span class="number">239</span>, <span class="number">106</span>, <span class="number">77</span>, <span class="number">29</span>, <span class="number">141</span>, <span class="number">206</span>, <span class="number">89</span>, <span class="number">236</span>, <span class="number">4</span>, <span class="number">32</span>, <span class="number">104</span>, <span class="number">115</span>, <span class="number">206</span>, <span class="number">204</span>, <span class="number">15</span>, <span class="number">100</span>, <span class="number">66</span>, <span class="number">199</span>, <span class="number">15</span>, <span class="number">89</span>, <span class="number">24</span>, <span class="number">246</span>, <span class="number">99</span>, <span class="number">224</span>, <span class="number">207</span>, <span class="number">7</span>, <span class="number">205</span>, <span class="number">142</span>, <span class="number">203</span>, <span class="number">28</span>, <span class="number">87</span>, <span class="number">16</span>, <span class="number">110</span>, <span class="number">93</span>, <span class="number">72</span>, <span class="number">73</span>, <span class="number">206</span>, <span class="number">48</span>, <span class="number">59</span>, <span class="number">170</span>, <span class="number">152</span>, <span class="number">224</span>, <span class="number">2</span>, <span class="number">74</span>, <span class="number">9</span>, <span class="number">125</span>, <span class="number">140</span>, <span class="number">82</span>, <span class="number">206</span>, <span class="number">159</span>, <span class="number">0</span>, <span class="number">117</span>, <span class="number">237</span>, <span class="number">252</span>, <span class="number">47</span>, <span class="number">200</span>, <span class="number">75</span>, <span class="number">133</span>, <span class="number">68</span>, <span class="number">239</span>, <span class="number">109</span>, <span class="number">169</span>, <span class="number">25</span>, <span class="number">168</span>, <span class="number">202</span>, <span class="number">240</span>, <span class="number">5</span>, <span class="number">67</span>, <span class="number">125</span>, <span class="number">173</span>, <span class="number">233</span>, <span class="number">6</span>, <span class="number">148</span>, <span class="number">38</span>, <span class="number">182</span>, <span class="number">13</span>, <span class="number">141</span>, <span class="number">149</span>, <span class="number">39</span>, <span class="number">119</span>, <span class="number">189</span>, <span class="number">122</span>, <span class="number">49</span>, <span class="number">173</span>, <span class="number">153</span>, <span class="number">78</span>, <span class="number">103</span>, <span class="number">211</span>, <span class="number">65</span>, <span class="number">224</span>, <span class="number">52</span>, <span class="number">10</span>, <span class="number">35</span>, <span class="number">233</span>, <span class="number">88</span>, <span class="number">66</span>, <span class="number">43</span>, <span class="number">120</span>, <span class="number">255</span>, <span class="number">71</span>, <span class="number">169</span>, <span class="number">215</span>, <span class="number">250</span>, <span class="number">218</span>, <span class="number">205</span>, <span class="number">163</span>, <span class="number">164</span>, <span class="number">226</span>, <span class="number">46</span>, <span class="number">178</span>, <span class="number">25</span>, <span class="number">88</span>, <span class="number">59</span>, <span class="number">98</span>, <span class="number">199</span>, <span class="number">167</span>, <span class="number">134</span>, <span class="number">244</span>, <span class="number">167</span>, <span class="number">210</span>, <span class="number">20</span>, <span class="number">246</span>, <span class="number">159</span>, <span class="number">163</span>, <span class="number">252</span>, <span class="number">114</span>, <span class="number">5</span>, <span class="number">168</span>, <span class="number">52</span>, <span class="number">47</span>, <span class="number">177</span>, <span class="number">159</span>, <span class="number">255</span>, <span class="number">236</span>, <span class="number">166</span>, <span class="number">49</span>, <span class="number">36</span>, <span class="number">61</span>, <span class="number">10</span>, <span class="number">130</span>, <span class="number">135</span>, <span class="number">220</span>, <span class="number">101</span>, <span class="number">202</span>, <span class="number">69</span>, <span class="number">150</span>, <span class="number">100</span>, <span class="number">217</span>, <span class="number">98</span>, <span class="number">203</span>, <span class="number">217</span>, <span class="number">166</span>, <span class="number">33</span>, <span class="number">169</span>, <span class="number">203</span>, <span class="number">230</span>, <span class="number">194</span>, <span class="number">224</span>, <span class="number">15</span>, <span class="number">249</span>, <span class="number">205</span>, <span class="number">52</span>, <span class="number">41</span>, <span class="number">124</span>, <span class="number">191</span>, <span class="number">223</span>, <span class="number">148</span>, <span class="number">251</span>, <span class="number">147</span>, <span class="number">133</span>, <span class="number">85</span>, <span class="number">149</span>, <span class="number">214</span>, <span class="number">198</span>, <span class="number">5</span>, <span class="number">134</span>, <span class="number">91</span>, <span class="number">201</span>, <span class="number">191</span>, <span class="number">204</span>, <span class="number">152</span>, <span class="number">240</span>, <span class="number">37</span>, <span class="number">34</span>, <span class="number">236</span>, <span class="number">211</span>, <span class="number">182</span>, <span class="number">142</span>, <span class="number">207</span>, <span class="number">1</span>, <span class="number">188</span>, <span class="number">67</span>, <span class="number">87</span>, <span class="number">222</span>, <span class="number">220</span>, <span class="number">7</span>, <span class="number">78</span>, <span class="number">49</span>, <span class="number">129</span>, <span class="number">236</span>, <span class="number">98</span>, <span class="number">120</span>, <span class="number">217</span>, <span class="number">204</span>, <span class="number">77</span>, <span class="number">106</span>, <span class="number">89</span>, <span class="number">250</span>, <span class="number">182</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">27</span>, <span class="number">143</span>, <span class="number">13</span>, <span class="number">27</span>, <span class="number">61</span>, <span class="number">223</span>, <span class="number">213</span>, <span class="number">196</span>, <span class="number">190</span>, <span class="number">24</span>, <span class="number">35</span>, <span class="number">104</span>, <span class="number">100</span>, <span class="number">220</span>, <span class="number">60</span>, <span class="number">194</span>, <span class="number">174</span>, <span class="number">169</span>, <span class="number">20</span>, <span class="number">167</span>, <span class="number">75</span>, <span class="number">162</span>, <span class="number">26</span>, <span class="number">253</span>, <span class="number">213</span>, <span class="number">59</span>, <span class="number">219</span>, <span class="number">187</span>, <span class="number">253</span>, <span class="number">160</span>, <span class="number">249</span>, <span class="number">61</span>, <span class="number">122</span>, <span class="number">113</span>, <span class="number">223</span>, <span class="number">55</span>, <span class="number">57</span>, <span class="number">198</span>, <span class="number">53</span>, <span class="number">138</span>, <span class="number">94</span>, <span class="number">154</span>, <span class="number">18</span>, <span class="number">132</span>, <span class="number">233</span>, <span class="number">183</span>, <span class="number">71</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">50</span>, <span class="number">196</span>, <span class="number">181</span>, <span class="number">202</span>, <span class="number">103</span>, <span class="number">86</span>, <span class="number">31</span>, <span class="number">119</span>, <span class="number">83</span>, <span class="number">130</span>, <span class="number">165</span>, <span class="number">242</span>, <span class="number">170</span>, <span class="number">31</span>, <span class="number">35</span>, <span class="number">175</span>, <span class="number">117</span>, <span class="number">95</span>, <span class="number">89</span>, <span class="number">247</span>, <span class="number">221</span>, <span class="number">186</span>, <span class="number">47</span>, <span class="number">236</span>, <span class="number">241</span>, <span class="number">77</span>, <span class="number">194</span>, <span class="number">111</span>, <span class="number">148</span>, <span class="number">45</span>, <span class="number">101</span>, <span class="number">88</span>, <span class="number">41</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">139</span>, <span class="number">15</span>, <span class="number">127</span>, <span class="number">156</span>, <span class="number">72</span>, <span class="number">234</span>, <span class="number">217</span>, <span class="number">170</span>, <span class="number">218</span>, <span class="number">216</span>, <span class="number">31</span>, <span class="number">4</span>, <span class="number">73</span>, <span class="number">150</span>, <span class="number">78</span>, <span class="number">49</span>, <span class="number">178</span>, <span class="number">13</span>, <span class="number">178</span>, <span class="number">46</span>, <span class="number">102</span>, <span class="number">93</span>, <span class="number">184</span>, <span class="number">110</span>, <span class="number">205</span>, <span class="number">132</span>, <span class="number">190</span>, <span class="number">43</span>, <span class="number">87</span>, <span class="number">194</span>, <span class="number">35</span>, <span class="number">188</span>, <span class="number">166</span>, <span class="number">9</span>, <span class="number">97</span>, <span class="number">184</span>, <span class="number">202</span>, <span class="number">113</span>, <span class="number">45</span>, <span class="number">150</span>, <span class="number">62</span>, <span class="number">106</span>, <span class="number">108</span>, <span class="number">19</span>, <span class="number">162</span>, <span class="number">85</span>, <span class="number">212</span>, <span class="number">188</span>, <span class="number">131</span>, <span class="number">38</span>, <span class="number">67</span>, <span class="number">23</span>, <span class="number">136</span>, <span class="number">208</span>, <span class="number">87</span>, <span class="number">63</span>, <span class="number">69</span>, <span class="number">6</span>, <span class="number">209</span>, <span class="number">242</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">228</span>, <span class="number">14</span>, <span class="number">233</span>, <span class="number">8</span>, <span class="number">71</span>, <span class="number">43</span>, <span class="number">51</span>, <span class="number">89</span>, <span class="number">46</span>, <span class="number">195</span>, <span class="number">101</span>, <span class="number">132</span>, <span class="number">254</span>, <span class="number">154</span>, <span class="number">183</span>, <span class="number">220</span>, <span class="number">115</span>, <span class="number">221</span>, <span class="number">255</span>, <span class="number">174</span>, <span class="number">150</span>, <span class="number">65</span>, <span class="number">141</span>, <span class="number">176</span>, <span class="number">57</span>, <span class="number">144</span>, <span class="number">16</span>, <span class="number">115</span>, <span class="number">252</span>, <span class="number">144</span>, <span class="number">139</span>, <span class="number">52</span>, <span class="number">205</span>, <span class="number">224</span>, <span class="number">75</span>, <span class="number">190</span>, <span class="number">192</span>, <span class="number">2</span>, <span class="number">231</span>, <span class="number">30</span>, <span class="number">238</span>, <span class="number">149</span>, <span class="number">22</span>, <span class="number">200</span>, <span class="number">137</span>, <span class="number">244</span>, <span class="number">239</span>, <span class="number">185</span>, <span class="number">212</span>, <span class="number">145</span>, <span class="number">230</span>, <span class="number">200</span>, <span class="number">8</span>, <span class="number">249</span>, <span class="number">109</span>, <span class="number">26</span>, <span class="number">226</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">140</span>, <span class="number">103</span>, <span class="number">50</span>, <span class="number">230</span>, <span class="number">180</span>, <span class="number">47</span>, <span class="number">196</span>, <span class="number">226</span>, <span class="number">105</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">135</span>, <span class="number">20</span>, <span class="number">214</span>, <span class="number">152</span>, <span class="number">211</span>, <span class="number">208</span>, <span class="number">81</span>, <span class="number">213</span>, <span class="number">48</span>, <span class="number">187</span>, <span class="number">232</span>, <span class="number">77</span>, <span class="number">139</span>, <span class="number">16</span>, <span class="number">79</span>, <span class="number">204</span>, <span class="number">216</span>, <span class="number">56</span>, <span class="number">41</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">192</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">104</span>, <span class="number">85</span>, <span class="number">42</span>, <span class="number">107</span>, <span class="number">94</span>, <span class="number">142</span>, <span class="number">12</span>, <span class="number">247</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">116</span>, <span class="number">72</span>, <span class="number">193</span>, <span class="number">219</span>, <span class="number">54</span>, <span class="number">247</span>, <span class="number">5</span>, <span class="number">28</span>, <span class="number">60</span>, <span class="number">140</span>, <span class="number">10</span>, <span class="number">185</span>, <span class="number">86</span>, <span class="number">148</span>, <span class="number">101</span>, <span class="number">198</span>, <span class="number">96</span>, <span class="number">181</span>, <span class="number">245</span>, <span class="number">61</span>, <span class="number">25</span>, <span class="number">186</span>, <span class="number">29</span>, <span class="number">57</span>, <span class="number">176</span>, <span class="number">188</span>, <span class="number">9</span>, <span class="number">239</span>, <span class="number">93</span>, <span class="number">198</span>, <span class="number">110</span>, <span class="number">248</span>, <span class="number">23</span>, <span class="number">87</span>, <span class="number">193</span>, <span class="number">161</span>, <span class="number">107</span>, <span class="number">40</span>, <span class="number">38</span>, <span class="number">186</span>, <span class="number">205</span>, <span class="number">148</span>, <span class="number">197</span>, <span class="number">127</span>, <span class="number">144</span>, <span class="number">69</span>, <span class="number">19</span>, <span class="number">47</span>, <span class="number">132</span>, <span class="number">82</span>, <span class="number">23</span>, <span class="number">170</span>, <span class="number">83</span>, <span class="number">224</span>, <span class="number">235</span>, <span class="number">49</span>, <span class="number">190</span>, <span class="number">44</span>, <span class="number">145</span>, <span class="number">65</span>, <span class="number">66</span>, <span class="number">141</span>, <span class="number">78</span>, <span class="number">1</span>, <span class="number">254</span>, <span class="number">24</span>, <span class="number">157</span>, <span class="number">7</span>, <span class="number">23</span>, <span class="number">227</span>, <span class="number">28</span>, <span class="number">81</span>, <span class="number">176</span>, <span class="number">22</span>, <span class="number">92</span>, <span class="number">139</span>, <span class="number">188</span>, <span class="number">48</span>, <span class="number">183</span>, <span class="number">229</span>, <span class="number">139</span>, <span class="number">205</span>, <span class="number">174</span>, <span class="number">131</span>, <span class="number">189</span>, <span class="number">241</span>, <span class="number">21</span>, <span class="number">146</span>, <span class="number">204</span>, <span class="number">58</span>, <span class="number">249</span>, <span class="number">167</span>, <span class="number">217</span>, <span class="number">174</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">56</span>, <span class="number">181</span>, <span class="number">212</span>, <span class="number">42</span>, <span class="number">188</span>, <span class="number">6</span>, <span class="number">117</span>, <span class="number">93</span>, <span class="number">178</span>, <span class="number">160</span>, <span class="number">129</span>, <span class="number">15</span>, <span class="number">76</span>, <span class="number">150</span>, <span class="number">207</span>, <span class="number">245</span>, <span class="number">227</span>, <span class="number">247</span>, <span class="number">130</span>, <span class="number">171</span>, <span class="number">114</span>, <span class="number">204</span>, <span class="number">101</span>, <span class="number">176</span>, <span class="number">55</span>, <span class="number">43</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">90</span>, <span class="number">124</span>, <span class="number">45</span>, <span class="number">96</span>, <span class="number">181</span>, <span class="number">221</span>, <span class="number">16</span>, <span class="number">121</span>, <span class="number">210</span>, <span class="number">51</span>, <span class="number">210</span>, <span class="number">164</span>, <span class="number">68</span>, <span class="number">64</span>, <span class="number">154</span>, <span class="number">167</span>, <span class="number">91</span>, <span class="number">69</span>, <span class="number">35</span>, <span class="number">153</span>, <span class="number">212</span>, <span class="number">10</span>, <span class="number">125</span>, <span class="number">235</span>, <span class="number">203</span>, <span class="number">166</span>, <span class="number">145</span>, <span class="number">9</span>, <span class="number">174</span>, <span class="number">86</span>, <span class="number">65</span>, <span class="number">70</span>, <span class="number">112</span>, <span class="number">194</span>, <span class="number">140</span>, <span class="number">92</span>, <span class="number">170</span>, <span class="number">49</span>, <span class="number">191</span>, <span class="number">157</span>, <span class="number">218</span>, <span class="number">199</span>, <span class="number">152</span>, <span class="number">151</span>, <span class="number">247</span>, <span class="number">208</span>, <span class="number">182</span>, <span class="number">209</span>, <span class="number">34</span>, <span class="number">245</span>, <span class="number">5</span>, <span class="number">173</span>, <span class="number">105</span>, <span class="number">175</span>, <span class="number">159</span>, <span class="number">71</span>, <span class="number">251</span>, <span class="number">198</span>, <span class="number">246</span>, <span class="number">214</span>, <span class="number">99</span>, <span class="number">58</span>, <span class="number">70</span>, <span class="number">154</span>, <span class="number">52</span>, <span class="number">39</span>, <span class="number">88</span>, <span class="number">149</span>, <span class="number">179</span>, <span class="number">202</span>, <span class="number">86</span>, <span class="number">240</span>, <span class="number">108</span>, <span class="number">200</span>, <span class="number">83</span>, <span class="number">250</span>, <span class="number">62</span>, <span class="number">213</span>, <span class="number">113</span>, <span class="number">138</span>, <span class="number">73</span>, <span class="number">106</span>, <span class="number">141</span>, <span class="number">192</span>, <span class="number">204</span>, <span class="number">90</span>, <span class="number">251</span>, <span class="number">208</span>, <span class="number">28</span>, <span class="number">124</span>, <span class="number">30</span>, <span class="number">134</span>, <span class="number">119</span>, <span class="number">144</span>, <span class="number">68</span>, <span class="number">23</span>, <span class="number">204</span>, <span class="number">181</span>, <span class="number">186</span>, <span class="number">76</span>, <span class="number">156</span>, <span class="number">71</span>, <span class="number">8</span>, <span class="number">104</span>, <span class="number">186</span>, <span class="number">87</span>, <span class="number">221</span>, <span class="number">134</span>, <span class="number">122</span>, <span class="number">72</span>, <span class="number">244</span>, <span class="number">203</span>, <span class="number">121</span>, <span class="number">181</span>, <span class="number">65</span>, <span class="number">90</span>, <span class="number">185</span>, <span class="number">131</span>, <span class="number">230</span>, <span class="number">133</span>, <span class="number">54</span>, <span class="number">158</span>, <span class="number">186</span>, <span class="number">168</span>, <span class="number">201</span>, <span class="number">178</span>, <span class="number">155</span>, <span class="number">172</span>, <span class="number">164</span>, <span class="number">22</span>, <span class="number">130</span>, <span class="number">111</span>, <span class="number">90</span>, <span class="number">209</span>, <span class="number">2</span>, <span class="number">167</span>, <span class="number">23</span>, <span class="number">176</span>, <span class="number">63</span>, <span class="number">139</span>, <span class="number">89</span>, <span class="number">63</span>, <span class="number">15</span>, <span class="number">238</span>, <span class="number">110</span>, <span class="number">204</span>, <span class="number">85</span>, <span class="number">36</span>, <span class="number">127</span>, <span class="number">68</span>, <span class="number">240</span>, <span class="number">177</span>, <span class="number">31</span>, <span class="number">2</span>, <span class="number">81</span>, <span class="number">147</span>, <span class="number">205</span>, <span class="number">192</span>, <span class="number">214</span>, <span class="number">173</span>, <span class="number">103</span>, <span class="number">130</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">232</span>, <span class="number">125</span>, <span class="number">216</span>, <span class="number">163</span>, <span class="number">209</span>, <span class="number">171</span>, <span class="number">168</span>, <span class="number">243</span>, <span class="number">145</span>, <span class="number">6</span>, <span class="number">170</span>, <span class="number">41</span>, <span class="number">142</span>, <span class="number">250</span>, <span class="number">145</span>, <span class="number">57</span>, <span class="number">139</span>, <span class="number">224</span>, <span class="number">221</span>, <span class="number">189</span>, <span class="number">48</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">92</span>, <span class="number">216</span>, <span class="number">154</span>, <span class="number">126</span>, <span class="number">223</span>, <span class="number">8</span>, <span class="number">90</span>, <span class="number">82</span>, <span class="number">138</span>, <span class="number">221</span>, <span class="number">240</span>, <span class="number">223</span>, <span class="number">87</span>, <span class="number">209</span>, <span class="number">165</span>, <span class="number">17</span>, <span class="number">52</span>, <span class="number">154</span>, <span class="number">91</span>, <span class="number">12</span>, <span class="number">121</span>, <span class="number">212</span>, <span class="number">238</span>, <span class="number">46</span>, <span class="number">215</span>, <span class="number">217</span>, <span class="number">147</span>, <span class="number">136</span>, <span class="number">139</span>, <span class="number">251</span>, <span class="number">91</span>, <span class="number">39</span>, <span class="number">188</span>, <span class="number">244</span>, <span class="number">251</span>, <span class="number">52</span>, <span class="number">110</span>, <span class="number">22</span>, <span class="number">126</span>, <span class="number">200</span>, <span class="number">231</span>, <span class="number">153</span>, <span class="number">103</span>, <span class="number">203</span>, <span class="number">120</span>, <span class="number">219</span>, <span class="number">118</span>, <span class="number">172</span>, <span class="number">53</span>, <span class="number">141</span>, <span class="number">203</span>, <span class="number">75</span>, <span class="number">163</span>, <span class="number">150</span>, <span class="number">194</span>, <span class="number">27</span>, <span class="number">208</span>, <span class="number">9</span>, <span class="number">186</span>, <span class="number">6</span>, <span class="number">85</span>, <span class="number">46</span>, <span class="number">243</span>, <span class="number">135</span>, <span class="number">66</span>, <span class="number">40</span>, <span class="number">79</span>, <span class="number">206</span>, <span class="number">250</span>, <span class="number">20</span>, <span class="number">85</span>, <span class="number">123</span>, <span class="number">35</span>, <span class="number">164</span>, <span class="number">44</span>, <span class="number">85</span>, <span class="number">104</span>, <span class="number">66</span>, <span class="number">51</span>, <span class="number">177</span>, <span class="number">125</span>, <span class="number">189</span>, <span class="number">165</span>, <span class="number">226</span>, <span class="number">13</span>, <span class="number">75</span>, <span class="number">78</span>, <span class="number">225</span>, <span class="number">252</span>, <span class="number">226</span>, <span class="number">138</span>, <span class="number">81</span>, <span class="number">171</span>, <span class="number">172</span>, <span class="number">175</span>, <span class="number">122</span>, <span class="number">145</span>, <span class="number">68</span>, <span class="number">254</span>, <span class="number">37</span>, <span class="number">153</span>, <span class="number">39</span>, <span class="number">113</span>, <span class="number">237</span>, <span class="number">232</span>, <span class="number">220</span>, <span class="number">80</span>, <span class="number">193</span>, <span class="number">181</span>, <span class="number">21</span>, <span class="number">197</span>, <span class="number">186</span>, <span class="number">56</span>, <span class="number">202</span>, <span class="number">239</span>, <span class="number">213</span>, <span class="number">135</span>, <span class="number">41</span>, <span class="number">6</span>, <span class="number">85</span>, <span class="number">54</span>, <span class="number">135</span>, <span class="number">214</span>, <span class="number">95</span>, <span class="number">102</span>, <span class="number">23</span>, <span class="number">192</span>, <span class="number">153</span>, <span class="number">235</span>, <span class="number">110</span>, <span class="number">26</span>, <span class="number">14</span>, <span class="number">84</span>, <span class="number">220</span>, <span class="number">142</span>, <span class="number">236</span>, <span class="number">192</span>, <span class="number">8</span>, <span class="number">117</span>, <span class="number">205</span>, <span class="number">249</span>, <span class="number">92</span>, <span class="number">148</span>, <span class="number">149</span>, <span class="number">77</span>, <span class="number">235</span>, <span class="number">205</span>, <span class="number">232</span>, <span class="number">21</span>, <span class="number">48</span>, <span class="number">14</span>, <span class="number">84</span>, <span class="number">187</span>, <span class="number">124</span>, <span class="number">218</span>, <span class="number">166</span>, <span class="number">155</span>, <span class="number">183</span>, <span class="number">62</span>, <span class="number">10</span>, <span class="number">123</span>, <span class="number">53</span>, <span class="number">63</span>, <span class="number">79</span>, <span class="number">101</span>, <span class="number">193</span>, <span class="number">3</span>, <span class="number">61</span>, <span class="number">29</span>, <span class="number">39</span>, <span class="number">99</span>, <span class="number">22</span>, <span class="number">197</span>, <span class="number">75</span>, <span class="number">10</span>, <span class="number">165</span>, <span class="number">44</span>, <span class="number">215</span>, <span class="number">210</span>, <span class="number">181</span>, <span class="number">74</span>, <span class="number">235</span>, <span class="number">200</span>, <span class="number">247</span>, <span class="number">158</span>, <span class="number">187</span>, <span class="number">200</span>, <span class="number">102</span>, <span class="number">22</span>, <span class="number">150</span>, <span class="number">73</span>, <span class="number">42</span>, <span class="number">131</span>, <span class="number">28</span>, <span class="number">17</span>, <span class="number">180</span>, <span class="number">133</span>, <span class="number">205</span>, <span class="number">23</span>, <span class="number">228</span>, <span class="number">226</span>, <span class="number">219</span>, <span class="number">175</span>, <span class="number">207</span>, <span class="number">81</span>, <span class="number">53</span>, <span class="number">141</span>, <span class="number">114</span>, <span class="number">140</span>, <span class="number">59</span>, <span class="number">218</span>, <span class="number">169</span>, <span class="number">7</span>, <span class="number">219</span>, <span class="number">139</span>, <span class="number">75</span>, <span class="number">210</span>, <span class="number">97</span>, <span class="number">236</span>, <span class="number">157</span>, <span class="number">21</span>, <span class="number">109</span>, <span class="number">195</span>, <span class="number">128</span>, <span class="number">54</span>, <span class="number">5</span>, <span class="number">55</span>, <span class="number">217</span>, <span class="number">127</span>, <span class="number">49</span>, <span class="number">62</span>, <span class="number">59</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">86</span>, <span class="number">255</span>, <span class="number">22</span>, <span class="number">186</span>, <span class="number">94</span>, <span class="number">151</span>, <span class="number">114</span>, <span class="number">93</span>, <span class="number">19</span>, <span class="number">198</span>, <span class="number">159</span>, <span class="number">174</span>, <span class="number">142</span>, <span class="number">132</span>, <span class="number">195</span>, <span class="number">157</span>, <span class="number">206</span>, <span class="number">161</span>, <span class="number">107</span>, <span class="number">255</span>, <span class="number">106</span>, <span class="number">196</span>, <span class="number">250</span>, <span class="number">191</span>, <span class="number">86</span>, <span class="number">221</span>, <span class="number">196</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">37</span>, <span class="number">50</span>, <span class="number">224</span>, <span class="number">42</span>, <span class="number">20</span>, <span class="number">89</span>, <span class="number">212</span>, <span class="number">252</span>, <span class="number">191</span>, <span class="number">157</span>, <span class="number">237</span>, <span class="number">10</span>, <span class="number">157</span>, <span class="number">80</span>, <span class="number">42</span>, <span class="number">234</span>, <span class="number">180</span>, <span class="number">1</span>, <span class="number">183</span>, <span class="number">186</span>, <span class="number">239</span>, <span class="number">129</span>, <span class="number">14</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">66</span>, <span class="number">203</span>, <span class="number">120</span>, <span class="number">114</span>, <span class="number">37</span>, <span class="number">214</span>, <span class="number">37</span>, <span class="number">73</span>, <span class="number">153</span>, <span class="number">182</span>, <span class="number">165</span>, <span class="number">87</span>, <span class="number">177</span>, <span class="number">75</span>, <span class="number">220</span>, <span class="number">210</span>, <span class="number">105</span>, <span class="number">154</span>, <span class="number">149</span>, <span class="number">114</span>, <span class="number">13</span>, <span class="number">202</span>, <span class="number">128</span>, <span class="number">55</span>, <span class="number">128</span>, <span class="number">96</span>, <span class="number">158</span>, <span class="number">150</span>, <span class="number">57</span>, <span class="number">86</span>, <span class="number">106</span>, <span class="number">127</span>, <span class="number">160</span>, <span class="number">57</span>, <span class="number">80</span>, <span class="number">255</span>, <span class="number">107</span>, <span class="number">241</span>, <span class="number">95</span>, <span class="number">121</span>, <span class="number">14</span>, <span class="number">110</span>, <span class="number">160</span>, <span class="number">119</span>, <span class="number">211</span>, <span class="number">150</span>, <span class="number">156</span>, <span class="number">185</span>, <span class="number">158</span>, <span class="number">221</span>, <span class="number">110</span>, <span class="number">76</span>, <span class="number">255</span>, <span class="number">119</span>, <span class="number">15</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">238</span>, <span class="number">139</span>, <span class="number">100</span>, <span class="number">250</span>, <span class="number">220</span>, <span class="number">147</span>, <span class="number">193</span>, <span class="number">51</span>, <span class="number">144</span>, <span class="number">123</span>, <span class="number">139</span>, <span class="number">13</span>, <span class="number">26</span>, <span class="number">158</span>, <span class="number">95</span>, <span class="number">148</span>, <span class="number">251</span>, <span class="number">82</span>, <span class="number">227</span>, <span class="number">119</span>, <span class="number">92</span>, <span class="number">132</span>, <span class="number">219</span>, <span class="number">248</span>, <span class="number">239</span>, <span class="number">217</span>, <span class="number">101</span>, <span class="number">88</span>, <span class="number">121</span>, <span class="number">10</span>, <span class="number">148</span>, <span class="number">203</span>, <span class="number">156</span>, <span class="number">156</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mt19937</span>(<span class="params">bs, out</span>):</span><br><span class="line"></span><br><span class="line">    lin = LinearSystem([<span class="number">32</span>] * <span class="number">624</span>)</span><br><span class="line">    mt = lin.gens()</span><br><span class="line"></span><br><span class="line">    rng = MT19937(mt)</span><br><span class="line">    rng.getrandbits(<span class="number">175</span>)</span><br><span class="line">    zeros = [rng.getrandbits(bs) ^ o <span class="keyword">for</span> o <span class="keyword">in</span> out] + [mt[<span class="number">0</span>] ^ <span class="number">0x80000000</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;solving...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    sol = lin.solve_one(zeros)</span><br><span class="line"></span><br><span class="line">    rng = MT19937(sol)</span><br><span class="line">    pyrand = rng.to_python_random()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;solved&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(pyrand.getrandbits(<span class="number">175</span>)^enc))</span><br><span class="line">test = <span class="built_in">bytes</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>, -<span class="number">1</span>, -<span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line">ans=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="built_in">len</span>(r)):</span><br><span class="line">    ans.append(<span class="number">255</span>-r[i])</span><br><span class="line">out=[]</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(ans)==<span class="number">624</span>*<span class="number">4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(ans[<span class="number">0</span>]))  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>*<span class="number">4</span>):</span><br><span class="line">    out.append(random.getrandbits(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(out[<span class="number">0</span>]))</span><br><span class="line">mt19937(<span class="number">8</span>,ans)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="复复复复数"><a href="#复复复复数" class="headerlink" title="*复复复复数"></a>*复复复复数</h3><h4 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ComComplex</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, value=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span>):</span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="built_in">str</span>(self.value[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> k,i <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.value[<span class="number">1</span>:]):</span><br><span class="line">            <span class="keyword">if</span> i &gt;= <span class="number">0</span>:</span><br><span class="line">                s += <span class="string">&#x27;+&#x27;</span></span><br><span class="line">            s += <span class="built_in">str</span>(i) +<span class="string">&#x27;ijk&#x27;</span>[k]</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="keyword">return</span> ComComplex([i+j <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(self.value,x.value)])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self,x</span>):</span><br><span class="line">        a = self.value[<span class="number">0</span>]*x.value[<span class="number">0</span>]-self.value[<span class="number">1</span>]*x.value[<span class="number">1</span>]-self.value[<span class="number">2</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">3</span>]*x.value[<span class="number">3</span>]</span><br><span class="line">        b = self.value[<span class="number">0</span>]*x.value[<span class="number">1</span>]+self.value[<span class="number">1</span>]*x.value[<span class="number">0</span>]+self.value[<span class="number">2</span>]*x.value[<span class="number">3</span>]-self.value[<span class="number">3</span>]*x.value[<span class="number">2</span>]</span><br><span class="line">        c = self.value[<span class="number">0</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">1</span>]*x.value[<span class="number">3</span>]+self.value[<span class="number">2</span>]*x.value[<span class="number">0</span>]+self.value[<span class="number">3</span>]*x.value[<span class="number">1</span>]</span><br><span class="line">        d = self.value[<span class="number">0</span>]*x.value[<span class="number">3</span>]+self.value[<span class="number">1</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">2</span>]*x.value[<span class="number">1</span>]+self.value[<span class="number">3</span>]*x.value[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> ComComplex([a,b,c,d])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mod__</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="keyword">return</span> ComComplex([i % x <span class="keyword">for</span> i <span class="keyword">in</span> self.value])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__pow__</span>(<span class="params">self, x, n=<span class="literal">None</span></span>):</span><br><span class="line">        tmp = ComComplex(self.value)</span><br><span class="line">        a = ComComplex([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">while</span> x:</span><br><span class="line">            <span class="keyword">if</span> x &amp; <span class="number">1</span>:</span><br><span class="line">                a *= tmp</span><br><span class="line">            tmp *= tmp</span><br><span class="line">            <span class="keyword">if</span> n:</span><br><span class="line">                a %= n</span><br><span class="line">                tmp %= n</span><br><span class="line">            x &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, hint</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">r = getPrime(<span class="number">256</span>)</span><br><span class="line">n = p * q * r</span><br><span class="line"></span><br><span class="line">P = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(hint) == <span class="number">20</span></span><br><span class="line">hints = ComComplex([bytes_to_long(hint[i:i+<span class="number">5</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">20</span>,<span class="number">5</span>)])</span><br><span class="line">keys = ComComplex([<span class="number">0</span>, p, q, r])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint =&#x27;</span>,hints)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;gift =&#x27;</span>,hints*keys%P)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;P =&#x27;</span>,P)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65547</span></span><br><span class="line">m = ComComplex([bytes_to_long(flag[i:i+<span class="built_in">len</span>(flag)//<span class="number">4</span>+<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="built_in">len</span>(flag)//<span class="number">4</span>+<span class="number">1</span>)])</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">hint = 375413371936+452903063925i+418564633198j+452841062207k</span></span><br><span class="line"><span class="string">gift = 8123312244520119413231609191866976836916616973013918670932199631084038015924368317077919454611785179950870055560079987034735836668109705445946887481003729+20508867471664499348708768798854433383217801696267611753941328714877299161068885700412171i+22802458968832151777449744120185122420871929971817937643641589637402679927558503881707868j+40224499597522456323122179021760594618350780974297095023316834212332206526399536884102863k</span></span><br><span class="line"><span class="string">P = 8123312244520119413231609191866976836916616973013918670932199631182724263362174895104545305364960781233690810077210539091362134310623408173268475389315109</span></span><br><span class="line"><span class="string">n = 408713495380933615345467409596399184629824932933932227692519320046890365817329617301604051766392980053993030281090124694858194866782889226223493799859404283664530068697313752856923001112586828837146686963124061670340088332769524367</span></span><br><span class="line"><span class="string">c = 212391106108596254648968182832931369624606731443797421732310126161911908195602305474921714075911012622738456373731638115041135121458776339519085497285769160263024788009541257401354037620169924991531279387552806754098200127027800103+24398526281840329222660628769015610312084745844610670698920371305353888694519135578269023873988641161449924124665731242993290561874625654977013162008430854786349580090169988458393820787665342793716311005178101342140536536153873825i+45426319565874516841189981758358042952736832934179778483602503215353130229731883231784466068253520728052302138781204883495827539943655851877172681021818282251414044916889460602783324944030929987991059211909160860125047647337380125j+96704582331728201332157222706704482771142627223521415975953255983058954606417974983056516338287792260492498273014507582247155218239742778886055575426154960475637748339582574453542182586573424942835640846567809581805953259331957385k</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>首先根据 hints 和 gifts 通过解<strong>线性同余方程组</strong>可以将 $p,q,r$ 解出来</p>
<p>然后根据 $\phi(p)$ 是指比 $p$ 小且与 $p$ 互素的个数 ，因此 $\phi(p)=p^4-1$,就是去掉了 0</p>
<p>所以 $\phi(n)=(p^4-1)<em>(q^4-1)</em>(r^4-1)$</p>
<p>但是 $e$ 和 $\phi$ <strong>不互素</strong></p>
<p>这里唐的一点是如果不把 $p$ 转成 $int$ 类型去算 $\phi(p)$ 的话会发现是错的，我当时就是计算</p>
<script type="math/tex; mode=display">d_p \equiv e^{-1} \mod \phi(p)</script><script type="math/tex; mode=display">m_1=c^{d_p} \mod p</script><p>想得到正确结果，结果半天发现不了哪里错了😂</p>
<p>最后复现发现了这个问题，然后在 $GF(p)$ 开两次三次根即可</p>
<h4 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ComComplex</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, value=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span>):</span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="built_in">str</span>(self.value[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> k,i <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.value[<span class="number">1</span>:]):</span><br><span class="line">            <span class="keyword">if</span> i &gt;= <span class="number">0</span>:</span><br><span class="line">                s += <span class="string">&#x27;+&#x27;</span></span><br><span class="line">            s += <span class="built_in">str</span>(i) +<span class="string">&#x27;ijk&#x27;</span>[k]</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="keyword">return</span> ComComplex([i+j <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(self.value,x.value)])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self,x</span>):</span><br><span class="line">        a = self.value[<span class="number">0</span>]*x.value[<span class="number">0</span>]-self.value[<span class="number">1</span>]*x.value[<span class="number">1</span>]-self.value[<span class="number">2</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">3</span>]*x.value[<span class="number">3</span>]</span><br><span class="line">        b = self.value[<span class="number">0</span>]*x.value[<span class="number">1</span>]+self.value[<span class="number">1</span>]*x.value[<span class="number">0</span>]+self.value[<span class="number">2</span>]*x.value[<span class="number">3</span>]-self.value[<span class="number">3</span>]*x.value[<span class="number">2</span>]</span><br><span class="line">        c = self.value[<span class="number">0</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">1</span>]*x.value[<span class="number">3</span>]+self.value[<span class="number">2</span>]*x.value[<span class="number">0</span>]+self.value[<span class="number">3</span>]*x.value[<span class="number">1</span>]</span><br><span class="line">        d = self.value[<span class="number">0</span>]*x.value[<span class="number">3</span>]+self.value[<span class="number">1</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">2</span>]*x.value[<span class="number">1</span>]+self.value[<span class="number">3</span>]*x.value[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> ComComplex([a,b,c,d])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mod__</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="keyword">return</span> ComComplex([i % x <span class="keyword">for</span> i <span class="keyword">in</span> self.value])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__pow__</span>(<span class="params">self, x, n=<span class="literal">None</span></span>):</span><br><span class="line">        tmp = ComComplex(self.value)</span><br><span class="line">        a = ComComplex([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">while</span> x:</span><br><span class="line">            <span class="keyword">if</span> x &amp; <span class="number">1</span>:</span><br><span class="line">                a *= tmp</span><br><span class="line">            tmp *= tmp</span><br><span class="line">            <span class="keyword">if</span> n:</span><br><span class="line">                a %= n</span><br><span class="line">                tmp %= n</span><br><span class="line">            x &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_root3</span>(<span class="params">p, Q</span>):</span><br><span class="line">    F = GF(p)  <span class="comment"># 定义有限域GF(p)</span></span><br><span class="line">    Q = (F(Q[<span class="number">0</span>]), F(Q[<span class="number">1</span>]), F(Q[<span class="number">2</span>]), F(Q[<span class="number">3</span>]))  <span class="comment"># 将四元数转换为GF(p)中的元素</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">quaternion_mult</span>(<span class="params">q1, q2</span>):</span><br><span class="line">        a1, b1, c1, d1 = q1</span><br><span class="line">        a2, b2, c2, d2 = q2</span><br><span class="line">        scalar = a1*a2 - b1*b2 - c1*c2 - d1*d2</span><br><span class="line">        i = a1*b2 + b1*a2 + c1*d2 - d1*c2</span><br><span class="line">        j = a1*c2 - b1*d2 + c1*a2 + d1*b2</span><br><span class="line">        k = a1*d2 + b1*c2 - c1*b2 + d1*a2</span><br><span class="line">        <span class="keyword">return</span> (scalar, i, j, k)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">quaternion_pow</span>(<span class="params">q, n</span>):</span><br><span class="line">        result = (F(<span class="number">1</span>), F(<span class="number">0</span>), F(<span class="number">0</span>), F(<span class="number">0</span>))</span><br><span class="line">        <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                result = quaternion_mult(result, q)</span><br><span class="line">            q = quaternion_mult(q, q)</span><br><span class="line">            n = n // <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取目标四元数的标量部分和向量部分</span></span><br><span class="line">    W, X, Y, Z = Q</span><br><span class="line">    S = W</span><br><span class="line">    V = (X, Y, Z)</span><br><span class="line">    N_V = (X**<span class="number">2</span> + Y**<span class="number">2</span> + Z**<span class="number">2</span>)  <span class="comment"># 向量部分的范数</span></span><br><span class="line">    N_Q = (W**<span class="number">2</span> + N_V)        <span class="comment"># 目标四元数的总范数</span></span><br><span class="line"></span><br><span class="line">    solutions = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 1: 检查 N_Q 是否为三次剩余</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cube_roots_NQ = N_Q.nth_root(<span class="number">3</span>, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        cube_roots_NQ = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> cube_roots_NQ:</span><br><span class="line">        <span class="comment"># Step 2: 解三次方程 4*N_V*k**3 -3*n*k +1 = 0</span></span><br><span class="line">        <span class="keyword">if</span> N_V == <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># 处理纯标量情况</span></span><br><span class="line">            <span class="keyword">if</span> X == <span class="number">0</span> <span class="keyword">and</span> Y == <span class="number">0</span> <span class="keyword">and</span> Z == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    s_roots = S.nth_root(<span class="number">3</span>, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">                    solutions.extend( (s, F(<span class="number">0</span>), F(<span class="number">0</span>), F(<span class="number">0</span>)) <span class="keyword">for</span> s <span class="keyword">in</span> s_roots )</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># R.&lt;k&gt; = PolynomialRing(F)</span></span><br><span class="line">        R = PolynomialRing(F, <span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">        k = R.gen()</span><br><span class="line">        eq = <span class="number">4</span>*N_V * k**<span class="number">3</span> - <span class="number">3</span>*n * k + <span class="number">1</span></span><br><span class="line">        k_candidates = eq.roots(multiplicities=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> k_candidates:</span><br><span class="line">            <span class="comment"># Step 3: 计算 s² = n - k²*N_V</span></span><br><span class="line">            s_sq = n - k**<span class="number">2</span> * N_V</span><br><span class="line">            <span class="keyword">if</span> s_sq == <span class="number">0</span>:</span><br><span class="line">                s_candidates = [F(<span class="number">0</span>)]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> s_sq.is_square():</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                s_candidates = s_sq.sqrt(<span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> s <span class="keyword">in</span> s_candidates:</span><br><span class="line">                <span class="comment"># Step 4: 验证标量方程 s*(n -4k²*N_V) ≡ S mod p</span></span><br><span class="line">                lhs = s * (n - <span class="number">4</span>*k**<span class="number">2</span>*N_V)</span><br><span class="line">                <span class="keyword">if</span> lhs == S:</span><br><span class="line">                    q = (s, k*X, k*Y, k*Z)</span><br><span class="line">                    <span class="comment"># 验证 q**3 是否等于 Q（避免计算误差）</span></span><br><span class="line">                    <span class="keyword">if</span> quaternion_pow(q, <span class="number">3</span>) == Q:</span><br><span class="line">                        solutions.append(q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 去重并输出</span></span><br><span class="line">    solutions = <span class="built_in">list</span>(<span class="built_in">set</span>(solutions))</span><br><span class="line">    <span class="comment"># print(f&quot;解为：&#123;solutions&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">return</span> solutions</span><br><span class="line"></span><br><span class="line">hint = [<span class="number">375413371936</span>,<span class="number">452903063925</span>,<span class="number">418564633198</span>,<span class="number">452841062207</span>]</span><br><span class="line">gift = [<span class="number">8123312244520119413231609191866976836916616973013918670932199631084038015924368317077919454611785179950870055560079987034735836668109705445946887481003729</span>,<span class="number">20508867471664499348708768798854433383217801696267611753941328714877299161068885700412171</span>,<span class="number">22802458968832151777449744120185122420871929971817937643641589637402679927558503881707868</span>,<span class="number">40224499597522456323122179021760594618350780974297095023316834212332206526399536884102863</span>]</span><br><span class="line">P = <span class="number">8123312244520119413231609191866976836916616973013918670932199631182724263362174895104545305364960781233690810077210539091362134310623408173268475389315109</span></span><br><span class="line">n = <span class="number">408713495380933615345467409596399184629824932933932227692519320046890365817329617301604051766392980053993030281090124694858194866782889226223493799859404283664530068697313752856923001112586828837146686963124061670340088332769524367</span></span><br><span class="line">c = ComComplex([<span class="number">212391106108596254648968182832931369624606731443797421732310126161911908195602305474921714075911012622738456373731638115041135121458776339519085497285769160263024788009541257401354037620169924991531279387552806754098200127027800103</span>,<span class="number">24398526281840329222660628769015610312084745844610670698920371305353888694519135578269023873988641161449924124665731242993290561874625654977013162008430854786349580090169988458393820787665342793716311005178101342140536536153873825</span>,<span class="number">45426319565874516841189981758358042952736832934179778483602503215353130229731883231784466068253520728052302138781204883495827539943655851877172681021818282251414044916889460602783324944030929987991059211909160860125047647337380125</span>,<span class="number">96704582331728201332157222706704482771142627223521415975953255983058954606417974983056516338287792260492498273014507582247155218239742778886055575426154960475637748339582574453542182586573424942835640846567809581805953259331957385</span>])</span><br><span class="line">A=Matrix(Zmod(P),[[hint[<span class="number">0</span>],-hint[<span class="number">1</span>],-hint[<span class="number">2</span>],-hint[<span class="number">3</span>]],[hint[<span class="number">1</span>],hint[<span class="number">0</span>],-hint[<span class="number">3</span>],hint[<span class="number">2</span>]],[hint[<span class="number">2</span>],hint[<span class="number">3</span>],hint[<span class="number">0</span>],-hint[<span class="number">1</span>]],[hint[<span class="number">3</span>],-hint[<span class="number">2</span>],hint[<span class="number">1</span>],hint[<span class="number">0</span>]]])</span><br><span class="line">b=vector(Zmod(P),[gift[<span class="number">0</span>],gift[<span class="number">1</span>],gift[<span class="number">2</span>],gift[<span class="number">3</span>]])</span><br><span class="line">solution = A.solve_right(b)</span><br><span class="line">_,p,q,r=solution</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> p*q*r==n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p=<span class="built_in">int</span>(p)</span><br><span class="line">q=<span class="built_in">int</span>(q)</span><br><span class="line">r=<span class="built_in">int</span>(r)    </span><br><span class="line"></span><br><span class="line">phi=(p**<span class="number">4</span>-<span class="number">1</span>)*(q**<span class="number">4</span>-<span class="number">1</span>)*(r**<span class="number">4</span>-<span class="number">1</span>)</span><br><span class="line"><span class="comment">#print(int(p))</span></span><br><span class="line"><span class="comment">#p=63173373914948586508761871207488662566773264479285518327131522282352053209317</span></span><br><span class="line"><span class="built_in">print</span>(isPrime(<span class="built_in">int</span>(p)))</span><br><span class="line">e=<span class="built_in">int</span>(<span class="number">65547</span>)</span><br><span class="line"><span class="built_in">print</span>(math.gcd(e,p**<span class="number">4</span>-<span class="number">1</span>))   </span><br><span class="line">dp = <span class="built_in">int</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(e//<span class="number">9</span>), -<span class="number">1</span>, <span class="built_in">int</span>(p**<span class="number">4</span>-<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">mp=<span class="built_in">pow</span>(c,dp,<span class="built_in">int</span>(p))</span><br><span class="line"><span class="built_in">print</span>(mp)</span><br><span class="line"></span><br><span class="line">m3 = get_root3(p, [mp.value[<span class="number">0</span>], mp.value[<span class="number">1</span>], mp.value[<span class="number">2</span>], mp.value[<span class="number">3</span>]])</span><br><span class="line"><span class="built_in">print</span>(m3)</span><br><span class="line"><span class="keyword">for</span> mm3 <span class="keyword">in</span> m3:</span><br><span class="line">    m=get_root3(p,mm3)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        flag=<span class="string">b&#x27;&#x27;</span>.join(long_to_bytes(<span class="built_in">int</span>(j))<span class="keyword">for</span> j <span class="keyword">in</span> i)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="prng-xxxx"><a href="#prng-xxxx" class="headerlink" title="*prng_xxxx"></a>*prng_xxxx</h3><h4 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, b, seed</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, a, b</span>):</span><br><span class="line">        self.seed = seed</span><br><span class="line">        self.a = a</span><br><span class="line">        self.b = b</span><br><span class="line">        self.m = <span class="number">2</span>**<span class="number">128</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.seed * self.a + self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> (self.seed &gt;&gt; <span class="number">64</span>) ^ (self.seed % <span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lfsr</span>:</span><br><span class="line">    <span class="comment"># 我被裁了/(ㄒoㄒ)/~~</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">47026247687942121848144207491837523525</span></span><br><span class="line"><span class="keyword">assert</span> b &lt; <span class="number">2</span>**<span class="number">128</span> <span class="keyword">and</span> seed &lt; <span class="number">2</span>**<span class="number">128</span></span><br><span class="line">lcg = LCG(seed, a, b)</span><br><span class="line"><span class="built_in">print</span>([lcg.<span class="built_in">next</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> [<span class="number">0</span>] * <span class="number">64</span>])</span><br><span class="line"><span class="built_in">print</span>(AES.new(key=md5(<span class="built_in">str</span>(seed).encode()).digest(), mode=AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>)))</span><br><span class="line"><span class="comment"># [17861431650111939539, 15632044669542972472, 18085804805519111109, 11630394250634164303, 10914687109985225138, 7348450425255618214, 10796029302647050328, 14267824433700366397, 9363967587530173835, 8995382728269798714, 3504283765121786984, 1312349325731613524, 10716889342831891752, 12298317818779713512, 8701992888199838445, 7261196699430834071, 4670657923849978944, 9833942603152121381, 18304734854303383637, 15945503654626665549, 6509330987395005461, 223169047706410182, 12990946817252956584, 3884858487227858459, 6366350447244638553, 10326924732676590049, 12989931141522347344, 9197940263960765675, 2481604167192102429, 1409946688030505107, 9263229900540161832, 266892958530212020, 14298569012977896930, 17318088100106133211, 4224045753426648494, 650161332435727275, 9488449142549049042, 8916910451165068139, 10116136382602356010, 6604992256480748513, 7375827593997920567, 1661095751967623288, 4143230452547340203, 4145435984742575053, 10465207027576409947, 16146447204594626029, 2807803679403346199, 10857432394281592897, 1494771564147200381, 2085795265418108023, 11756240132299985418, 13802520243518071455, 1191829597542202169, 16603089856395516862, 12517247819572559598, 14148806699104849454, 8174845389550768121, 15565523852832475714, 10046639095828632930, 15353735627107824646, 7003433641698461961, 11217699328913391211, 6392630836483027655, 7918524192972397836]</span></span><br><span class="line"><span class="comment"># b&#x27;l\x8bd,\xa3\xe7\x87*\xca\n\xd7\x11\xd6n=\xeaS`\xa4w\x94(\xb9\xf9\xb9\xc6\xe3\xc2\xfb\xdb\x80\xf6\x9f\xc7\xd1F&quot;`&#123;;V\xa7&#125;Z\xc0\xc0\xf6&lt;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>这题似乎是个 <strong>paper</strong> ,我是跟着一个 <strong><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/80834/attacks-on-lcg-with-self-xor-output-function">Q&amp;A</a></strong> 的思路复现的</p>
<p><strong>整体思路</strong>如下</p>
<h5 id="问题引入"><a href="#问题引入" class="headerlink" title="问题引入"></a>问题引入</h5><p>由递推式 $X_{i+1}=a*X_i+b \pmod{2^{128}}$ </p>
<p>可以写出<strong>通项公式</strong></p>
<script type="math/tex; mode=display">X_i=a^i*X_0+b*\sum_{k=0}^{i-1} a^k \pmod{2^{128}}</script><p>然后随机化的结果是将 128 位 state 的高 64 位和低 64 位进行异或得到 64 位的随机输出</p>
<p>求解：</p>
<h5 id="找到-omega"><a href="#找到-omega" class="headerlink" title="找到 $\omega$"></a>找到 $\omega$</h5><p>首先可以找到 m <strong>数据量</strong>的一个向量 $\omega$ ,满足 $|\omega|&lt;W$ </p>
<script type="math/tex; mode=display">\sum_{i=1}^{m} \omega_i a^{i} \equiv 0 \pmod {2^{\frac {n}{2}+k}}</script><p>其中 $W$ 是一个<strong>界</strong>，为后面的<strong>判断</strong>提供帮助的，所以在能找到 $\omega$ 的情况下，$W$ 越小越好</p>
<p>我们可以构造一个这样的格并使用 <strong>BKZ</strong> 去求解 $\omega$ </p>
<script type="math/tex; mode=display">
\left [
\begin{matrix}
1&0&0&\cdots&0&K*a\\
0&1&0&\cdots&0&K*a^{2}\\
0&0&1&\cdots&0&K*a^{3}\\
\vdots&\vdots&\vdots&\ddots&\vdots&\vdots\\
0&0&0&\cdots&1&K*a^{m}\\
0&0&0&\cdots&0&K*2^{\frac{n}{2}+k}\\
\end{matrix}
\right ]</script><p>格是 $m+1$ 维的， $K$ 是一个足够大的数，也就是<strong>配平因子</strong>，$k$ 是后面要猜测的 bit 数</p>
<p>$\omega$ 存在的大概的界是 $m\log_2(W) \approx \frac{n}{2}+k$</p>
<h5 id="猜测-k-位"><a href="#猜测-k-位" class="headerlink" title="猜测 $k$ 位"></a>猜测 $k$ 位</h5><p>得到 $\omega$ 后可以猜测 $X_0$ 的低位，因为 $b$ 也未知，所以要同时猜测 $b$ 的低位</p>
<p>猜测的 $k bit$ 的选取也有讲究,将<strong>在后面进行讲解</strong></p>
<p>我们现在可以假设同时已知 $X_0$ 和 $b$ 的低 $k$ 位</p>
<script type="math/tex; mode=display">\because X_{i+1}=a*X_i+b \pmod{2^{128}}</script><script type="math/tex; mode=display">\therefore X_{i+1_h}*2^{64}+X_{i+1_l}= a*(X_{i_h}*2^{64}+X_{i_l})+b \pmod{2^{128}}</script><script type="math/tex; mode=display">\therefore X_{i+1_l}=a*X_{i_l}+b_l \pmod{2^{64}}</script><p>所以 $X$ 的低位也满足<strong>递增关系</strong>，于是我们可以得到所有 $X_i$ 的低 $k$ 位</p>
<p>根据输出的随机数进行<strong>按位异或</strong>就可以得到对应的<strong>高位</strong> </p>
<p>然后乘 $2^{\frac{n}{2}}$ 得到 $X_i^*$</p>
<h5 id="判断条件"><a href="#判断条件" class="headerlink" title="判断条件"></a>判断条件</h5><p>经过<strong>数学推导</strong>可以得到一个式子（可以自己推一下）</p>
<script type="math/tex; mode=display">\sum_{i=1}^m{\omega_i[X_{i+1}-X_i]} \equiv 0 \pmod{2^{\frac{n}{2}+k}}</script><p>我们得到 $X_{i}^*$ 后可以计算</p>
<script type="math/tex; mode=display">Z = \sum_{i=1}^m{\omega_i[X_{i+1}^*-X_{i}^*]} \equiv 0 \pmod{2^{\frac{n}{2}+k}}</script><p>选取 $\Delta = min(Z,abs(2^{\frac{n}{2}+k}-Z))$</p>
<p>$\Delta$ 越小，说明 $X_{i}^<em>$ 与 $X_i$ 越<em>*相近</em></em>，猜测的结果越好</p>
<p>这里有一个<strong>范围</strong></p>
<p>如果 $\Delta \geq 2mW<em>2^{\frac{n}{2}}$ 则猜测是<em>*完全不可能正确</em></em>的</p>
<p>否则，我们会有 $1-2mW<em>2^{-k}$ 的<em>*概率</em></em>猜对</p>
<p>根据上述范围，进行初次猜测，假如我选的 $m$ 为 32 ,初次 $W=2$ ，则猜对的概率是 $1-\frac{128}{2^k}$ ，因此选取 $k=8$ 或 $9$ 比较合适，我这里选的 $9$ ,概率大一点</p>
<h5 id="不断重复以及优化技巧"><a href="#不断重复以及优化技巧" class="headerlink" title="不断重复以及优化技巧"></a>不断重复以及优化技巧</h5><p>后面有点类似于<strong>剪枝</strong>，就是猜测出 $k$ 位后，用 $k$ 位的可能结果一直往后猜，直至猜出所有的 bit</p>
<p>这里我遇到了一个问题，就是可能的<strong>结果太多</strong></p>
<p><strong>未央</strong> 让我仔细看了看原文，说有一个<strong>滑动窗口</strong>的操作，意思是多用几组 $Y_i$ 进行条件判断( $Y_i$ 就是<strong>随机数输出</strong> )</p>
<p>加上<strong>几轮滑动窗口进行调试</strong>后，可能的结果就大大减少了（几乎每一轮都是 16 个)</p>
<p>最后不断重复就 OK 了</p>
<p>整个流程 1h 左右吧</p>
<p>(每一轮调出来的<strong>参数</strong>都放在 exp 里了)</p>
<h4 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line">ou=[<span class="number">17861431650111939539</span>, <span class="number">15632044669542972472</span>, <span class="number">18085804805519111109</span>, <span class="number">11630394250634164303</span>, <span class="number">10914687109985225138</span>, <span class="number">7348450425255618214</span>, <span class="number">10796029302647050328</span>, <span class="number">14267824433700366397</span>, <span class="number">9363967587530173835</span>, <span class="number">8995382728269798714</span>, <span class="number">3504283765121786984</span>, <span class="number">1312349325731613524</span>, <span class="number">10716889342831891752</span>, <span class="number">12298317818779713512</span>, <span class="number">8701992888199838445</span>, <span class="number">7261196699430834071</span>, <span class="number">4670657923849978944</span>, <span class="number">9833942603152121381</span>, <span class="number">18304734854303383637</span>, <span class="number">15945503654626665549</span>, <span class="number">6509330987395005461</span>, <span class="number">223169047706410182</span>, <span class="number">12990946817252956584</span>, <span class="number">3884858487227858459</span>, <span class="number">6366350447244638553</span>, <span class="number">10326924732676590049</span>, <span class="number">12989931141522347344</span>, <span class="number">9197940263960765675</span>, <span class="number">2481604167192102429</span>, <span class="number">1409946688030505107</span>, <span class="number">9263229900540161832</span>, <span class="number">266892958530212020</span>, <span class="number">14298569012977896930</span>, <span class="number">17318088100106133211</span>, <span class="number">4224045753426648494</span>, <span class="number">650161332435727275</span>, <span class="number">9488449142549049042</span>, <span class="number">8916910451165068139</span>, <span class="number">10116136382602356010</span>, <span class="number">6604992256480748513</span>, <span class="number">7375827593997920567</span>, <span class="number">1661095751967623288</span>, <span class="number">4143230452547340203</span>, <span class="number">4145435984742575053</span>, <span class="number">10465207027576409947</span>, <span class="number">16146447204594626029</span>, <span class="number">2807803679403346199</span>, <span class="number">10857432394281592897</span>, <span class="number">1494771564147200381</span>, <span class="number">2085795265418108023</span>, <span class="number">11756240132299985418</span>, <span class="number">13802520243518071455</span>, <span class="number">1191829597542202169</span>, <span class="number">16603089856395516862</span>, <span class="number">12517247819572559598</span>, <span class="number">14148806699104849454</span>, <span class="number">8174845389550768121</span>, <span class="number">15565523852832475714</span>, <span class="number">10046639095828632930</span>, <span class="number">15353735627107824646</span>, <span class="number">7003433641698461961</span>, <span class="number">11217699328913391211</span>, <span class="number">6392630836483027655</span>, <span class="number">7918524192972397836</span>]</span><br><span class="line">enc=<span class="string">b&#x27;l\x8bd,\xa3\xe7\x87*\xca\n\xd7\x11\xd6n=\xeaS`\xa4w\x94(\xb9\xf9\xb9\xc6\xe3\xc2\xfb\xdb\x80\xf6\x9f\xc7\xd1F&quot;`&#123;;V\xa7&#125;Z\xc0\xc0\xf6&lt;&#x27;</span></span><br><span class="line">a = <span class="number">47026247687942121848144207491837523525</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(ou))</span><br><span class="line"></span><br><span class="line">k=<span class="number">18</span></span><br><span class="line">m=<span class="number">32</span></span><br><span class="line">n=<span class="number">128</span></span><br><span class="line"></span><br><span class="line">K=<span class="number">2</span>**<span class="number">20</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_w</span>(<span class="params">k,m,WW</span>):</span><br><span class="line">    mod=<span class="number">2</span>**(<span class="number">64</span>+k)</span><br><span class="line">    M=Matrix(ZZ,m+<span class="number">1</span>,m+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        M[i,i]=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        M[i,-<span class="number">1</span>]=K*a**(i+<span class="number">1</span>) </span><br><span class="line">    M[-<span class="number">1</span>,-<span class="number">1</span>]=K*mod</span><br><span class="line">    W=M.BKZ()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> W:</span><br><span class="line">        w = w[:-<span class="number">1</span>]</span><br><span class="line">        lhs = <span class="built_in">sum</span>([w[i]*a**(i+<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]) % <span class="number">2</span>**(n//<span class="number">2</span>+k)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">max</span>(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">abs</span>, w))) == WW <span class="keyword">and</span> lhs == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;w found&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> w</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>    </span><br><span class="line"></span><br><span class="line"><span class="comment">#多线程尝试，但不会写公用的存东西的</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">def print_progress_bar(iteration, total, prefix=&#x27;&#x27;, length=40, fill=&#x27;█&#x27;):</span></span><br><span class="line"><span class="string">    percent = (&quot;&#123;0:.1f&#125;&quot;).format(100 * (iteration / float(total)))</span></span><br><span class="line"><span class="string">    filled_length = int(length * iteration // total)</span></span><br><span class="line"><span class="string">    bar = fill * filled_length + &#x27;-&#x27; * (length - filled_length)</span></span><br><span class="line"><span class="string">    sys.stdout.write(f&#x27;\r&#123;prefix&#125; |&#123;bar&#125;| &#123;percent&#125;% Complete&#x27;)</span></span><br><span class="line"><span class="string">    sys.stdout.flush()</span></span><br><span class="line"><span class="string">def task(x):</span></span><br><span class="line"><span class="string">    print_progress_bar(x + 1, 512, prefix=&#x27;Progress&#x27;, length=40)</span></span><br><span class="line"><span class="string">    for b in range(2**k):</span></span><br><span class="line"><span class="string">        ans=0</span></span><br><span class="line"><span class="string">        out_h=[]</span></span><br><span class="line"><span class="string">        for i in range(64):</span></span><br><span class="line"><span class="string">            temp=x</span></span><br><span class="line"><span class="string">            x=((a*x+b)%(2**k))^(ou[i]%(2**k))</span></span><br><span class="line"><span class="string">            out_h.append(x*2**64+temp)</span></span><br><span class="line"><span class="string">        cnt=0</span></span><br><span class="line"><span class="string">        for t in range(10):</span></span><br><span class="line"><span class="string">            for i in range(63):</span></span><br><span class="line"><span class="string">                ans+=w[i]*(out_h[i+1]-out_h[i])*a**t</span></span><br><span class="line"><span class="string">                ans=ans%mod</span></span><br><span class="line"><span class="string">            delta=min(ans,mod-ans)</span></span><br><span class="line"><span class="string">            if delta&gt;=2*m*W*2**(n//2):</span></span><br><span class="line"><span class="string">                pass</span></span><br><span class="line"><span class="string">            else:</span></span><br><span class="line"><span class="string">                cnt+=1</span></span><br><span class="line"><span class="string">        if cnt==10:</span></span><br><span class="line"><span class="string">            o.append((x,b))  </span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">pool = multiprocessing.Pool(processes=16)  # 设置最多4个进程并行</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    # 使用map方法并行化循环任务</span></span><br><span class="line"><span class="string">pool.map(task, range(2**k))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    # 关闭进程池，等待所有进程完成</span></span><br><span class="line"><span class="string">pool.close()</span></span><br><span class="line"><span class="string">pool.join()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(&quot;All tasks are finished.&quot;)  </span></span><br><span class="line"><span class="string">print(o)       </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>   </span><br><span class="line"><span class="comment">#第一次尝试</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">now=None</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for windows in trange(16):</span></span><br><span class="line"><span class="string">    o=[]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    for x in range(2**k):</span></span><br><span class="line"><span class="string">        for b in range(2**k):</span></span><br><span class="line"><span class="string">            ans=0</span></span><br><span class="line"><span class="string">            out_h1=[x]</span></span><br><span class="line"><span class="string">            for i in range(64):</span></span><br><span class="line"><span class="string">                out_h1.append(((a*out_h1[-1]+b)%(2**k)))</span></span><br><span class="line"><span class="string">            out_h2 = [((ou[i] ^ out_h1[i]) % 2**k)*2**(n//2) for i in range(64)]    </span></span><br><span class="line"><span class="string">            ans=sum(w[i-windows]*(out_h2[i+1]-out_h2[i])for i in range(windows,windows+m)) %mod</span></span><br><span class="line"><span class="string">            delta=min(ans,abs(mod-ans))</span></span><br><span class="line"><span class="string">            if int(delta)&lt;2*m*WW*2**64:</span></span><br><span class="line"><span class="string">                o.append((x,b))</span></span><br><span class="line"><span class="string">    if now is None:</span></span><br><span class="line"><span class="string">        now=set(o)</span></span><br><span class="line"><span class="string">    else :</span></span><br><span class="line"><span class="string">        now=now&amp;set(o)</span></span><br><span class="line"><span class="string">    print(len(now))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(now)   </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess</span>(<span class="params">tt,out,w,WW,step,win</span>):</span><br><span class="line">    </span><br><span class="line">    mod=<span class="number">2</span>**(n//<span class="number">2</span>+tt)</span><br><span class="line">    all_now=[]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> out:</span><br><span class="line">        now1=<span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> windows <span class="keyword">in</span> trange(win):</span><br><span class="line">            oo=[]</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**step):</span><br><span class="line">                <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**step):</span><br><span class="line">                    x=j[<span class="number">0</span>]+t*<span class="number">2</span>**(tt-step)</span><br><span class="line">                    b=j[<span class="number">1</span>]+s*<span class="number">2</span>**(tt-step)</span><br><span class="line">                    ans=<span class="number">0</span></span><br><span class="line">                    out_h11=[x]</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">                        out_h11.append(((a*out_h11[-<span class="number">1</span>]+b)%(<span class="number">2</span>**tt)))                  </span><br><span class="line">                    out_h2 = [((ou[i] ^ out_h11[i]) % <span class="number">2</span>**tt)*<span class="number">2</span>**(n//<span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]    </span><br><span class="line">                    ans=<span class="built_in">sum</span>(w[i-windows]*(out_h2[i+<span class="number">1</span>]-out_h2[i])<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(windows,windows+m)) %mod</span><br><span class="line">                    delta=<span class="built_in">min</span>(ans,<span class="built_in">abs</span>(mod-ans))</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">int</span>(delta)&lt;<span class="number">2</span>*m*WW*<span class="number">2</span>**<span class="number">64</span>:</span><br><span class="line">                        oo.append((out_h11[<span class="number">0</span>],b))</span><br><span class="line">            <span class="keyword">if</span> now1 <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                now1=<span class="built_in">set</span>(oo)</span><br><span class="line">            <span class="keyword">else</span> :</span><br><span class="line">                now1=now1&amp;<span class="built_in">set</span>(oo)</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">len</span>(now1))</span><br><span class="line">            <span class="keyword">try</span>:      </span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">len</span>(now1)==<span class="number">0</span>):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span>          </span><br><span class="line">        <span class="built_in">print</span>(now1)</span><br><span class="line">        all_now.append(now1)        </span><br><span class="line">    <span class="keyword">return</span> all_now </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">now1=[(<span class="number">309</span>, <span class="number">69</span>), (<span class="number">53</span>, <span class="number">69</span>), (<span class="number">458</span>, <span class="number">255</span>), (<span class="number">201</span>, <span class="number">67</span>), (<span class="number">310</span>, <span class="number">1</span>), (<span class="number">54</span>, <span class="number">257</span>), (<span class="number">202</span>, <span class="number">255</span>), (<span class="number">310</span>, <span class="number">257</span>), (<span class="number">309</span>, <span class="number">325</span>), (<span class="number">53</span>, <span class="number">325</span>), (<span class="number">457</span>, <span class="number">67</span>), (<span class="number">458</span>, <span class="number">511</span>), (<span class="number">201</span>, <span class="number">323</span>), (<span class="number">202</span>, <span class="number">511</span>), (<span class="number">457</span>, <span class="number">323</span>), (<span class="number">54</span>, <span class="number">1</span>)]</span><br><span class="line">now2=&#123;(<span class="number">216885</span>, <span class="number">89669</span>), (<span class="number">85813</span>, <span class="number">220741</span>), (<span class="number">216885</span>, <span class="number">220741</span>), (<span class="number">85813</span>, <span class="number">89669</span>),(<span class="number">176329</span>, <span class="number">167491</span>), (<span class="number">45257</span>, <span class="number">36419</span>), (<span class="number">176329</span>, <span class="number">36419</span>), (<span class="number">45257</span>, <span class="number">167491</span>),(<span class="number">216886</span>, <span class="number">157697</span>), (<span class="number">216886</span>, <span class="number">26625</span>), (<span class="number">85814</span>, <span class="number">26625</span>), (<span class="number">85814</span>, <span class="number">157697</span>),(<span class="number">176330</span>, <span class="number">235519</span>), (<span class="number">45258</span>, <span class="number">235519</span>), (<span class="number">45258</span>, <span class="number">104447</span>), (<span class="number">176330</span>, <span class="number">104447</span>)&#125;</span><br><span class="line">now2=<span class="built_in">list</span>(now2)</span><br><span class="line">now3=&#123;(<span class="number">96423734</span>, <span class="number">55470081</span>), (<span class="number">96423734</span>, <span class="number">122578945</span>), (<span class="number">29314870</span>, <span class="number">55470081</span>), (<span class="number">29314870</span>, <span class="number">122578945</span>),(<span class="number">37793994</span>, <span class="number">78747647</span>), (<span class="number">37793994</span>, <span class="number">11638783</span>), (<span class="number">104902858</span>, <span class="number">11638783</span>), (<span class="number">104902858</span>, <span class="number">78747647</span>),(<span class="number">29314869</span>, <span class="number">119234117</span>), (<span class="number">96423733</span>, <span class="number">52125253</span>), (<span class="number">96423733</span>, <span class="number">119234117</span>), (<span class="number">29314869</span>, <span class="number">52125253</span>),(<span class="number">104902857</span>, <span class="number">75402819</span>), (<span class="number">37793993</span>, <span class="number">8293955</span>), (<span class="number">37793993</span>, <span class="number">75402819</span>), (<span class="number">104902857</span>, <span class="number">8293955</span>)&#125;</span><br><span class="line">now3=<span class="built_in">list</span>(now3)</span><br><span class="line">now4=&#123;(<span class="number">67876376373</span>, <span class="number">12265938501</span>), (<span class="number">33516638005</span>, <span class="number">12265938501</span>), (<span class="number">67876376373</span>, <span class="number">46625676869</span>), (<span class="number">33516638005</span>, <span class="number">46625676869</span>),(<span class="number">35202838729</span>, <span class="number">61815557699</span>), (<span class="number">843100361</span>, <span class="number">61815557699</span>), (<span class="number">35202838729</span>, <span class="number">27455819331</span>), (<span class="number">843100361</span>, <span class="number">27455819331</span>),(<span class="number">67876376374</span>, <span class="number">26764797953</span>), (<span class="number">33516638006</span>, <span class="number">26764797953</span>), (<span class="number">67876376374</span>, <span class="number">61124536321</span>), (<span class="number">33516638006</span>, <span class="number">61124536321</span>),(<span class="number">843100362</span>, <span class="number">41954678783</span>), (<span class="number">35202838730</span>, <span class="number">7594940415</span>), (<span class="number">843100362</span>, <span class="number">7594940415</span>), (<span class="number">35202838730</span>, <span class="number">41954678783</span>)&#125;</span><br><span class="line">now4=<span class="built_in">list</span>(now4)</span><br><span class="line">now5=&#123;(<span class="number">11236477546697</span>, <span class="number">20952536485443</span>), (<span class="number">11236477546697</span>, <span class="number">3360350441027</span>), (<span class="number">28828663591113</span>, <span class="number">3360350441027</span>), (<span class="number">27729151963337</span>, <span class="number">6384007417411</span>), (<span class="number">27729151963337</span>, <span class="number">23976193461827</span>), (<span class="number">10136965918921</span>, <span class="number">6384007417411</span>), (<span class="number">10136965918921</span>, <span class="number">23976193461827</span>), (<span class="number">28828663591113</span>, <span class="number">20952536485443</span>),(<span class="number">25047406169910</span>, <span class="number">10540844738561</span>), (<span class="number">25047406169910</span>, <span class="number">28133030782977</span>), (<span class="number">6355708497718</span>, <span class="number">31156687759361</span>), (<span class="number">7455220125494</span>, <span class="number">10540844738561</span>), (<span class="number">7455220125494</span>, <span class="number">28133030782977</span>), (<span class="number">23947894542134</span>, <span class="number">13564501714945</span>), (<span class="number">23947894542134</span>, <span class="number">31156687759361</span>), (<span class="number">6355708497718</span>, <span class="number">13564501714945</span>)&#125;</span><br><span class="line">now5=<span class="built_in">list</span>(now5)</span><br><span class="line">now6=&#123;(<span class="number">17128433498763465</span>, <span class="number">6811536349630019</span>), (<span class="number">17128433498763465</span>, <span class="number">15818735604371011</span>), (<span class="number">8121234244022473</span>, <span class="number">6811536349630019</span>), (<span class="number">8121234244022473</span>, <span class="number">15818735604371011</span>),(<span class="number">9893164265459510</span>, <span class="number">3848661059397633</span>), (<span class="number">885965010718518</span>, <span class="number">3848661059397633</span>), (<span class="number">9893164265459510</span>, <span class="number">12855860314138625</span>), (<span class="number">885965010718518</span>, <span class="number">12855860314138625</span>)&#125;</span><br><span class="line">now6=<span class="built_in">list</span>(now6)</span><br><span class="line">now7=&#123;(<span class="number">3674051330923606217</span>, <span class="number">1123704243937513027</span>), (<span class="number">5979894340137300169</span>, <span class="number">1123704243937513027</span>), (<span class="number">8285737349350994121</span>, <span class="number">1123704243937513027</span>), (<span class="number">3674051330923606217</span>, <span class="number">5735390262364900931</span>), (<span class="number">1368208321709912265</span>, <span class="number">1123704243937513027</span>), (<span class="number">5979894340137300169</span>, <span class="number">5735390262364900931</span>), (<span class="number">8285737349350994121</span>, <span class="number">5735390262364900931</span>), (<span class="number">1368208321709912265</span>, <span class="number">5735390262364900931</span>),(<span class="number">3243477696717475638</span>, <span class="number">8353522370204297217</span>), (<span class="number">5549320705931169590</span>, <span class="number">3741836351776909313</span>), (<span class="number">7855163715144863542</span>, <span class="number">3741836351776909313</span>), (<span class="number">937634687503781686</span>, <span class="number">3741836351776909313</span>), (<span class="number">5549320705931169590</span>, <span class="number">8353522370204297217</span>), (<span class="number">3243477696717475638</span>, <span class="number">3741836351776909313</span>), (<span class="number">7855163715144863542</span>, <span class="number">8353522370204297217</span>), (<span class="number">937634687503781686</span>, <span class="number">8353522370204297217</span>)&#125;</span><br><span class="line">now7=<span class="built_in">list</span>(now7)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(now7))</span><br><span class="line"><span class="comment">#w=get_w(9,m,2)</span></span><br><span class="line"><span class="comment">#now1=guess(9,[(0,0)],w,2,9,16)</span></span><br><span class="line"><span class="comment">#w=get_w(18,m,3)</span></span><br><span class="line"><span class="comment">#now2=guess(18,noww,w,3,9,4)</span></span><br><span class="line"><span class="comment">#w=get_w(27,m,5)</span></span><br><span class="line"><span class="comment">#now3=guess(27,now2,w,5,9,3)</span></span><br><span class="line"><span class="comment">#w=get_w(36,m,5)</span></span><br><span class="line"><span class="comment">#now4=guess(36,now3,w,5,9,3)</span></span><br><span class="line"><span class="comment">#w=get_w(45,m,6)</span></span><br><span class="line"><span class="comment">#now5=guess(45,now4,w,6,9,3)</span></span><br><span class="line"><span class="comment">#w=get_w(54,m,7)</span></span><br><span class="line"><span class="comment">#now6=guess(54,now5,w,7,9,3)</span></span><br><span class="line"><span class="comment">#w=get_w(63,m,8)</span></span><br><span class="line"><span class="comment">#now7=guess(63,now6,w,8,9,3)</span></span><br><span class="line"><span class="comment">#w=get_w(64,m,10)</span></span><br><span class="line"><span class="comment">#now8=guess(64,now7,w,10,1,3)</span></span><br><span class="line">now8=&#123;(<span class="number">12897423367778382025</span>, <span class="number">1123704243937513027</span>), (<span class="number">3674051330923606217</span>, <span class="number">10347076280792288835</span>), (<span class="number">3674051330923606217</span>, <span class="number">1123704243937513027</span>), (<span class="number">12897423367778382025</span>, <span class="number">10347076280792288835</span>),(<span class="number">5549320705931169590</span>, <span class="number">12965208388631685121</span>), (<span class="number">5549320705931169590</span>, <span class="number">3741836351776909313</span>), (<span class="number">14772692742785945398</span>, <span class="number">12965208388631685121</span>), (<span class="number">14772692742785945398</span>, <span class="number">3741836351776909313</span>)&#125;</span><br><span class="line"><span class="keyword">for</span> x ,b <span class="keyword">in</span> now8:</span><br><span class="line">    t1=(a*x+b)%(<span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line">    x1=x+(x^ou[<span class="number">0</span>])*(<span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line">    x2=t1+(t1^ou[<span class="number">1</span>])*(<span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line">    bb=(x2-x1*a)%(<span class="number">2</span>**<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">if</span> bb%(<span class="number">2</span>**<span class="number">64</span>)==b:</span><br><span class="line">        d=inverse(a,<span class="number">2</span>**<span class="number">128</span>)</span><br><span class="line">        seed=d*(x1-bb)%(<span class="number">2</span>**<span class="number">128</span>)</span><br><span class="line">        key=md5(<span class="built_in">str</span>(seed).encode()).digest()</span><br><span class="line">        <span class="built_in">print</span>(AES.new(key=key,mode=AES.MODE_ECB).decrypt(enc))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>还是太菜了😂，继续学习吧</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://lst4r-max.github.io">Lst4r</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://lst4r-max.github.io/2024/04/30/XYCTF2025%20wp&amp;%E5%A4%8D%E7%8E%B0/">https://lst4r-max.github.io/2024/04/30/XYCTF2025%20wp&amp;%E5%A4%8D%E7%8E%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lst4r-max.github.io" target="_blank">Lst4r's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a></div><div class="post_share"><div class="social-share" data-image="/img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/30/XYCTF2024%20WP/" title="XYCTF Crypto WP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">XYCTF Crypto WP</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/25/NKCTF2024-%E5%A4%8D%E7%8E%B0-wp/" title="NKCTF2024 复现+wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">NKCTF2024 复现+wp</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/03/06/Lst4r-s-first-Blog/" title="RSA 基本原理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-06</div><div class="title">RSA 基本原理</div></div></a></div><div><a href="/2024/03/12/RSA2/" title="RSA 一些进阶攻击方式及变体"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-12</div><div class="title">RSA 一些进阶攻击方式及变体</div></div></a></div><div><a href="/2024/08/11/SRCTF%E5%A4%8D%E7%8E%B0/" title="SRCTF Crypto 复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-11</div><div class="title">SRCTF Crypto 复现</div></div></a></div><div><a href="/2024/03/25/NKCTF2024-%E5%A4%8D%E7%8E%B0-wp/" title="NKCTF2024 复现+wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-25</div><div class="title">NKCTF2024 复现+wp</div></div></a></div><div><a href="/2024/11/05/%E5%BC%BA%E7%BD%91%E6%9D%AF2024%E5%A4%8D%E7%8E%B0/" title="强网杯2024 Crypto复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-05</div><div class="title">强网杯2024 Crypto复现</div></div></a></div><div><a href="/2024/04/30/XYCTF2024%20WP/" title="XYCTF Crypto WP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-30</div><div class="title">XYCTF Crypto WP</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Lst4r</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Lst4r-max/Lst4r-max.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Lst4r's new Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#XYCTF-2025-Crypto"><span class="toc-number">1.</span> <span class="toc-text">XYCTF 2025 Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#division"><span class="toc-number">1.1.</span> <span class="toc-text">division</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-number">1.1.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#complex-signin"><span class="toc-number">1.2.</span> <span class="toc-text">complex_signin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reed"><span class="toc-number">1.3.</span> <span class="toc-text">reed</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F-exp"><span class="toc-number">1.3.2.</span> <span class="toc-text">非预期 exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E6%9C%9F-exp"><span class="toc-number">1.3.3.</span> <span class="toc-text">预期 exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8B%92%E7%B4%A2%E7%97%85%E6%AF%92"><span class="toc-number">1.4.</span> <span class="toc-text">勒索病毒</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-2"><span class="toc-number">1.4.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#choice"><span class="toc-number">1.5.</span> <span class="toc-text">*choice</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-4"><span class="toc-number">1.5.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-3"><span class="toc-number">1.5.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E5%A4%8D%E5%A4%8D%E5%A4%8D%E6%95%B0"><span class="toc-number">1.6.</span> <span class="toc-text">*复复复复数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-5"><span class="toc-number">1.6.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-4"><span class="toc-number">1.6.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prng-xxxx"><span class="toc-number">1.7.</span> <span class="toc-text">*prng_xxxx</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-6"><span class="toc-number">1.7.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">1.7.2.</span> <span class="toc-text">思路</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%BC%95%E5%85%A5"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">问题引入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%BE%E5%88%B0-omega"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">找到 $\omega$</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%8C%9C%E6%B5%8B-k-%E4%BD%8D"><span class="toc-number">1.7.2.3.</span> <span class="toc-text">猜测 $k$ 位</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.7.2.4.</span> <span class="toc-text">判断条件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8D%E6%96%AD%E9%87%8D%E5%A4%8D%E4%BB%A5%E5%8F%8A%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7"><span class="toc-number">1.7.2.5.</span> <span class="toc-text">不断重复以及优化技巧</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-5"><span class="toc-number">1.7.3.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">1.8.</span> <span class="toc-text">结语</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/05/%E5%BC%BA%E7%BD%91%E6%9D%AF2024%E5%A4%8D%E7%8E%B0/" title="强网杯2024 Crypto复现">强网杯2024 Crypto复现</a><time datetime="2024-11-05T12:24:31.000Z" title="发表于 2024-11-05 20:24:31">2024-11-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/11/SRCTF%E5%A4%8D%E7%8E%B0/" title="SRCTF Crypto 复现">SRCTF Crypto 复现</a><time datetime="2024-08-11T04:33:20.000Z" title="发表于 2024-08-11 12:33:20">2024-08-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/30/XYCTF2024%20WP/" title="XYCTF Crypto WP">XYCTF Crypto WP</a><time datetime="2024-04-30T01:52:47.000Z" title="发表于 2024-04-30 09:52:47">2024-04-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/30/XYCTF2025%20wp&amp;%E5%A4%8D%E7%8E%B0/" title="XYCTF2025 wp&amp;复现">XYCTF2025 wp&amp;复现</a><time datetime="2024-04-30T01:52:47.000Z" title="发表于 2024-04-30 09:52:47">2024-04-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/25/NKCTF2024-%E5%A4%8D%E7%8E%B0-wp/" title="NKCTF2024 复现+wp">NKCTF2024 复现+wp</a><time datetime="2024-03-25T12:18:57.000Z" title="发表于 2024-03-25 20:18:57">2024-03-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Lst4r</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>