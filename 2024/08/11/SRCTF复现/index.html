<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SRCTF Crypto 复现 | Lst4r's Blog</title><meta name="author" content="Lst4r"><meta name="copyright" content="Lst4r"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="justez题目12345678910111213141516171819202122from Crypto.Util.number import *flag &#x3D; bytes_to_long(b&#x27;SRCTF&#123;Kicky_Mu_is_a_beautiful_girl!&#125;&#x27;)Ö_0Ovo &#x3D; getPrime(30)o_oOvo &#x3D; getPrime(512)o">
<meta property="og:type" content="article">
<meta property="og:title" content="SRCTF Crypto 复现">
<meta property="og:url" content="https://lst4r-max.github.io/2024/08/11/SRCTF%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="Lst4r&#39;s Blog">
<meta property="og:description" content="justez题目12345678910111213141516171819202122from Crypto.Util.number import *flag &#x3D; bytes_to_long(b&#x27;SRCTF&#123;Kicky_Mu_is_a_beautiful_girl!&#125;&#x27;)Ö_0Ovo &#x3D; getPrime(30)o_oOvo &#x3D; getPrime(512)o">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lst4r-max.github.io/img/1.jpg">
<meta property="article:published_time" content="2024-08-11T04:33:20.000Z">
<meta property="article:modified_time" content="2024-11-05T12:23:03.193Z">
<meta property="article:author" content="Lst4r">
<meta property="article:tag" content="Crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lst4r-max.github.io/img/1.jpg"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://lst4r-max.github.io/2024/08/11/SRCTF%E5%A4%8D%E7%8E%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SRCTF Crypto 复现',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-05 20:23:03'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: transparent"><nav id="nav"><span id="blog-info"><a href="/" title="Lst4r's Blog"><span class="site-name">Lst4r's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SRCTF Crypto 复现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-11T04:33:20.000Z" title="发表于 2024-08-11 12:33:20">2024-08-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-11-05T12:23:03.193Z" title="更新于 2024-11-05 20:23:03">2024-11-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="SRCTF Crypto 复现"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="justez"><a href="#justez" class="headerlink" title="justez"></a>justez</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(<span class="string">b&#x27;SRCTF&#123;Kicky_Mu_is_a_beautiful_girl!&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Ö_0Ovo = getPrime(<span class="number">30</span>)</span><br><span class="line">o_oOvo = getPrime(<span class="number">512</span>)</span><br><span class="line">o_oÖvo = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">phi_n = (o_oOvo-<span class="number">1</span>)*(o_oÖvo-<span class="number">1</span>)</span><br><span class="line">e = <span class="built_in">pow</span>(Ö_0Ovo, -<span class="number">1</span>, phi_n)</span><br><span class="line">n = o_oOvo * o_oÖvo</span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;the_secret =&#x27;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;crazy_e =&#x27;</span>, e)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 59447861832652211537262617254184281479829852166925461903662081261289292515576905767937322840660932440029530280492275752616941795671201953079301018060203465429579475061460085183882511211044583402328605487602525290853335843501892756351462762579677498265076859047191958682405236293711382106634923860856875702197</span></span><br><span class="line"><span class="string">the_secret = 5531240943076956185419252532740075458153435638783876058593858932704838715927408036778103767030441428608060995278765402621496571055270582748608426450102229896581270452441624390124702053351607096961665933344552694074590045043665839297172339145388284294053051066633951096064582407552698859869765532283938542919</span></span><br><span class="line"><span class="string">crazy_e = 14983946116420718695910350497572468216707179624388443450376271801029353003883222766239928455540840247101746285898514708092585961191614089889673789620455880325382360817355279757931949420354758283821942288319417005937365971171869321539979940627452543996523114498789386921202216406398001675382099523934286309463</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>花里胡哨的，看了半天没看明白，一看 e 很大,试了试 wiener 一下出了<br>exp:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cf[::-<span class="number">1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> numerator, denominator</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pq</span>(<span class="params">a, b, c</span>):</span><br><span class="line">    par = gmpy2.isqrt(b * b - <span class="number">4</span> * a * c)</span><br><span class="line">    <span class="keyword">return</span> (-b + par) // (<span class="number">2</span> * a), (-b - par) // (<span class="number">2</span> * a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getGradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    gf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(cf) + <span class="number">1</span>):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    <span class="keyword">return</span> gf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    <span class="keyword">for</span> d, k <span class="keyword">in</span> gf:</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        p, q = solve_pq(<span class="number">1</span>, n - phi + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">59447861832652211537262617254184281479829852166925461903662081261289292515576905767937322840660932440029530280492275752616941795671201953079301018060203465429579475061460085183882511211044583402328605487602525290853335843501892756351462762579677498265076859047191958682405236293711382106634923860856875702197</span></span><br><span class="line">e= <span class="number">14983946116420718695910350497572468216707179624388443450376271801029353003883222766239928455540840247101746285898514708092585961191614089889673789620455880325382360817355279757931949420354758283821942288319417005937365971171869321539979940627452543996523114498789386921202216406398001675382099523934286309463</span></span><br><span class="line">c=<span class="number">5531240943076956185419252532740075458153435638783876058593858932704838715927408036778103767030441428608060995278765402621496571055270582748608426450102229896581270452441624390124702053351607096961665933344552694074590045043665839297172339145388284294053051066633951096064582407552698859869765532283938542919</span></span><br><span class="line">d = wienerAttack(e, n)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;Wi3ner_is_often_encountered_on_RSA!&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="leak"><a href="#leak" class="headerlink" title="leak"></a>leak</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">1013</span></span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">dp = d % (p-<span class="number">1</span>)</span><br><span class="line">leak = dp&gt;&gt;<span class="number">200</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak = <span class="subst">&#123;leak&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 110213245423787811834518112811871374057182659656333171180583906182098866895106152169202974253392946952670696530676210762805363864263383224528537325490112353868969261155364863882874549993204597016739119560224274234085791998310748667903130690276875928801213222945825623033159412256315898753155041172844790881283</span></span><br><span class="line"><span class="string">e = 1013</span></span><br><span class="line"><span class="string">leak = 2111661101489986207946671243111315656386526068378675693749037940046822939637002369276880737091</span></span><br><span class="line"><span class="string">c = 44953911831010760674028216893023771903735777342102642215298073259026291235527656090988244571561391378675170728470813535186907109257362776905391646755360995924417928753904003476238093726521687524894340317021957879542128875867159267372684219741723042726979008939837475097290381429403885987472234565635819680600</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>一看便知是 $d_p$ 高位泄露,推式子进行 coppersmith 可解<br>只需将原来博客的 $d_p$ 泄露变形可得。</p>
<script type="math/tex; mode=display">ed_p=(p-1)[k_2(q-1)-k_1e]+1</script><script type="math/tex; mode=display">ed_p=k(p-1)+1</script><script type="math/tex; mode=display">e(d_ph+x)+k-1=0</script><p>于是，对 k 进行爆破，然后 coppersmith 求解 x<br>exp:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">n = 110213245423787811834518112811871374057182659656333171180583906182098866895106152169202974253392946952670696530676210762805363864263383224528537325490112353868969261155364863882874549993204597016739119560224274234085791998310748667903130690276875928801213222945825623033159412256315898753155041172844790881283</span><br><span class="line">e = 1013</span><br><span class="line">leak = 2111661101489986207946671243111315656386526068378675693749037940046822939637002369276880737091</span><br><span class="line">c = 44953911831010760674028216893023771903735777342102642215298073259026291235527656090988244571561391378675170728470813535186907109257362776905391646755360995924417928753904003476238093726521687524894340317021957879542128875867159267372684219741723042726979008939837475097290381429403885987472234565635819680600</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">F= PolynomialRing(Zmod(n),&#x27;x&#x27;)</span><br><span class="line">x=F.gen()</span><br><span class="line"></span><br><span class="line">for k in range(1, e):</span><br><span class="line">	f = e*((leak &lt;&lt; 200) + x )+ (k - 1) </span><br><span class="line">	x0 = f.monic().small_roots(X=2 ** (200 + 1), beta=0.44, epsilon=1/32)</span><br><span class="line">	if len(x0) != 0:</span><br><span class="line">		dp = x0[0] + (leak &lt;&lt; 200)</span><br><span class="line">		for i in range(2, e):</span><br><span class="line">			p = (e * Integer(dp) - 1 + i) // i</span><br><span class="line">			if n % p == 0:</span><br><span class="line">				break</span><br><span class="line">		if p &lt; 0:</span><br><span class="line">			continue</span><br><span class="line">		else:</span><br><span class="line">			print(&#x27;k = &#x27;,k)</span><br><span class="line">			print(&#x27;p = &#x27;,p)</span><br><span class="line">			print(&#x27;dp = &#x27;,dp)</span><br><span class="line">			break</span><br><span class="line"></span><br><span class="line">k =  408</span><br><span class="line">p =  8425052872189860196277887295078450264003332273673576496739640825877578791706584134790827422650971920893248291608498662987569073222104075696946298915286253</span><br><span class="line">dp =  3393308560566103613110935850337618665067482297787580662062955041419597381062474162877253295598811987881979568584666786277322983094391375009234047341990909</span><br><span class="line">q=n//p</span><br><span class="line">d=inverse(e,(p-1)*(q-1))</span><br><span class="line">print(long_to_bytes(pow(c,d,n)))          </span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;do_you_hear_of_the_high_dp_leak&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Who-is-Bob"><a href="#Who-is-Bob" class="headerlink" title="Who_is_Bob"></a>Who_is_Bob</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(<span class="string">b&#x27;SRCTF&#123;Kicky_Mu_is_a_beautiful_girl!&#125;&#x27;</span>)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">Bob = getRandomInteger(<span class="number">30</span>)</span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line">leak = (p-Bob)*(q-Bob)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;leak = &quot;</span>, leak)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n =  83551533637791995343217075093207075888114751056630372530634434127047066670630844940247145420790307521479826874365675804269523298586266076638571271567234671704671269359605807984410204884607410984160816036002212842986210090410991351912353876745392317665760163054027137901527714797966126447118700149990317258891</span></span><br><span class="line"><span class="string">c =  78309281660733853390608911365864030224721696340767714309397025309727923007988734506317736073773797381428997269420533151442862487934268321488021490923820201215298630613307224160553995648878611049792491221454161735360351132054599297761941011233121670402299191829524451472897533682050463933866813803099215448841</span></span><br><span class="line"><span class="string">leak =  83551533637791995343217075093207075888114751056630372530634434127047066670630844940247145420790307521479826874365675804269523298586266076638571257216554908695119517636260243773643003707817620018239877623870076598042268179945412307565612034852201182156671007990234097768953570942262083345175668126848614778091      </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>分析一下题目</p>
<script type="math/tex; mode=display">n=pq</script><script type="math/tex; mode=display">leak=pq-Bob(p+q)+Bob^{2}</script><p>所以</p>
<script type="math/tex; mode=display">n-leak=Bob(p+q-Bob)</script><p>因为 Bob 是一个 30 位左右的数，我们可以把 n-leak 进行分解，然后把小因子组合成三十位左右的数，遍历破解<br>exp:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n =  <span class="number">83551533637791995343217075093207075888114751056630372530634434127047066670630844940247145420790307521479826874365675804269523298586266076638571271567234671704671269359605807984410204884607410984160816036002212842986210090410991351912353876745392317665760163054027137901527714797966126447118700149990317258891</span></span><br><span class="line">c =  <span class="number">78309281660733853390608911365864030224721696340767714309397025309727923007988734506317736073773797381428997269420533151442862487934268321488021490923820201215298630613307224160553995648878611049792491221454161735360351132054599297761941011233121670402299191829524451472897533682050463933866813803099215448841</span></span><br><span class="line">leak =  <span class="number">83551533637791995343217075093207075888114751056630372530634434127047066670630844940247145420790307521479826874365675804269523298586266076638571257216554908695119517636260243773643003707817620018239877623870076598042268179945412307565612034852201182156671007990234097768953570942262083345175668126848614778091</span></span><br><span class="line">t=n-leak</span><br><span class="line">a=[<span class="number">32</span>,<span class="number">25</span>,<span class="number">41</span>,<span class="number">41399</span>,<span class="number">95222249</span>]</span><br><span class="line">bob1=a[<span class="number">0</span>]*a[<span class="number">1</span>]*a[<span class="number">2</span>]*a[<span class="number">3</span>]//<span class="number">2</span></span><br><span class="line">bob2=a[<span class="number">4</span>]*<span class="number">8</span></span><br><span class="line">bob3=a[<span class="number">4</span>]*<span class="number">10</span></span><br><span class="line">pqsum1=(t//bob1)+bob1</span><br><span class="line">pqsum2=(t//bob2)+bob2</span><br><span class="line">pqsum3=(t//bob3)+bob3</span><br><span class="line">pqsum=[pqsum1,pqsum2,pqsum3]</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">for i in pqsum:</span></span><br><span class="line"><span class="string">    pqmin=int(sqrt((i*i)-4*n))</span></span><br><span class="line"><span class="string">    #print(pqmin)</span></span><br><span class="line"><span class="string">    p=(i+pqmin)//2</span></span><br><span class="line"><span class="string">    print(p)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">pp=<span class="number">11692922501282668874022132757465052074830894777545589851919999009583302109770521986233252511087974403084746456540880192584440061782414824853752632260753401</span></span><br><span class="line"><span class="built_in">print</span>(isPrime(pp))</span><br><span class="line">qq=n//pp</span><br><span class="line">d=inverse(e,(pp-<span class="number">1</span>)*(qq-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;Bob_is_a_b@d_b0y_He_cuts_in_line_everywh3re..&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="leak-revenge"><a href="#leak-revenge" class="headerlink" title="leak revenge"></a>leak revenge</h2><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">dp = inverse(e, p - <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;dph = <span class="subst">&#123;dp &gt;&gt; <span class="number">115</span> &lt;&lt;<span class="number">115</span>&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;<span class="built_in">pow</span>(m,e,n)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 99808598778276923350368946118829564161543192771741967304113142692217693457972421525964898372688505220132024575461230316318177765543298394717753949509523080306599063058808987337840085569950414884529534449801215600413303898393849792345972321407524999652571659221193654323489992751031985715286873931985408130197</span></span><br><span class="line"><span class="string">e = 9550490518460184889</span></span><br><span class="line"><span class="string">dph = 4239371595915398923623854132330356869028911602649930928560125044718768467773415379438150660838271530302945945606708178367182566660953659123879375907323904</span></span><br><span class="line"><span class="string">c = 18661814437233106799783882536249538287931377372915334052147813302071480339780465378376553936510407532657463793836895065758256947765504246845601788497861702555369338586376572381147331367628136147491699775987490116748428373153021965663362046971594255692960097313870139384700219810117047587229718472407783734575</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个题唯一与 leak 不同的点就是这个题的 e 很大，无法像普通的 $d_p$ 泄露那样去遍历<br>所以可以设两个未知数进行二元 coppersmith<br>(但是长时间的调参确实挺烦的)<br>exp:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">import itertools</span><br><span class="line">def small_roots(f, bounds, m=1, d=None):</span><br><span class="line">	if not d:</span><br><span class="line">		d = f.degree()</span><br><span class="line"></span><br><span class="line">	if isinstance(f, Polynomial):</span><br><span class="line">		x, = polygens(f.base_ring(), f.variable_name(), 1)</span><br><span class="line">		f = f(x)</span><br><span class="line"></span><br><span class="line">	R = f.base_ring()</span><br><span class="line">	N = R.cardinality()</span><br><span class="line">	</span><br><span class="line">	f /= f.coefficients().pop(0)</span><br><span class="line">	f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">	G = Sequence([], f.parent())</span><br><span class="line">	for i in range(m+1):</span><br><span class="line">		base = N**(m-i) * f**i</span><br><span class="line">		for shifts in itertools.product(range(d), repeat=f.nvariables()):</span><br><span class="line">			g = base * prod(map(power, f.variables(), shifts))</span><br><span class="line">			G.append(g)</span><br><span class="line"></span><br><span class="line">	B, monomials = G.coefficient_matrix()</span><br><span class="line">	monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">	factors = [monomial(*bounds) for monomial in monomials]</span><br><span class="line">	for i, factor in enumerate(factors):</span><br><span class="line">		B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">	B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">	B = B.change_ring(QQ)</span><br><span class="line">	for i, factor in enumerate(factors):</span><br><span class="line">		B.rescale_col(i, 1/factor)</span><br><span class="line"></span><br><span class="line">	H = Sequence([], f.parent().change_ring(QQ))</span><br><span class="line">	for h in filter(None, B*monomials):</span><br><span class="line">		H.append(h)</span><br><span class="line">		I = H.ideal()</span><br><span class="line">		if I.dimension() == -1:</span><br><span class="line">			H.pop()</span><br><span class="line">		elif I.dimension() == 0:</span><br><span class="line">			roots = []</span><br><span class="line">			for root in I.variety(ring=ZZ):</span><br><span class="line">				root = tuple(R(root[var]) for var in f.variables())</span><br><span class="line">				roots.append(root)</span><br><span class="line">			return roots</span><br><span class="line"></span><br><span class="line">	return []</span><br><span class="line">n = 99808598778276923350368946118829564161543192771741967304113142692217693457972421525964898372688505220132024575461230316318177765543298394717753949509523080306599063058808987337840085569950414884529534449801215600413303898393849792345972321407524999652571659221193654323489992751031985715286873931985408130197</span><br><span class="line">e = 9550490518460184889</span><br><span class="line">dph = 4239371595915398923623854132330356869028911602649930928560125044718768467773415379438150660838271530302945945606708178367182566660953659123879375907323904</span><br><span class="line">c = 18661814437233106799783882536249538287931377372915334052147813302071480339780465378376553936510407532657463793836895065758256947765504246845601788497861702555369338586376572381147331367628136147491699775987490116748428373153021965663362046971594255692960097313870139384700219810117047587229718472407783734575</span><br><span class="line">F= PolynomialRing(Zmod(n),&#x27;x,k&#x27;)</span><br><span class="line">x,k=F.gens()</span><br><span class="line">f=e*(dph+x)+(k-1)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">roots=small_roots(f,[2**115,2**64],m=3,d=6)</span><br><span class="line">print(roots)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">x=3027685711070484531889028075542545</span><br><span class="line">k=3406275539771437164</span><br><span class="line">dp=dph+x</span><br><span class="line">t=pow(2,e*dp,n)-2</span><br><span class="line">p=GCD(t,n)</span><br><span class="line">q=n//p</span><br><span class="line">d=inverse(e,(p-1)*(q-1))</span><br><span class="line">print(long_to_bytes(pow(c,d,n)))</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;00adb8189e3580577be8b97d1da8e205d0b64d4e65570547d7a67850fad1e4a2&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="baby"><a href="#baby" class="headerlink" title="baby"></a>baby</h2><h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">700</span>)</span><br><span class="line">t = getPrime(<span class="number">800</span>)</span><br><span class="line">tmp = getPrime(<span class="number">10</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;<span class="built_in">pow</span>(m,e,n)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak = <span class="subst">&#123;p*r+q*t+tmp&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;r = <span class="subst">&#123;r&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;t = <span class="subst">&#123;t&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 30075387915048470863070050827629191303436443913395824732907226821054460652219815718226645166341618100700084925720992983286419204902032573926790086035422540879196867669665497753447829812026327367178333296715527968448124126434045869420695221514125724904849358819864918062875310272203931927234053359553779163755</span></span><br><span class="line"><span class="string">leak = 52407066630998720273731758848751180003129908965730006096464345923549459617438414126937562326106182853585345246472838907532807236677219886418149723311118855918338387062301958904467478605422673207935942348215552655035846974843053690523359908921489934306458440759517598485452824210146131626776354968352617955744704892906092826257342911994753745093428990023111339468228443855826492957321799005181961</span></span><br><span class="line"><span class="string">r = 4515378990844403115229704433484433833022655205121974667074150580454343643752811757675793959795169040704894972951300994535151410073321406165168737850534934347874731893617893819762340858239387281147345869706971753</span></span><br><span class="line"><span class="string">t = 6006929234728180950140499814342609393927042935104177663404375056306287820676434237439964941788093406713118055152122129530273026459457066165368157449726903765601586482566299501860863052052121811433466409338266730837645652741024637475218039773</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>首先还是对题目进行分析，p 和 q 都是质数，r 和 t 已知, 而 tmp 又很小,于是可以对 tmp 进行爆破<br>然后便可以使用扩展欧几里得方法求解质数的丢番图方程<br>即</p>
<script type="math/tex; mode=display">r*p+t*q=leak-tmp</script><p>exp:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extended_gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (a, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, x, y = extended_gcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> (g, y, x - (a // b) * y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_diophantine_prime</span>(<span class="params">a, b, c</span>):</span><br><span class="line">    <span class="comment"># Find the modular inverse of a modulo b (since a and b are coprime)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mod_inverse</span>(<span class="params">x, m</span>):</span><br><span class="line">        <span class="comment"># Using Fermat&#x27;s little theorem for modular inverse since m is prime</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(x, m - <span class="number">2</span>, m)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Compute the modular inverse of a modulo b</span></span><br><span class="line">    a_inv = mod_inverse(a, b)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Compute the solution for x and y</span></span><br><span class="line">    x = (c * a_inv) % b</span><br><span class="line">    y = (c - a * x) // b</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> y &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (x, y)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c = <span class="number">30075387915048470863070050827629191303436443913395824732907226821054460652219815718226645166341618100700084925720992983286419204902032573926790086035422540879196867669665497753447829812026327367178333296715527968448124126434045869420695221514125724904849358819864918062875310272203931927234053359553779163755</span></span><br><span class="line">leak = <span class="number">52407066630998720273731758848751180003129908965730006096464345923549459617438414126937562326106182853585345246472838907532807236677219886418149723311118855918338387062301958904467478605422673207935942348215552655035846974843053690523359908921489934306458440759517598485452824210146131626776354968352617955744704892906092826257342911994753745093428990023111339468228443855826492957321799005181961</span></span><br><span class="line">r = <span class="number">4515378990844403115229704433484433833022655205121974667074150580454343643752811757675793959795169040704894972951300994535151410073321406165168737850534934347874731893617893819762340858239387281147345869706971753</span></span><br><span class="line">t = <span class="number">6006929234728180950140499814342609393927042935104177663404375056306287820676434237439964941788093406713118055152122129530273026459457066165368157449726903765601586482566299501860863052052121811433466409338266730837645652741024637475218039773</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">for i in tqdm(range(2**10)):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    solution = solve_diophantine_prime(r, t, leak-i)</span></span><br><span class="line"><span class="string">    if solution:</span></span><br><span class="line"><span class="string">        x, y = solution</span></span><br><span class="line"><span class="string">        print(f&quot;Positive integer solution: x = &#123;x&#125;, y = &#123;y&#125;&quot;)</span></span><br><span class="line"><span class="string">    else:</span></span><br><span class="line"><span class="string">        print(&quot;No positive integer solution found.&quot;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">p=<span class="number">10107036304221590140315537220898906759095811790937615837692120715006548746019505046230668048672611600884439559253340540831445253603270525554564368273932957</span></span><br><span class="line">q=<span class="number">8724435494930578791898201381855906261499199490201926298013879508413402076594452143243163216133538607634050021589040517038447172885148196774972396508093843</span></span><br><span class="line">n=p*q</span><br><span class="line">d=inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;0896649c53c145919ce741f180957834&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Elementary-Chinese"><a href="#Elementary-Chinese" class="headerlink" title="Elementary Chinese"></a>Elementary Chinese</h2><h3 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">漐訦硁剏鐐遑瓜谠黥噻麚俵曧玫甠媸辌戋黥巹飖煭谨晋瑢鳵鲢醢厨広癕讚鲛徣蟥昉豜雴餭謡爮裹涛僦茺仦蔯餭猳鼣譋壵鐄碝攡驑鐐钾髯蒥躚烗黥犬蝒虇雯緥畋讅瑊肰擁襙蝒寃輲镁饶穩泾姲騂讅噻竊蚇擹坕缀裶糆萾瓬睁問擹鹨巹鷬鵷礟緥巅殱麺铦氋颷黜磘勆镭碾泾赞锽侭瀾晶晗鲠哰齝摛缀爂膼麏褦鸉覴羘剙脡巑黥餅婴広蛟橳佳爮麚踺嘊徖賍鱝広筝鶵曍瓣棾</span><br></pre></td></tr></table></figure>
<p>根据题目的解释，要注意拼音，所以猜测是四进制，但是有一个字的拼音出题人好像弄错了，半天没搞出来<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">鐐: liáo 还是 liào</span><br></pre></td></tr></table></figure><br>这里是 liáo 但上网查的是 liào<br>后面就四个一组将四进制转化为字符即可<br>exp:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#cipher=b&quot;漐訦硁剏鐐遑瓜谠黥噻麚俵曧玫甠媸辌戋黥巹飖煭谨晋瑢鳵鲢醢厨広癕讚鲛徣蟥昉豜雴餭謡爮裹涛僦茺仦蔯餭猳鼣譋壵鐄碝攡驑鐐钾髯蒥躚烗黥犬蝒虇雯緥畋讅瑊肰擁襙蝒寃輲镁饶穩泾姲騂讅噻竊蚇擹坕缀裶糆萾瓬睁問擹鹨巹鷬鵷礟緥巅殱麺铦氋颷黜磘勆镭碾泾赞锽侭瀾晶晗鲠哰齝摛缀爂膼麏褦鸉覴羘剙脡巑黥餅婴広蛟橳佳爮麚踺嘊徖賍鱝広筝鶵曍瓣棾&quot;</span></span><br><span class="line">pinyin=<span class="string">&quot;zhí chén kēng chuàng liáo huáng guā dǎng qíng sāi jiā biào róng méi qíng chī liáng jiān qíng jǐn yáo liè jǐn jìn róng bǎo lián hǎi chú guǎng yōng zàn jiāo jiè huáng fǎng jiān chì huáng yáo páo guǒ tāo jiù chōng chào chén huáng jiā fèi lán zhuàng huáng ruǎn chī liú liáo jiǎ rán liú xiān kài qíng quǎn mián quǎn wén bǎo tián shěn jiān rán yōng cào mián yuān chuán měi ráo wěn jīng yàn xīng shěn sāi qiè chǐ tān jīng zhuì fēi miàn yíng fǎng zhēng wèn tān liù jǐn huáng yuān pào bǎo diān jiān miàn xiān méng biāo chù yáo láng léi niǎn jīng zàn huáng jǐn lán jīng hán gěng láo chī chī zhuì biāo zhuā jūn nài yáng dèng zāng chuàng tǐng cuán qíng bǐng yīng guǎng jiāo shèng jiā páo jiā jiàn ái cóng zāng fèn guǎng zhēng chú hào bàn qíng&quot;</span></span><br><span class="line"><span class="comment"># 声调映射表</span></span><br><span class="line">tone_map = &#123;</span><br><span class="line">    <span class="string">&#x27;ā&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;á&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;ǎ&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;à&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;ō&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;ó&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;ǒ&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;ò&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;ē&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;é&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;ě&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;è&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;ī&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;í&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;ǐ&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;ì&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;ū&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;ú&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;ǔ&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;ù&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;ǖ&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;ǘ&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;ǚ&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;ǜ&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 函数：将拼音转换为声调数字</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pinyin_to_tone_numbers</span>(<span class="params">pinyin</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> pinyin:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> tone_map:</span><br><span class="line">            result.append(<span class="built_in">str</span>(tone_map[char]))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">converted = pinyin_to_tone_numbers(pinyin)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(converted))</span><br><span class="line"><span class="built_in">print</span>(converted)</span><br><span class="line">oct_sum=<span class="number">0</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(converted),<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        oct_sum+=<span class="built_in">int</span>(converted[<span class="built_in">len</span>(converted)-i-j-<span class="number">1</span>])*<span class="number">4</span>**j</span><br><span class="line">    flag+=<span class="built_in">chr</span>(oct_sum)</span><br><span class="line">    oct_sum=<span class="number">0</span></span><br><span class="line">flag=flag[::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;fc65c57ae6fa4f283c9815cdd079b158&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="gen-复现参考了其他师傅的wp"><a href="#gen-复现参考了其他师傅的wp" class="headerlink" title="gen(复现参考了其他师傅的wp)"></a>gen(复现参考了其他师傅的wp)</h2><h3 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">Sbox = [</span><br><span class="line">    [<span class="number">6</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">9</span>],</span><br><span class="line">    [<span class="number">0</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>],</span><br><span class="line">    [<span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">2</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>],</span><br><span class="line">    [<span class="number">6</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">7</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">    [<span class="number">4</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>],</span><br><span class="line">    [<span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">3</span>],</span><br><span class="line">    [<span class="number">3</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">5</span>],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        p = getPrime(<span class="number">512</span>)</span><br><span class="line">        pp = <span class="built_in">str</span>(p)[::-<span class="number">1</span>]</span><br><span class="line">        qq = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pp)):</span><br><span class="line">            qq = <span class="built_in">str</span>(Sbox[i % <span class="built_in">len</span>(Sbox)][<span class="built_in">int</span>(pp[i])]) + qq</span><br><span class="line">        q = <span class="built_in">int</span>(qq)</span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">return</span> (p, q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = gen()</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(m, e, n))</span><br><span class="line"><span class="comment"># 540218955345736273157270500365412222635891331555885916094749429447522188097945587651602148011705042986794108314271976399685176209609565497683234538512051568892773567571780647542150095914514310788820174077474562960838254063787178970291739930150059487074686161337439933674264104852452665182142544893614405627421</span></span><br><span class="line"><span class="comment"># 64145178427862668977081119089224310813473899829361200429199320440654203799866988377450609415834134038989684748529337444191033925457821155131291654022850629061769294069279168614460327625093659378555734131036896690174186521680529952315042672582956230276121971979462073816915057029858827954023430179144497317212</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>分析题目，可知 p 的最后一位和 q 的最后一位直接存在确定的映射关系<br>而 n 的最后一位是1，那么遍历 9 种情况，p 和 q 都只能为 9,根据最后一位一步步剪枝推出正确结果<br>exp:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">540218955345736273157270500365412222635891331555885916094749429447522188097945587651602148011705042986794108314271976399685176209609565497683234538512051568892773567571780647542150095914514310788820174077474562960838254063787178970291739930150059487074686161337439933674264104852452665182142544893614405627421</span></span><br><span class="line">c=<span class="number">64145178427862668977081119089224310813473899829361200429199320440654203799866988377450609415834134038989684748529337444191033925457821155131291654022850629061769294069279168614460327625093659378555734131036896690174186521680529952315042672582956230276121971979462073816915057029858827954023430179144497317212</span></span><br><span class="line">Sbox = [</span><br><span class="line">    [<span class="number">6</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">9</span>],</span><br><span class="line">    [<span class="number">0</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>],</span><br><span class="line">    [<span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">2</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>],</span><br><span class="line">    [<span class="number">6</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">7</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">    [<span class="number">4</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>],</span><br><span class="line">    [<span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">3</span>],</span><br><span class="line">    [<span class="number">3</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">5</span>],</span><br><span class="line">]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(p)==<span class="number">155</span>:</span><br><span class="line">        P=<span class="built_in">int</span>(p)</span><br><span class="line">        <span class="keyword">if</span> n%P==<span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>, P)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;q = &quot;</span>, n // P)</span><br><span class="line">            Q = n // P</span><br><span class="line">            d = inverse(<span class="number">65537</span>, (P - <span class="number">1</span>) * (Q - <span class="number">1</span>))</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        l=<span class="built_in">len</span>(p)</span><br><span class="line">        pp=<span class="built_in">int</span>(p)</span><br><span class="line">        qq=<span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">            qq=<span class="built_in">str</span>(Sbox[i%<span class="built_in">len</span>(Sbox)][<span class="built_in">int</span>(p[::-<span class="number">1</span>][i])])+qq</span><br><span class="line">        <span class="keyword">if</span> pp*<span class="built_in">int</span>(qq)%(<span class="number">10</span>**l)==n%(<span class="number">10</span>**l):</span><br><span class="line">            find_p(<span class="string">&#x27;0&#x27;</span>+p)</span><br><span class="line">            find_p(<span class="string">&#x27;1&#x27;</span>+p)</span><br><span class="line">            find_p(<span class="string">&#x27;2&#x27;</span>+p)</span><br><span class="line">            find_p(<span class="string">&#x27;3&#x27;</span>+p)</span><br><span class="line">            find_p(<span class="string">&#x27;4&#x27;</span>+p)</span><br><span class="line">            find_p(<span class="string">&#x27;5&#x27;</span>+p)</span><br><span class="line">            find_p(<span class="string">&#x27;6&#x27;</span>+p)</span><br><span class="line">            find_p(<span class="string">&#x27;7&#x27;</span>+p)</span><br><span class="line">            find_p(<span class="string">&#x27;8&#x27;</span>+p)</span><br><span class="line">            find_p(<span class="string">&#x27;9&#x27;</span>+p)</span><br><span class="line">find_p(<span class="string">&#x27;9&#x27;</span>)</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;ee986d80-387c-4c84-b84b-2712b0b67bcd&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="ez-solve"><a href="#ez-solve" class="headerlink" title="ez_solve"></a>ez_solve</h2><h3 id="题目-7"><a href="#题目-7" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>(<span class="params">n</span>):</span><br><span class="line">M = Matrix(Zmod(n), [[getRandomRange(<span class="number">1</span>, n) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)])</span><br><span class="line">M1 = M ^ <span class="number">7</span> + <span class="number">6</span> * M ^ <span class="number">6</span> + <span class="number">3</span> * M ^ <span class="number">2</span> + M + <span class="number">1</span></span><br><span class="line">M2 = <span class="number">4</span> * M ^ <span class="number">5</span> + <span class="number">7</span> * M ^ <span class="number">4</span> + <span class="number">2</span> * M + <span class="number">3</span></span><br><span class="line"><span class="keyword">return</span> (M, M1, M2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">M, M1, M2 = get_key(n)</span><br><span class="line">key = hashlib.md5(<span class="built_in">str</span>(M.<span class="built_in">list</span>()).encode()).digest()</span><br><span class="line">aes = AES.new(key, mode=AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(aes.encrypt(pad(flag, <span class="number">16</span>)))</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(M1.<span class="built_in">list</span>())</span><br><span class="line"><span class="built_in">print</span>(M2.<span class="built_in">list</span>())</span><br><span class="line"><span class="comment"># b&#x27;\xaf\xd3!\\P\x0c$9\xfeG&quot;x\xb3\xc7JM\x0b\&#x27;L\x8cTqV@\x9e\x9e\xca\xac\xdd\xe4\x895\xa3\x9eN\xe8I\xd5\xb0\x91\x11AF\xd2\x9aU\x13\x97&#x27;</span></span><br><span class="line"><span class="comment"># 126436888267781012728325147862192168074569338402123226307022297048826644481193368519869158824390349539092252616101267181512556989487056829549324008171102838036066363029806878372696377305159681565847972365181357622469349705573034076248549130732505935614642532285063301806885341154101123265057874816214806847677</span></span><br><span class="line"><span class="comment"># [70788049802210872657325474973365961442495115963939277111865641350055048819901449822465632485606809020379471344797466194449610657690124929335160372366988228457807825557779907523973200512849665350793199564054667797095235171828334472880330391081301022201012413131565133166332507683245743314875929810856790436028, 93946310204344655470602799904463622648439244872656217486655791642515217356156195473567620253966035813293372124117916489727251962676211225293104321516981316934405843429585710046938735376779352440126787506851899947800684153304312951755327163478544961002945679221651503277132313685024467548530758328430111859735, 96280788181347867387546511220835057901226801297359421216412587732796485902928071822366009289662352700051927639887171910509282396855557218492280060681547535867164958051250532899312830267988516922862014098628387540003902290370590147972903761411462873247308975754394195969694999091155197116885130653910521683842, 82968820255058883255035919030714183763637640426458940210286495015124852401276839072824063644723868173042409742829747820513526023772841551680844947180758028332567132440255523252901711427912620603874983324313253887270511317678867022612080327696264144752321538967369820957008434069521447129905236906803526449052, 23299939970678363067737192335571816938832859884862879524180056303051043776582248093649001894041305543962310176893242271115838409280326024222781284417771289946883993071845824610852423883414065657696777623395756513604997163135194317008850263759756833624467482947918313131551485197582615658945205896614289768844, 12983229406499732766141201642339110334498321705779917236046293992952541768389345853789584123291003231130829707571457826064936320037975264940065396109524266757004298297631174616695451557008050606667929361178266452374719656732014717973253518421162343858079544410372965537523850761391016472822972062324715285821, 102522723534333820647817806349916608091975463464876408921339270432881180080624135367414031830957392607669052112905585189043873269667208251596592543967942876255968974965698140745376987088298473350746668639863852806280742776259621730959806167803512848032747755591545712867081782475183677960718676607337573465642, 101666582535813407265759152164420943615616329707204869986587049904118224403977817390759622828336361005497206377740967334830281520359624652559092011610839320662635489533080837328012868032165362424052880565510492490317524446183777309040096699685518956281236647308550541625378511575250474514867226225253068719258, 79442597659147067581773733694758591827187291960025689084947969583130621716487571613128072331388014344690626587494794377775357639035269728387459627578598303445043911517221963728054055359832212876846727128042710915166446033690747475137976997044478962738285351194601741478649641210324553973743695513720007047865]</span></span><br><span class="line"><span class="comment"># [85011002078021702764472439338820924251455189945180267744980241098005803607511171258905278632018866003808163766109232407574158722086042726859565957224224010875065213612287866466761370710306083365809484078520495239041845733432413997652662145274025593229074870746684396607481127158456761704078728846871014283062, 18612493541785904649700966115790082384712245572041693066739605782836252870835030585662238851252782669670594810980638014446195757864801546734972135506912044894945083421004786093045806649929848545667867196747667200493107958865268190000456363702141159840947563300323427898417483671272951426375223346964668572202, 10409979193367499472238347512348607682499183547949721486066213585501558540546807632346892656854949402968057978796265467271586423071299360812471632877173810510426132082877303152085723994146887708361801458949991817004233513007750041281905357726928616237585294306617301025270702049840653918649824323245565456296, 97290271388985204317932363489916228438600093380586125891212597692547209089950446573430815456999358546548926193902149490545083783325024867522263244533702358555195302200103982600342219036362518186912529398096636367780716298443050757576707116185606208575548291849605483451107659242851579658350685748518020410211, 76411493174297200650248506483885046672690570276281714974696849296346055295820839317219387382826797610738355107033587767990534452288775589370108333558624084021822211400921546808923416455824771057494166214771225257186562668685129247626889962538777358945577011128780834633426695072195814100527260881504241756687, 5122114398009812781159747267707750339659355680409087605287249113203075596790778474420937161282283953877075026676474859652618480039163607844664641744859419097006197970206934095749955844481900067023204763191843938898938307689971028726469929005296920462303115960487419521108527765364965899343332761215507901639, 4190168064902985417336866300235101969303944554522816131917429195932521441903346161906106929451667035112869115516063816550722995394671535767072356133255240738814875494919929489253058192284807929170918975253490840121109704757447474130780255171436129225761920436787457240980477097737167025549908544228449437793, 92038810567168570182052926585081830349594291044515853041436552873038313936469360592524373391834296631010810767608882263488728123582514368288663729696416739745217893454185009768143978854066443924004089645733654847040545336889463479429136357813613024590889363749057519833244388485571762542928224585216650638133, 39733188009602619238067345618094689399116546385773633410090207141820523314320874815210874136182638764226311487300791611009147956447064627569336230354430504000875017912529708558255520653453380608857267698291775234169514019990026283886571060009487498041457927636329437842221965777862646266407961917351017019700]</span></span><br></pre></td></tr></table></figure>
<p>分析完题目逻辑，要根据 $M_1$ 和 $M_2$ 两个关于 M 的矩阵方程去解 M<br>我们可以建立一个生成元为 M 的矩阵的环，然后去求两个环多项式的因式</p>
<script type="math/tex; mode=display">f=M^7 + 6 * M ^ 6 + 3 * M ^ 2 + M + 1-M_1</script><script type="math/tex; mode=display">g=4 * M ^ 5 + 7 * M ^ 4 + 2 * M + 3-M_2</script><p>得出关于 M 的一次因式即可解出 M<br>exp:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from sage.all import *</span><br><span class="line">import hashlib</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">def gcd(g1, g2):</span><br><span class="line">    while g2:</span><br><span class="line">        g1, g2 = g2, g1 % g2</span><br><span class="line">    return g1.monic()</span><br><span class="line">c=b&#x27;\xaf\xd3!\\P\x0c$9\xfeG&quot;x\xb3\xc7JM\x0b\&#x27;L\x8cTqV@\x9e\x9e\xca\xac\xdd\xe4\x895\xa3\x9eN\xe8I\xd5\xb0\x91\x11AF\xd2\x9aU\x13\x97&#x27;</span><br><span class="line">n=126436888267781012728325147862192168074569338402123226307022297048826644481193368519869158824390349539092252616101267181512556989487056829549324008171102838036066363029806878372696377305159681565847972365181357622469349705573034076248549130732505935614642532285063301806885341154101123265057874816214806847677</span><br><span class="line">M1=[70788049802210872657325474973365961442495115963939277111865641350055048819901449822465632485606809020379471344797466194449610657690124929335160372366988228457807825557779907523973200512849665350793199564054667797095235171828334472880330391081301022201012413131565133166332507683245743314875929810856790436028, 93946310204344655470602799904463622648439244872656217486655791642515217356156195473567620253966035813293372124117916489727251962676211225293104321516981316934405843429585710046938735376779352440126787506851899947800684153304312951755327163478544961002945679221651503277132313685024467548530758328430111859735, 96280788181347867387546511220835057901226801297359421216412587732796485902928071822366009289662352700051927639887171910509282396855557218492280060681547535867164958051250532899312830267988516922862014098628387540003902290370590147972903761411462873247308975754394195969694999091155197116885130653910521683842, 82968820255058883255035919030714183763637640426458940210286495015124852401276839072824063644723868173042409742829747820513526023772841551680844947180758028332567132440255523252901711427912620603874983324313253887270511317678867022612080327696264144752321538967369820957008434069521447129905236906803526449052, 23299939970678363067737192335571816938832859884862879524180056303051043776582248093649001894041305543962310176893242271115838409280326024222781284417771289946883993071845824610852423883414065657696777623395756513604997163135194317008850263759756833624467482947918313131551485197582615658945205896614289768844, 12983229406499732766141201642339110334498321705779917236046293992952541768389345853789584123291003231130829707571457826064936320037975264940065396109524266757004298297631174616695451557008050606667929361178266452374719656732014717973253518421162343858079544410372965537523850761391016472822972062324715285821, 102522723534333820647817806349916608091975463464876408921339270432881180080624135367414031830957392607669052112905585189043873269667208251596592543967942876255968974965698140745376987088298473350746668639863852806280742776259621730959806167803512848032747755591545712867081782475183677960718676607337573465642, 101666582535813407265759152164420943615616329707204869986587049904118224403977817390759622828336361005497206377740967334830281520359624652559092011610839320662635489533080837328012868032165362424052880565510492490317524446183777309040096699685518956281236647308550541625378511575250474514867226225253068719258, 79442597659147067581773733694758591827187291960025689084947969583130621716487571613128072331388014344690626587494794377775357639035269728387459627578598303445043911517221963728054055359832212876846727128042710915166446033690747475137976997044478962738285351194601741478649641210324553973743695513720007047865]</span><br><span class="line">M2=[85011002078021702764472439338820924251455189945180267744980241098005803607511171258905278632018866003808163766109232407574158722086042726859565957224224010875065213612287866466761370710306083365809484078520495239041845733432413997652662145274025593229074870746684396607481127158456761704078728846871014283062, 18612493541785904649700966115790082384712245572041693066739605782836252870835030585662238851252782669670594810980638014446195757864801546734972135506912044894945083421004786093045806649929848545667867196747667200493107958865268190000456363702141159840947563300323427898417483671272951426375223346964668572202, 10409979193367499472238347512348607682499183547949721486066213585501558540546807632346892656854949402968057978796265467271586423071299360812471632877173810510426132082877303152085723994146887708361801458949991817004233513007750041281905357726928616237585294306617301025270702049840653918649824323245565456296, 97290271388985204317932363489916228438600093380586125891212597692547209089950446573430815456999358546548926193902149490545083783325024867522263244533702358555195302200103982600342219036362518186912529398096636367780716298443050757576707116185606208575548291849605483451107659242851579658350685748518020410211, 76411493174297200650248506483885046672690570276281714974696849296346055295820839317219387382826797610738355107033587767990534452288775589370108333558624084021822211400921546808923416455824771057494166214771225257186562668685129247626889962538777358945577011128780834633426695072195814100527260881504241756687, 5122114398009812781159747267707750339659355680409087605287249113203075596790778474420937161282283953877075026676474859652618480039163607844664641744859419097006197970206934095749955844481900067023204763191843938898938307689971028726469929005296920462303115960487419521108527765364965899343332761215507901639, 4190168064902985417336866300235101969303944554522816131917429195932521441903346161906106929451667035112869115516063816550722995394671535767072356133255240738814875494919929489253058192284807929170918975253490840121109704757447474130780255171436129225761920436787457240980477097737167025549908544228449437793, 92038810567168570182052926585081830349594291044515853041436552873038313936469360592524373391834296631010810767608882263488728123582514368288663729696416739745217893454185009768143978854066443924004089645733654847040545336889463479429136357813613024590889363749057519833244388485571762542928224585216650638133, 39733188009602619238067345618094689399116546385773633410090207141820523314320874815210874136182638764226311487300791611009147956447064627569336230354430504000875017912529708558255520653453380608857267698291775234169514019990026283886571060009487498041457927636329437842221965777862646266407961917351017019700]</span><br><span class="line">M1=Matrix(Zmod(n),3,3,M1)</span><br><span class="line">M2=Matrix(Zmod(n),3,3,M2)</span><br><span class="line">PR=PolynomialRing(MatrixSpace(Zmod(n),3,3),&#x27;M&#x27;)</span><br><span class="line">M=PR.gen()</span><br><span class="line">f = M**7 + 6*M**6 + 3*M**2 + M + 1 - M1</span><br><span class="line">g = 4*M**5 + 7*M**4 + 2*M + 3 - M2</span><br><span class="line">M=-gcd(f,g)[0]</span><br><span class="line">key = hashlib.md5(str(M.list()).encode()).digest()</span><br><span class="line">aes = AES.new(key, mode=AES.MODE_ECB)</span><br><span class="line">print(aes.decrypt(c))</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;4141614931b3e2a75a84f70af7f2adc5&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="hash-attack"><a href="#hash-attack" class="headerlink" title="hash attack"></a>hash attack</h2><h3 id="题目-8"><a href="#题目-8" class="headerlink" title="题目"></a>题目</h3><p>hash_attack.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Util <span class="keyword">import</span> ez_hash, gensalt</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line">FLAG = <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>).read()</span><br><span class="line">salt = gensalt()</span><br><span class="line">key = <span class="string">&quot;adwa_only_has_one_key&quot;</span></span><br><span class="line">hash_key = ez_hash(key, salt)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    password = b64decode(<span class="built_in">input</span>(<span class="string">&quot;input your key: &quot;</span>)).decode(<span class="string">&quot;latin-1&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;wrong&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> password != key <span class="keyword">and</span> ez_hash(password, salt) == hash_key:</span><br><span class="line">    <span class="built_in">print</span>(FLAG)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Your key is wrong&quot;</span>)</span><br></pre></td></tr></table></figure><br>Util.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">iv = <span class="number">0x7380166F4914B2B9172442D7DA8A0600A96F30BC163138AAE38DEE4DB0FB0E4E</span></span><br><span class="line">MAX = <span class="number">2</span>**<span class="number">32</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_bin</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">bin</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> msg])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int_bin</span>(<span class="params">a, l</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bin</span>(a)[<span class="number">2</span>:].zfill(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bin_hex</span>(<span class="params">a, l</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(<span class="built_in">int</span>(a, <span class="number">2</span>))[<span class="number">2</span>:].zfill(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int_left_shift</span>(<span class="params">a, k, bit=<span class="number">32</span></span>):</span><br><span class="line">    <span class="keyword">return</span> ((a &lt;&lt; k) &amp; <span class="number">0xFFFFFFFF</span>) | ((a &amp; <span class="number">0xFFFFFFFF</span>) &gt;&gt; (bit - k))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">T</span>(<span class="params">j</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0x79CC4519</span> <span class="keyword">if</span> j &lt;= <span class="number">15</span> <span class="keyword">else</span> <span class="number">0x7A879D8A</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FF</span>(<span class="params">x, y, z, j</span>):</span><br><span class="line">    <span class="keyword">if</span> j &lt;= <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">return</span> x ^ y ^ z</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (x &amp; y) | (x &amp; z) | (y &amp; z)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GG</span>(<span class="params">x, y, z, j</span>):</span><br><span class="line">    <span class="keyword">if</span> j &lt;= <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">return</span> x ^ y ^ z</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (x &amp; y) | ((x ^ <span class="number">0xFFFFFFFF</span>) &amp; z)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">P0</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ^ int_left_shift(x, <span class="number">9</span>) ^ int_left_shift(x, <span class="number">17</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">P1</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ^ int_left_shift(x, <span class="number">15</span>) ^ int_left_shift(x, <span class="number">23</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(msg) &lt; <span class="number">512</span>:</span><br><span class="line">        l = <span class="built_in">len</span>(msg)</span><br><span class="line">        k = <span class="number">512</span> - (l - <span class="number">447</span>) % <span class="number">512</span></span><br><span class="line">        <span class="keyword">return</span> msg + <span class="string">&quot;1&quot;</span> + k * <span class="string">&quot;0&quot;</span> + int_bin(l, <span class="number">64</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">msg_pad</span>(<span class="params">bi</span>):</span><br><span class="line">    w = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        w.append(<span class="built_in">int</span>(bi[<span class="number">32</span> * i : <span class="number">32</span> * i + <span class="number">32</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, <span class="number">68</span>):</span><br><span class="line">        w.append(</span><br><span class="line">            P1(w[i - <span class="number">16</span>] ^ w[i - <span class="number">9</span>] ^ int_left_shift(w[i - <span class="number">3</span>], <span class="number">15</span>))</span><br><span class="line">            ^ int_left_shift(w[i - <span class="number">13</span>], <span class="number">7</span>)</span><br><span class="line">            ^ w[i - <span class="number">6</span>]</span><br><span class="line">        )</span><br><span class="line">    w_ = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        w_.append(w[i] ^ w[i + <span class="number">4</span>])</span><br><span class="line">    <span class="keyword">return</span> w, w_</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cf</span>(<span class="params">vi, bi</span>):</span><br><span class="line">    w, w_ = msg_pad(bi)</span><br><span class="line">    abcdefgh = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        abcdefgh.append(<span class="built_in">int</span>(vi[i * <span class="number">32</span> : (i + <span class="number">1</span>) * <span class="number">32</span>], <span class="number">2</span>))</span><br><span class="line">    a, b, c, d, e, f, g, h = abcdefgh</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        ss1 = int_left_shift(</span><br><span class="line">            int_left_shift(a, <span class="number">12</span>) + e + int_left_shift(T(j), j % <span class="number">32</span>) % MAX, <span class="number">7</span></span><br><span class="line">        )</span><br><span class="line">        ss2 = ss1 ^ (int_left_shift(a, <span class="number">12</span>))</span><br><span class="line">        tt1 = (FF(a, b, c, j) + d + ss2 + w_[j]) % MAX</span><br><span class="line">        tt2 = (GG(e, f, g, j) + h + ss1 + w[j]) % MAX</span><br><span class="line">        d = c</span><br><span class="line">        c = int_left_shift(b, <span class="number">9</span>)</span><br><span class="line">        b = a</span><br><span class="line">        a = tt1</span><br><span class="line">        h = g</span><br><span class="line">        g = int_left_shift(f, <span class="number">19</span>)</span><br><span class="line">        f = e</span><br><span class="line">        e = P0(tt2)</span><br><span class="line">    vi_1 = <span class="built_in">int</span>(</span><br><span class="line">        int_bin(a, <span class="number">32</span>)</span><br><span class="line">        + int_bin(b, <span class="number">32</span>)</span><br><span class="line">        + int_bin(c, <span class="number">32</span>)</span><br><span class="line">        + int_bin(d, <span class="number">32</span>)</span><br><span class="line">        + int_bin(e, <span class="number">32</span>)</span><br><span class="line">        + int_bin(f, <span class="number">32</span>)</span><br><span class="line">        + int_bin(g, <span class="number">32</span>)</span><br><span class="line">        + int_bin(h, <span class="number">32</span>),</span><br><span class="line">        <span class="number">2</span>,</span><br><span class="line">    ) ^ <span class="built_in">int</span>(vi, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> int_bin(vi_1, <span class="number">256</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iteration_func</span>(<span class="params">msg</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(msg) // <span class="number">512</span></span><br><span class="line">    bi = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        bi.append(msg[<span class="number">512</span> * i : <span class="number">512</span> * i + <span class="number">512</span>])</span><br><span class="line">    v = [int_bin(iv, <span class="number">256</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        v.append(cf(v[i], bi[i]))</span><br><span class="line">    <span class="keyword">return</span> bin_hex(v[n], <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ez_hash</span>(<span class="params">msg, salt=<span class="literal">None</span></span>):</span><br><span class="line">    bin_msg = str_bin(msg)</span><br><span class="line">    pad_msg = pad(bin_msg)</span><br><span class="line">    <span class="keyword">if</span> salt <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        pad_msg += salt</span><br><span class="line">    c = iteration_func(pad_msg)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gensalt</span>():</span><br><span class="line">    strings = <span class="string">&quot;&quot;&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~ &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([random.choice(strings) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)])</span><br></pre></td></tr></table></figure><br>这道题看着很复杂，其实将代码意思理清楚后很简单<br>主要的漏洞在这一点<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(msg) &lt; <span class="number">512</span>:</span><br><span class="line">        l = <span class="built_in">len</span>(msg)</span><br><span class="line">        k = <span class="number">512</span> - (l - <span class="number">447</span>) % <span class="number">512</span></span><br><span class="line">        <span class="keyword">return</span> msg + <span class="string">&quot;1&quot;</span> + k * <span class="string">&quot;0&quot;</span> + int_bin(l, <span class="number">64</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> msg</span><br></pre></td></tr></table></figure><br>pad 会将信息填充到512位，但 salt 只有32位，下面接着看主要逻辑的函数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">iteration_func</span>(<span class="params">msg</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(msg) // <span class="number">512</span></span><br><span class="line">    bi = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        bi.append(msg[<span class="number">512</span> * i : <span class="number">512</span> * i + <span class="number">512</span>])</span><br><span class="line">    v = [int_bin(iv, <span class="number">256</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        v.append(cf(v[i], bi[i]))</span><br><span class="line">    <span class="keyword">return</span> bin_hex(v[n], <span class="number">64</span>)</span><br></pre></td></tr></table></figure><br>ez_hash 的加密会导致 iteration_func 中的 n 只能为1，那么加不加盐其实加密的结果是一样的<br>再看主函数的要求<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">salt = gensalt()</span><br><span class="line">key = <span class="string">&quot;adwa_only_has_one_key&quot;</span></span><br><span class="line">hash_key = ez_hash(key, salt)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    password = b64decode(<span class="built_in">input</span>(<span class="string">&quot;input your key: &quot;</span>)).decode(<span class="string">&quot;latin-1&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;wrong&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> password != key <span class="keyword">and</span> ez_hash(password, salt) == hash_key:</span><br><span class="line">    <span class="built_in">print</span>(FLAG)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Your key is wrong&quot;</span>)</span><br></pre></td></tr></table></figure><br>要求提交的 key 解密后不能等于题目给出的 key,分析 pad 函数，可以得知每次 pad 得到的东西都是唯一的，且 key 进行 pad 得到的东西和 pad 进行 pad 得到的东西一定是相同的。<br>我们只需进行反解，然后将原文加上 pad 进行 base64 提交即可<br>exp:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;110.40.35.62&#x27;</span>,<span class="string">&#x27;34246&#x27;</span>)</span><br><span class="line">MAX = <span class="number">2</span>**<span class="number">32</span></span><br><span class="line">iv = <span class="number">0x7380166F4914B2B9172442D7DA8A0600A96F30BC163138AAE38DEE4DB0FB0E4E</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_bin</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">bin</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> msg])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int_bin</span>(<span class="params">a, l</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bin</span>(a)[<span class="number">2</span>:].zfill(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bin_hex</span>(<span class="params">a, l</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(<span class="built_in">int</span>(a, <span class="number">2</span>))[<span class="number">2</span>:].zfill(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int_left_shift</span>(<span class="params">a, k, bit=<span class="number">32</span></span>):</span><br><span class="line">    <span class="keyword">return</span> ((a &lt;&lt; k) &amp; <span class="number">0xFFFFFFFF</span>) | ((a &amp; <span class="number">0xFFFFFFFF</span>) &gt;&gt; (bit - k))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">T</span>(<span class="params">j</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0x79CC4519</span> <span class="keyword">if</span> j &lt;= <span class="number">15</span> <span class="keyword">else</span> <span class="number">0x7A879D8A</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FF</span>(<span class="params">x, y, z, j</span>):</span><br><span class="line">    <span class="keyword">if</span> j &lt;= <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">return</span> x ^ y ^ z</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (x &amp; y) | (x &amp; z) | (y &amp; z)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GG</span>(<span class="params">x, y, z, j</span>):</span><br><span class="line">    <span class="keyword">if</span> j &lt;= <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">return</span> x ^ y ^ z</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (x &amp; y) | ((x ^ <span class="number">0xFFFFFFFF</span>) &amp; z)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">P0</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ^ int_left_shift(x, <span class="number">9</span>) ^ int_left_shift(x, <span class="number">17</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">P1</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ^ int_left_shift(x, <span class="number">15</span>) ^ int_left_shift(x, <span class="number">23</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(msg) &lt; <span class="number">512</span>:</span><br><span class="line">        l = <span class="built_in">len</span>(msg)</span><br><span class="line">        k = <span class="number">512</span> - (l - <span class="number">447</span>) % <span class="number">512</span></span><br><span class="line">        <span class="keyword">return</span> msg + <span class="string">&quot;1&quot;</span> + k * <span class="string">&quot;0&quot;</span> + int_bin(l, <span class="number">64</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">msg_pad</span>(<span class="params">bi</span>):</span><br><span class="line">    w = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        w.append(<span class="built_in">int</span>(bi[<span class="number">32</span> * i : <span class="number">32</span> * i + <span class="number">32</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, <span class="number">68</span>):</span><br><span class="line">        w.append(</span><br><span class="line">            P1(w[i - <span class="number">16</span>] ^ w[i - <span class="number">9</span>] ^ int_left_shift(w[i - <span class="number">3</span>], <span class="number">15</span>))</span><br><span class="line">            ^ int_left_shift(w[i - <span class="number">13</span>], <span class="number">7</span>)</span><br><span class="line">            ^ w[i - <span class="number">6</span>]</span><br><span class="line">        )</span><br><span class="line">    w_ = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        w_.append(w[i] ^ w[i + <span class="number">4</span>])</span><br><span class="line">    <span class="keyword">return</span> w, w_</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cf</span>(<span class="params">vi, bi</span>):</span><br><span class="line">    w, w_ = msg_pad(bi)</span><br><span class="line">    abcdefgh = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        abcdefgh.append(<span class="built_in">int</span>(vi[i * <span class="number">32</span> : (i + <span class="number">1</span>) * <span class="number">32</span>], <span class="number">2</span>))</span><br><span class="line">    a, b, c, d, e, f, g, h = abcdefgh</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        ss1 = int_left_shift(</span><br><span class="line">            int_left_shift(a, <span class="number">12</span>) + e + int_left_shift(T(j), j % <span class="number">32</span>) % MAX, <span class="number">7</span></span><br><span class="line">        )</span><br><span class="line">        ss2 = ss1 ^ (int_left_shift(a, <span class="number">12</span>))</span><br><span class="line">        tt1 = (FF(a, b, c, j) + d + ss2 + w_[j]) % MAX</span><br><span class="line">        tt2 = (GG(e, f, g, j) + h + ss1 + w[j]) % MAX</span><br><span class="line">        d = c</span><br><span class="line">        c = int_left_shift(b, <span class="number">9</span>)</span><br><span class="line">        b = a</span><br><span class="line">        a = tt1</span><br><span class="line">        h = g</span><br><span class="line">        g = int_left_shift(f, <span class="number">19</span>)</span><br><span class="line">        f = e</span><br><span class="line">        e = P0(tt2)</span><br><span class="line">    vi_1 = <span class="built_in">int</span>(</span><br><span class="line">        int_bin(a, <span class="number">32</span>)</span><br><span class="line">        + int_bin(b, <span class="number">32</span>)</span><br><span class="line">        + int_bin(c, <span class="number">32</span>)</span><br><span class="line">        + int_bin(d, <span class="number">32</span>)</span><br><span class="line">        + int_bin(e, <span class="number">32</span>)</span><br><span class="line">        + int_bin(f, <span class="number">32</span>)</span><br><span class="line">        + int_bin(g, <span class="number">32</span>)</span><br><span class="line">        + int_bin(h, <span class="number">32</span>),</span><br><span class="line">        <span class="number">2</span>,</span><br><span class="line">    ) ^ <span class="built_in">int</span>(vi, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> int_bin(vi_1, <span class="number">256</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iteration_func</span>(<span class="params">msg</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(msg) // <span class="number">512</span></span><br><span class="line">    bi = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        bi.append(msg[<span class="number">512</span> * i : <span class="number">512</span> * i + <span class="number">512</span>])</span><br><span class="line">    v = [int_bin(iv, <span class="number">256</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        v.append(cf(v[i], bi[i]))</span><br><span class="line">    <span class="keyword">return</span> bin_hex(v[n], <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ez_hash</span>(<span class="params">msg, salt=<span class="literal">None</span></span>):</span><br><span class="line">    bin_msg = str_bin(msg)</span><br><span class="line">    pad_msg = pad(bin_msg)</span><br><span class="line">    <span class="built_in">print</span>(pad_msg)</span><br><span class="line">    <span class="keyword">if</span> salt <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        pad_msg += salt</span><br><span class="line">    c = iteration_func(pad_msg)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gensalt</span>():</span><br><span class="line">    strings = <span class="string">&quot;&quot;&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~ &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([random.choice(strings) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)])</span><br><span class="line">key = <span class="string">&quot;adwa_only_has_one_key&quot;</span></span><br><span class="line">salt=gensalt()</span><br><span class="line">ez_hash(key)</span><br><span class="line">pad_msg =<span class="number">0b01100001011001000111011101100001010111110110111101101110011011000111100101011111011010000110000101110011010111110110111101101110011001010101111101101011011001010111100110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101000</span></span><br><span class="line">msg=long_to_bytes(pad_msg)</span><br><span class="line">key=base64.b64encode(msg)</span><br><span class="line">r.sendline(key)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;0a2df8b4-3745-4046-9465-55cd12c7c4b4&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="miniRSA"><a href="#miniRSA" class="headerlink" title="miniRSA"></a>miniRSA</h2><h3 id="题目-9"><a href="#题目-9" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p_lists = [<span class="number">159514797898368694161035323666560455482927593628677715144231158683776654589410889361171506677869798913439553045649444471426486937156757512923737117257266219702305948490272092580126724358398210101455463243496876546152497051194626631388993441751102173455821084385690114474413278066052568157824769407231302148231</span>,<span class="number">164502040257301220127513609478443722760842040728679662285075057209725349316105183287859838362165949816685266852802699646133095636456140274119704558163346582955848072668773982942422021335047461181890966859173748565841810779262398379776937252911005772364747785905459772986563538358107206075165619121918994313769</span>,<span class="number">12067354386497776843231760139208442059041398520525521383656281303341787642443750743770398376846740004903417368242663172521036538264680412501426825455937841</span>,<span class="number">110389310327674438994512412189140404012421052386936465666855251542042378560401291600983416103427179353607040781976104766195786129003714052707327680357018140453491041540444836366277074087514554288700445714013715928343998664686187619330641898588950044266264672614012387217326725054091455281834050284619735562549</span>,<span class="number">131168948504860583548757651969440837258361128569062609463069944727375174669195551932348531223057116675553618553732609541174461910935866787631844529969966272525720171277182239591792328433851360949404595252497565480569603077853913064387239844154330498879841647697426578252738103633954750574330627202596111430527</span>]</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">lists = [n, e, p, q]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lists)):</span><br><span class="line">    lists[_] = (lists[_] * getPrime(<span class="number">512</span>)) % n</span><br><span class="line">    <span class="keyword">if</span> lists[_] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> p_lists:</span><br><span class="line">            lists[_] = (lists[_] - i ) % n</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;lists = <span class="subst">&#123;lists&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">lists = [19034306342361575075980551192712932322561988507704505619003321414454907641123196592043365494891212486631173617896128451305418561737688048967513695641921599895309500342048432076585214210554842683457585293799208643896433433876203082395319550418122273580170345397532087392101148847164139646172755862708188955074277199371835992255416573480806974852069162630676280643957223609636372925574762048260194971667671613092718354976535258179882483301719485865787139872158633048232174665688800039155623876126394585564220031878057948716342605048404401736509363831312390340124864856687925198309333062696436226782334117439595759538940, 735330208874124234708140189708190509639084585785019826186806221072030230392356294636951475819901892456531468208010283670339949843143111658956194009976314737497, 1602301325810709453980853329085731847189218243782953569904960880815334610650572082382219179731782825651268085475709993054918232934300216394178608235615344495673512692541974847829942480171431671140039053286087943307976082240770926172332448900407286986345896064450121772794727122073540966838136136436311798370861018787733155173660981857717532831514899794350952923611979062563752154655540017198341394961130185339410014663001790342283582793527539631430062006919362717, 1490871212681506284400346092290638774030823320747089448463392252548500186740778483192999592745868050668105386341645983368296594796392901704435327383316688779360786838012347149230273755275378107539155514295046237111681414693463240979896636803365784453108997600704264840021949772185282342808188139710222290864584233541392564011658505044015371776137094111399194018534838868815570165823623635735936443128581542320020795321638570854400035174475756508084590680356839283]</span></span><br><span class="line"><span class="string">c = 15709429897819175308791479593882604989090989118233668933670906164260634913646468935153698184826048828639442348549719275685262082300536207994989372917456166207109082588994547995099508074828988380667184703433477180995225527115780075500780238386354394158860518835289592441774944550726238379621327375074110844317019009627210693272418127362069725045971765997290253778268185565684106141611166424581425058580613958929007167669365312045402281728283642414980252973340376734458355144454456208389560426222274622157045069419138452349507377359387075362422897820554817185082519230849569674743365163066580506210507870872289317520453</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>其实这个题分析完后发现还是简单的<br>由于 lists 的第一个本来是 n ,mod n 后等于0,进行运算后的结果应该是 n-psum(plist 的和)<br>因为 psum 可以算出来，因此可求出 n,因为 e,p,q 都太小，所以没有被覆盖<br>因此可以使用公因数将 p,q 解出，从而变成正常的 RSA<br>exp:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">lists = [<span class="number">19034306342361575075980551192712932322561988507704505619003321414454907641123196592043365494891212486631173617896128451305418561737688048967513695641921599895309500342048432076585214210554842683457585293799208643896433433876203082395319550418122273580170345397532087392101148847164139646172755862708188955074277199371835992255416573480806974852069162630676280643957223609636372925574762048260194971667671613092718354976535258179882483301719485865787139872158633048232174665688800039155623876126394585564220031878057948716342605048404401736509363831312390340124864856687925198309333062696436226782334117439595759538940</span>, <span class="number">735330208874124234708140189708190509639084585785019826186806221072030230392356294636951475819901892456531468208010283670339949843143111658956194009976314737497</span>, <span class="number">1602301325810709453980853329085731847189218243782953569904960880815334610650572082382219179731782825651268085475709993054918232934300216394178608235615344495673512692541974847829942480171431671140039053286087943307976082240770926172332448900407286986345896064450121772794727122073540966838136136436311798370861018787733155173660981857717532831514899794350952923611979062563752154655540017198341394961130185339410014663001790342283582793527539631430062006919362717</span>, <span class="number">1490871212681506284400346092290638774030823320747089448463392252548500186740778483192999592745868050668105386341645983368296594796392901704435327383316688779360786838012347149230273755275378107539155514295046237111681414693463240979896636803365784453108997600704264840021949772185282342808188139710222290864584233541392564011658505044015371776137094111399194018534838868815570165823623635735936443128581542320020795321638570854400035174475756508084590680356839283</span>]</span><br><span class="line">c = <span class="number">15709429897819175308791479593882604989090989118233668933670906164260634913646468935153698184826048828639442348549719275685262082300536207994989372917456166207109082588994547995099508074828988380667184703433477180995225527115780075500780238386354394158860518835289592441774944550726238379621327375074110844317019009627210693272418127362069725045971765997290253778268185565684106141611166424581425058580613958929007167669365312045402281728283642414980252973340376734458355144454456208389560426222274622157045069419138452349507377359387075362422897820554817185082519230849569674743365163066580506210507870872289317520453</span></span><br><span class="line">p_lists = [<span class="number">159514797898368694161035323666560455482927593628677715144231158683776654589410889361171506677869798913439553045649444471426486937156757512923737117257266219702305948490272092580126724358398210101455463243496876546152497051194626631388993441751102173455821084385690114474413278066052568157824769407231302148231</span>,<span class="number">164502040257301220127513609478443722760842040728679662285075057209725349316105183287859838362165949816685266852802699646133095636456140274119704558163346582955848072668773982942422021335047461181890966859173748565841810779262398379776937252911005772364747785905459772986563538358107206075165619121918994313769</span>,<span class="number">12067354386497776843231760139208442059041398520525521383656281303341787642443750743770398376846740004903417368242663172521036538264680412501426825455937841</span>,<span class="number">110389310327674438994512412189140404012421052386936465666855251542042378560401291600983416103427179353607040781976104766195786129003714052707327680357018140453491041540444836366277074087514554288700445714013715928343998664686187619330641898588950044266264672614012387217326725054091455281834050284619735562549</span>,<span class="number">131168948504860583548757651969440837258361128569062609463069944727375174669195551932348531223057116675553618553732609541174461910935866787631844529969966272525720171277182239591792328433851360949404595252497565480569603077853913064387239844154330498879841647697426578252738103633954750574330627202596111430527</span>]</span><br><span class="line"><span class="built_in">sum</span>=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p_lists:</span><br><span class="line">    <span class="built_in">sum</span>+=i</span><br><span class="line">n=<span class="built_in">sum</span>+lists[<span class="number">0</span>]</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=GCD(n,lists[<span class="number">2</span>])</span><br><span class="line">q=GCD(n,lists[<span class="number">3</span>])</span><br><span class="line"><span class="keyword">assert</span> p*q==n</span><br><span class="line">d=inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;1a2650c7-ba61-4fd7-b149-f087151bd06c&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="poly"><a href="#poly" class="headerlink" title="poly"></a>poly</h2><h3 id="题目-10"><a href="#题目-10" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">n = <span class="number">44</span></span><br><span class="line">p = <span class="number">76891131940393761705102995562451713716977513168151987122997698584077754434833</span></span><br><span class="line">PRp.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = x ^ n + <span class="number">7</span></span><br><span class="line">PR = PRp.quo(f)</span><br><span class="line">G = PR([getRandomNBitInteger(<span class="number">64</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">M = PR([<span class="built_in">ord</span>(flag[_ % <span class="built_in">len</span>(flag)]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">E = PR([getRandomRange(<span class="number">0</span>, <span class="number">4</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">c = M ^ (-<span class="number">1</span>) * G + E</span><br><span class="line"><span class="built_in">print</span>(c.<span class="built_in">list</span>())</span><br><span class="line"><span class="comment"># [33222500502316035616044442135960372497847961950485396449413543317883083038926, 37551883051023930209923814926663073615919611988658153864463372769156803888469, 6885819064632061993006721865975003168384486440800591106499315365485465123229, 39150781748560521282853118128987061565148646929624060895186981310505753042252, 9568187802811298965958948039003497460787285968756679037977894645041230605230, 37039707763200944116157977937398298700793465090822704196315684480524635756767, 52441772669424143174194878726638184660923200094214687016411659332366279566709, 33850405996304683137606272215449280389895051179518925120841689901077170269078, 15341672652784040453406716813014117299923786049907728865648634461092201606792, 56703196137744207452658592474062072883337973945083048857817108299542982976405, 61533436483609026382515005265341298411416881075792188250913245704638670030364, 66270669234290634938273377483953787496878362727975700849857389711011329780385, 68771491186591065608776822349174317474206206047585157630835108539697573971707, 3620540881702324693423502545001853679462640825354858276336125119756853401905, 53202792716812461928600680015496343136944059665848327350339519613632064314757, 55487906128655370245600430399584233480871206797186097717636498427481151521146, 24995778407868584306262430379279435923173858877131513575891155096706151560305, 26385021978283873070159223082747035201123213515216708286528602666689096572218, 75365256675053469553088716449423544790753638639428613263343571868459971553770, 7422642100742781104584859886241184379428101465047527306303207728012404554193, 21144076150831753362879700818362317541523415787624597530803644520157481989204, 11602131177213835800960780897300674931503149599436521029879191182697478989706, 269997034105887335932766435931957570226213091339493873697552817860500168798, 29592170769785676613770053060673595071183678309290305132514446341983310057605, 24608795020106050833673118614839318384738246238815037121228767642217605648805, 22129662168611841560758046123292241716232133669102309112724365812287930117701, 41819704925092226760551510707586882035079374882586684192893538006114228105476, 73387865731018950174100484941706140946589506913954231243924048130854401158970, 25772039328336068784600147029354208742237468081402872119647154618121339370144, 23878524887580811269284698304144369917813550916798991814242506737886915169609, 32651749018417205016614364575299285991871099208178617132955238539365552391829, 59025332692723731611419140375270204975464077495385523826794315887072186545135, 25379327588975988278959581354810488734224203430505421849901883250638122130273, 61435431838377069957555323132491713473896209781310430077916023034884542211875, 21948105745040304591828123835549540713605709311616849774188554136924562275030, 17122665797421754783955128405890580310316298670477799297889918571006476834354, 23771597187658350970465494159881184887335083411030494510375934645166615928309, 70659370674679121941279027090647056688378913650216555641359152878944275503654, 14442265238338035221061312637099599690996583630232531108769592425227252771140, 56171157458244810447661382507002995139214745429468641679613301401736104291976, 53791118180662787206327356942829168306676099220493071885479019705662488298391, 7339916594913560091967746623160329630569283548552475349534457652810179939101, 35268939876658587708773169547987291475313529613437305476095674851828645203393, 64853224339996552144448604332136216831902409567122258863695738304153705809491]</span></span><br></pre></td></tr></table></figure>
<p>这道题是我原来没见过的环上 lwe 问题，是在 mod p 的环上又除以了一个 $x^{44}+7$ 的多项式变成商环<br>然后将多项式的乘法转换为矩阵形式，并且根据商环的性质进行降次，但是这道题没有告诉 G<br>因此，只能造一个二维的格，然后去规约向量。</p>
<script type="math/tex; mode=display">c=M^{-1}*G+E</script><script type="math/tex; mode=display">G=Mc-ME</script><p>设 c 经过降次进行多项式乘法得到的矩阵为 C<br>又因为是 mod p 的环，所以可以得到如下式子</p>
<script type="math/tex; mode=display">G+ME=MC+kp</script><script type="math/tex; mode=display">(k,M)*\begin{bmatrix} P \ O \\C \ I \end{bmatrix}=(G+ME,M)</script><p>P 是 p 倍的 n 阶单位矩阵，I 是 n 阶单位矩阵, O 全为0<br>从而通过 LLL 算法规约出 M<br>exp:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from sage.all import *</span><br><span class="line">n = 44</span><br><span class="line">p = 76891131940393761705102995562451713716977513168151987122997698584077754434833</span><br><span class="line">C=[33222500502316035616044442135960372497847961950485396449413543317883083038926, 37551883051023930209923814926663073615919611988658153864463372769156803888469, 6885819064632061993006721865975003168384486440800591106499315365485465123229, 39150781748560521282853118128987061565148646929624060895186981310505753042252, 9568187802811298965958948039003497460787285968756679037977894645041230605230, 37039707763200944116157977937398298700793465090822704196315684480524635756767, 52441772669424143174194878726638184660923200094214687016411659332366279566709, 33850405996304683137606272215449280389895051179518925120841689901077170269078, 15341672652784040453406716813014117299923786049907728865648634461092201606792, 56703196137744207452658592474062072883337973945083048857817108299542982976405, 61533436483609026382515005265341298411416881075792188250913245704638670030364, 66270669234290634938273377483953787496878362727975700849857389711011329780385, 68771491186591065608776822349174317474206206047585157630835108539697573971707, 3620540881702324693423502545001853679462640825354858276336125119756853401905, 53202792716812461928600680015496343136944059665848327350339519613632064314757, 55487906128655370245600430399584233480871206797186097717636498427481151521146, 24995778407868584306262430379279435923173858877131513575891155096706151560305, 26385021978283873070159223082747035201123213515216708286528602666689096572218, 75365256675053469553088716449423544790753638639428613263343571868459971553770, 7422642100742781104584859886241184379428101465047527306303207728012404554193, 21144076150831753362879700818362317541523415787624597530803644520157481989204, 11602131177213835800960780897300674931503149599436521029879191182697478989706, 269997034105887335932766435931957570226213091339493873697552817860500168798, 29592170769785676613770053060673595071183678309290305132514446341983310057605, 24608795020106050833673118614839318384738246238815037121228767642217605648805, 22129662168611841560758046123292241716232133669102309112724365812287930117701, 41819704925092226760551510707586882035079374882586684192893538006114228105476, 73387865731018950174100484941706140946589506913954231243924048130854401158970, 25772039328336068784600147029354208742237468081402872119647154618121339370144, 23878524887580811269284698304144369917813550916798991814242506737886915169609, 32651749018417205016614364575299285991871099208178617132955238539365552391829, 59025332692723731611419140375270204975464077495385523826794315887072186545135, 25379327588975988278959581354810488734224203430505421849901883250638122130273, 61435431838377069957555323132491713473896209781310430077916023034884542211875, 21948105745040304591828123835549540713605709311616849774188554136924562275030, 17122665797421754783955128405890580310316298670477799297889918571006476834354, 23771597187658350970465494159881184887335083411030494510375934645166615928309, 70659370674679121941279027090647056688378913650216555641359152878944275503654, 14442265238338035221061312637099599690996583630232531108769592425227252771140, 56171157458244810447661382507002995139214745429468641679613301401736104291976, 53791118180662787206327356942829168306676099220493071885479019705662488298391, 7339916594913560091967746623160329630569283548552475349534457652810179939101, 35268939876658587708773169547987291475313529613437305476095674851828645203393, 64853224339996552144448604332136216831902409567122258863695738304153705809491]</span><br><span class="line">#part1 construct matrix of poly_mul</span><br><span class="line">poly_mul_mat = Matrix(ZZ,n,n)</span><br><span class="line">for i in range(n):</span><br><span class="line">    for j in range(i+1):</span><br><span class="line">        poly_mul_mat[j,i] = C[i-j]</span><br><span class="line">    for j in range(n-i-1):</span><br><span class="line">        poly_mul_mat[j+i+1,i] = C[-(j+1)]*(-7)</span><br><span class="line">#part2 construct Lattice of RLWE</span><br><span class="line">I=identity_matrix(n)</span><br><span class="line">O = diagonal_matrix([0]*n)</span><br><span class="line">L=block_matrix(ZZ,[[p*I,O],[poly_mul_mat,I]])</span><br><span class="line">#part3 LLL to get s and get flag</span><br><span class="line">res=L.LLL()[0]</span><br><span class="line">s=res[n:2*n]</span><br><span class="line">for i in s:</span><br><span class="line">    print(chr(abs(i)),end = &quot;&quot;)</span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;630927c4-05a0-4814-be58-71effff2667b&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="broke-prime-解释直接搬题解了，赛后复现出来的"><a href="#broke-prime-解释直接搬题解了，赛后复现出来的" class="headerlink" title="broke_prime(解释直接搬题解了，赛后复现出来的)"></a>broke_prime(解释直接搬题解了，赛后复现出来的)</h2><h3 id="题目-11"><a href="#题目-11" class="headerlink" title="题目"></a>题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, seed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, a, b, c, m</span>):</span><br><span class="line">        self.seed = seed</span><br><span class="line">        self.a = a</span><br><span class="line">        self.b = b</span><br><span class="line">        self.c = c</span><br><span class="line">        self.m = m</span><br><span class="line">        self.<span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        old_seed = self.seed</span><br><span class="line">        self.seed = (self.a * self.seed + self.b * self.<span class="built_in">sum</span> + self.c) % self.m</span><br><span class="line">        self.<span class="built_in">sum</span> += old_seed</span><br><span class="line">        <span class="keyword">return</span> self.seed</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_prime</span>(<span class="params">self</span>):</span><br><span class="line">        p = LCG.<span class="built_in">next</span>(self)</span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> isPrime(p):</span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                p = LCG.<span class="built_in">next</span>(self)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mod = <span class="number">354252708427750240229260978193205484318571536272112991343431793849964373726922463628613145814371373260028683490026950541602265331657638161041835445105208291</span></span><br><span class="line">a = <span class="number">237900048765544226238606951931485142842805199598265659541214836217396990325502179274242649127973632458845665307476813590275841979202728059697763417557857652</span></span><br><span class="line">b = <span class="number">13181797456611043076861621596229452465596236739465663534833159120373125242860992712109343179847088690433413264607017889258274469596421834574886130502704297</span></span><br><span class="line">c = <span class="number">41761716242103652084201480772302771510511622202566086490783949795002810521506969109162934497335266343959159394065053842621794178874404961380566756416164306</span></span><br><span class="line">lcg = LCG(seed, a, b, c, mod)</span><br><span class="line">p = lcg.get_prime()</span><br><span class="line">q = lcg.get_prime()</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(m, e, n))</span><br><span class="line"><span class="built_in">print</span>(p &gt;&gt; <span class="number">128</span>)</span><br><span class="line"><span class="built_in">print</span>(q &gt;&gt; <span class="number">128</span>)</span><br><span class="line"><span class="comment"># 49413778670684043701101712067195406168770575146031767041873371910337742758286565131851416663826193705462720353166890852821396960382491317715463464433723470559989749532064756243470250498365928896006806459819182162923093375530509813688770261491678505176799616099814549247316518267701834540369749958922344112880476</span></span><br><span class="line"><span class="comment"># 449102445150699600758919619594591097695198474900484586670894857878442127718377375168779706417242184820702347471107358</span></span><br><span class="line"><span class="comment"># 1005180820885711801162429017222367006492489122545352977284777513576148651454304967952076877842792817940225372495541955</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="LCG"><a href="#LCG" class="headerlink" title="LCG"></a>LCG</h3><p>我们已知LCG的递推方式为</p>
<script type="math/tex; mode=display">
X_{i}=aX_{i-1}+b\sum^{i-2}_{j=0}X_j+c\mod m</script><p>利用$X_i-X_{i-1}$得到</p>
<script type="math/tex; mode=display">
X_i=(a+1)X_{i-1}-(b-a)X_{i-2}\mod m</script><p>其可以写成</p>
<script type="math/tex; mode=display">
\left[\begin{matrix}X_i\\X_{i-1}\end{matrix}\right]=\left[\begin{matrix}a+1,b-a\\1,0\end{matrix}\right]\left[\begin{matrix}X_{i-1}\\X_{i-2}\end{matrix}\right]=\left[\begin{matrix}a+1,b-a\\1,0\end{matrix}\right]^{i-2}\left[\begin{matrix}X_{1}\\X_{0}\end{matrix}\right]=\left[\begin{matrix}a+1,b-a\\1,0\end{matrix}\right]^{i-2}\left[\begin{matrix}aX_{0}+c\\X_{0}\end{matrix}\right]</script><p>故</p>
<script type="math/tex; mode=display">
X_i=(\left[\begin{matrix}a+1,b-a\\1,0\end{matrix}\right]^{i-2}\left[\begin{matrix}aX_{0}+c\\X_{0}\end{matrix}\right])[0]</script><p>我们记$p=X_{i},q=X_{j}$那么$p=A_0X_0+B_0,q=A_1X_0+B_1$，其中$A_i,B_i,i\in\{0,1\}$为矩阵计算中的系数</p>
<p>我们未知的是$p,q$的低位及$X_0$，那么这就是一个hnp问题</p>
<h3 id="HNP"><a href="#HNP" class="headerlink" title="HNP"></a>HNP</h3><p>利用二者消去$X_0$得到</p>
<script type="math/tex; mode=display">
A_1p-A_0q=A_1B_0-A_0B_1</script><script type="math/tex; mode=display">
A_1(p_h+e_1)-A_0(q_h+e_2)-A_1B_0+A_0B_1=0</script><script type="math/tex; mode=display">
A_1e_1-A_0e_2+C=0</script><p>其中$C$为只包含$A_i,B_i,p_h,q_h,i\in\{0,1\}$的系数</p>
<p>构造格</p>
<script type="math/tex; mode=display">
\left[\begin{matrix}1,0,0,A_1\\0,1,0,A_0\\0,0,1,C\\0,0,0,m\end{matrix}\right]</script><p>即可解出短向量$\left[\begin{matrix}e_1,e_2,1,0\end{matrix}\right]$<br>进而恢复$p,q$<br>exp:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line">from sage.all import *</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">mod = 354252708427750240229260978193205484318571536272112991343431793849964373726922463628613145814371373260028683490026950541602265331657638161041835445105208291</span><br><span class="line">a = 237900048765544226238606951931485142842805199598265659541214836217396990325502179274242649127973632458845665307476813590275841979202728059697763417557857652</span><br><span class="line">b = 13181797456611043076861621596229452465596236739465663534833159120373125242860992712109343179847088690433413264607017889258274469596421834574886130502704297</span><br><span class="line">c = 41761716242103652084201480772302771510511622202566086490783949795002810521506969109162934497335266343959159394065053842621794178874404961380566756416164306</span><br><span class="line">enc= 49413778670684043701101712067195406168770575146031767041873371910337742758286565131851416663826193705462720353166890852821396960382491317715463464433723470559989749532064756243470250498365928896006806459819182162923093375530509813688770261491678505176799616099814549247316518267701834540369749958922344112880476</span><br><span class="line">ph=449102445150699600758919619594591097695198474900484586670894857878442127718377375168779706417242184820702347471107358</span><br><span class="line">qh=1005180820885711801162429017222367006492489122545352977284777513576148651454304967952076877842792817940225372495541955</span><br><span class="line">A=Matrix(Zmod(mod),[[a+1,b-a],[1,0]])</span><br><span class="line">size=1000</span><br><span class="line">bits=2**128</span><br><span class="line">for i in tqdm(range(252,size)):</span><br><span class="line">    for j in range(i,size):</span><br><span class="line">        V0=A**i</span><br><span class="line">        V1=A**j</span><br><span class="line">        A0=(V0[0][0])*a+(V0[0][1])</span><br><span class="line">        B0=(V0[0][0])*c</span><br><span class="line">        A1=(V1[0][0])*a+(V1[0][1])</span><br><span class="line">        B1=(V1[0][0])*c</span><br><span class="line">        C=A1*(ph*bits-B0)-A0*(qh*bits-B1)</span><br><span class="line">        L=Matrix(ZZ,</span><br><span class="line">            [</span><br><span class="line">                [1, 0, 0, A1],</span><br><span class="line">                [0, 1, 0, A0],</span><br><span class="line">                [0, 0, 1, C],</span><br><span class="line">                [0, 0, 0, mod],</span><br><span class="line">            ],)</span><br><span class="line">        </span><br><span class="line">        M=L.LLL()</span><br><span class="line">        for l in M:</span><br><span class="line">            e1, e2 = int(abs(l[0])), int(abs(l[1]))</span><br><span class="line">            p = bits * ph + e1</span><br><span class="line">            q = bits * qh + e2</span><br><span class="line">            if isPrime(p) and isPrime(q) and l[-1]==0 :</span><br><span class="line">                n = p * q</span><br><span class="line">                d = inverse(e, (p - 1) * (q - 1))</span><br><span class="line">                print(i,j)</span><br><span class="line">                print(p, q, e1, e2)</span><br><span class="line">                </span><br></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCTF&#123;e65f98ac87f1c7a02b252d30eb2db69d5368da9fa23cc1fcf1c435b669359938&#125;</span><br></pre></td></tr></table></figure></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://lst4r-max.github.io">Lst4r</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://lst4r-max.github.io/2024/08/11/SRCTF%E5%A4%8D%E7%8E%B0/">https://lst4r-max.github.io/2024/08/11/SRCTF%E5%A4%8D%E7%8E%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lst4r-max.github.io" target="_blank">Lst4r's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a></div><div class="post_share"><div class="social-share" data-image="/img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/11/05/%E5%BC%BA%E7%BD%91%E6%9D%AF2024%E5%A4%8D%E7%8E%B0/" title="强网杯2024 Crypto复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">强网杯2024 Crypto复现</div></div></a></div><div class="next-post pull-right"><a href="/2024/04/30/XYCTF2024%20WP/" title="XYCTF Crypto WP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">XYCTF Crypto WP</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/03/06/Lst4r-s-first-Blog/" title="RSA 基本原理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-06</div><div class="title">RSA 基本原理</div></div></a></div><div><a href="/2024/03/12/RSA2/" title="RSA 一些进阶攻击方式及变体"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-12</div><div class="title">RSA 一些进阶攻击方式及变体</div></div></a></div><div><a href="/2024/03/25/NKCTF2024-%E5%A4%8D%E7%8E%B0-wp/" title="NKCTF2024 复现+wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-25</div><div class="title">NKCTF2024 复现+wp</div></div></a></div><div><a href="/2024/11/05/%E5%BC%BA%E7%BD%91%E6%9D%AF2024%E5%A4%8D%E7%8E%B0/" title="强网杯2024 Crypto复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-05</div><div class="title">强网杯2024 Crypto复现</div></div></a></div><div><a href="/2024/04/30/XYCTF2024%20WP/" title="XYCTF Crypto WP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-30</div><div class="title">XYCTF Crypto WP</div></div></a></div><div><a href="/2024/04/30/XYCTF2025%20wp&%E5%A4%8D%E7%8E%B0/" title="XYCTF2025 wp&amp;复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-30</div><div class="title">XYCTF2025 wp&amp;复现</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Lst4r</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Lst4r-max/Lst4r-max.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Lst4r's new Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#justez"><span class="toc-number">1.</span> <span class="toc-text">justez</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">1.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#leak"><span class="toc-number">2.</span> <span class="toc-text">leak</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="toc-number">2.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Who-is-Bob"><span class="toc-number">3.</span> <span class="toc-text">Who_is_Bob</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="toc-number">3.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#leak-revenge"><span class="toc-number">4.</span> <span class="toc-text">leak revenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="toc-number">4.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#baby"><span class="toc-number">5.</span> <span class="toc-text">baby</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-4"><span class="toc-number">5.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Elementary-Chinese"><span class="toc-number">6.</span> <span class="toc-text">Elementary Chinese</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-5"><span class="toc-number">6.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gen-%E5%A4%8D%E7%8E%B0%E5%8F%82%E8%80%83%E4%BA%86%E5%85%B6%E4%BB%96%E5%B8%88%E5%82%85%E7%9A%84wp"><span class="toc-number">7.</span> <span class="toc-text">gen(复现参考了其他师傅的wp)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-6"><span class="toc-number">7.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-solve"><span class="toc-number">8.</span> <span class="toc-text">ez_solve</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-7"><span class="toc-number">8.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hash-attack"><span class="toc-number">9.</span> <span class="toc-text">hash attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-8"><span class="toc-number">9.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#miniRSA"><span class="toc-number">10.</span> <span class="toc-text">miniRSA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-9"><span class="toc-number">10.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#poly"><span class="toc-number">11.</span> <span class="toc-text">poly</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-10"><span class="toc-number">11.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#broke-prime-%E8%A7%A3%E9%87%8A%E7%9B%B4%E6%8E%A5%E6%90%AC%E9%A2%98%E8%A7%A3%E4%BA%86%EF%BC%8C%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0%E5%87%BA%E6%9D%A5%E7%9A%84"><span class="toc-number">12.</span> <span class="toc-text">broke_prime(解释直接搬题解了，赛后复现出来的)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-11"><span class="toc-number">12.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LCG"><span class="toc-number">12.2.</span> <span class="toc-text">LCG</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HNP"><span class="toc-number">12.3.</span> <span class="toc-text">HNP</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/05/%E5%BC%BA%E7%BD%91%E6%9D%AF2024%E5%A4%8D%E7%8E%B0/" title="强网杯2024 Crypto复现">强网杯2024 Crypto复现</a><time datetime="2024-11-05T12:24:31.000Z" title="发表于 2024-11-05 20:24:31">2024-11-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/11/SRCTF%E5%A4%8D%E7%8E%B0/" title="SRCTF Crypto 复现">SRCTF Crypto 复现</a><time datetime="2024-08-11T04:33:20.000Z" title="发表于 2024-08-11 12:33:20">2024-08-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/30/XYCTF2024%20WP/" title="XYCTF Crypto WP">XYCTF Crypto WP</a><time datetime="2024-04-30T01:52:47.000Z" title="发表于 2024-04-30 09:52:47">2024-04-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/30/XYCTF2025%20wp&amp;%E5%A4%8D%E7%8E%B0/" title="XYCTF2025 wp&amp;复现">XYCTF2025 wp&amp;复现</a><time datetime="2024-04-30T01:52:47.000Z" title="发表于 2024-04-30 09:52:47">2024-04-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/25/NKCTF2024-%E5%A4%8D%E7%8E%B0-wp/" title="NKCTF2024 复现+wp">NKCTF2024 复现+wp</a><time datetime="2024-03-25T12:18:57.000Z" title="发表于 2024-03-25 20:18:57">2024-03-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Lst4r</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>